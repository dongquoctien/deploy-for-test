function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],i=!0,a=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(c){a=!0,r=c}finally{try{i||null==s.return||s.return()}finally{if(a)throw r}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"/Bmo":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("XNiG"),a=n("1G5W"),r=n("kt0X"),o=n("Dwql"),s=n("LpL+"),c=n("YY+H"),l=n("fXoL"),u=n("sW+t"),p=n("ofXK"),d=function(){var e=function(){function e(t,n){_classCallCheck(this,e),this.store=t,this.authStore=n,this._$unsubscribe=new i.a,this.templateTypeList$=t.pipe(Object(r.u)(s.e)),this.templateList$=t.pipe(Object(r.u)(s.d)),this.selectedTemplateInfo$=t.pipe(Object(r.u)(s.c)),this.loginUserInfo$=n.pipe(Object(r.u)(c.r))}return _createClass(e,[{key:"ngOnInit",value:function(){this._initSubscribe()}},{key:"ngOnDestroy",value:function(){this._$unsubscribe.next(),this._$unsubscribe.complete()}},{key:"changeSendTypeHandler",value:function(e){}},{key:"changeTemplateHandler",value:function(e){this._loadUmsTemplateInfo(e)}},{key:"sendUmsHandler",value:function(e){this.store.dispatch(o.a.sendUmsAction({condition:e}))}},{key:"_loadUmsTemplateInfo",value:function(e){this.store.dispatch(o.a.loadTemplateInfoAction({condition:Object.assign(Object.assign({},e),{stationTypeCode:this.stationTypeCode,bookingItemCode:this.bookingItemCode})}))}},{key:"_initSubscribe",value:function(){var e=this;this.loginUserInfo$.pipe(Object(a.a)(this._$unsubscribe)).subscribe((function(t){var n=t.userNo;e.senderInfo={userNo:n,name:"\uc624\ub9c8\uc774\ud638\ud154",phoneNo:"02-733-0550",emailAddress:"cscenter@ohmyhotel.com"}}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(l.Qb(r.h),l.Qb(r.h))},e.\u0275cmp=l.Kb({type:e,selectors:[["app-ums"]],hostAttrs:[1,"tab-pane"],hostVars:2,hostBindings:function(e,t){2&e&&l.Gb("active",t.active)},inputs:{active:"active",itemCategoryCode:"itemCategoryCode",stationTypeCode:"stationTypeCode",bookingItemCode:"bookingItemCode",bookingCode:"bookingCode",booker:"booker",bookers:"bookers"},decls:4,vars:14,consts:[[3,"itemCategoryCode","bookingItemCode","bookingCode","bookers","sender","sendTypeList","templateList","templateInfo","changeSendTypeEvent","changeTemplateEvent","submitEvent"]],template:function(e,t){1&e&&(l.Wb(0,"app-ums-form",0),l.fc("changeSendTypeEvent",(function(e){return t.changeSendTypeHandler(e)}))("changeTemplateEvent",(function(e){return t.changeTemplateHandler(e)}))("submitEvent",(function(e){return t.sendUmsHandler(e)})),l.ic(1,"async"),l.ic(2,"async"),l.ic(3,"async"),l.Vb()),2&e&&l.pc("itemCategoryCode",t.itemCategoryCode)("bookingItemCode",t.bookingItemCode)("bookingCode",t.bookingCode)("bookers",t.bookers)("sender",t.senderInfo)("sendTypeList",l.jc(1,8,t.templateTypeList$))("templateList",l.jc(2,10,t.templateList$))("templateInfo",l.jc(3,12,t.selectedTemplateInfo$))},directives:[u.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e}()},"7G9D":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("tk/3"),a=n("IzEk"),r=n("LvDl"),o=n("fXoL"),s=n("tpT/"),c=n("EsKh"),l=function(){var e=function(){function e(t,n){_classCallCheck(this,e),this.api=t,this.alertService=n}return _createClass(e,[{key:"imageCheck",value:function(e){if(0===e.target.files.length)return!1;var t=e.target.files[0];if(t.size>2e6)return this.alertService.alert("\ud30c\uc77c \uc0ac\uc774\uc988\ub294 2MB\ub97c \ub118\uae38 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4"),!1;var n=this.parseFileName(t.name),i=n.toLowerCase(),a=i.lastIndexOf("."),r=i.substring(a+1);if(a<0)n+=".jpg";else if("jpg"!==r&&"png"!==r&&"jpeg"!==r)return this.alertService.alert("\uc774\ubbf8\uc9c0 \ud30c\uc77c\uc774 \uc544\ub2d9\ub2c8\ub2e4. \ub2e4\uc2dc \ud655\uc778\ud574 \uc8fc\uc138\uc694."),!1;return t}},{key:"pdfCheck",value:function(e){if(0===e.target.files.length)return!1;var t=e.target.files[0],n=this.parseFileName(t.name),i=n.toLowerCase(),a=i.lastIndexOf("."),r=i.substring(a+1);if(a<0)n+=".pdf";else if("pdf"!==r)return this.alertService.alert("PDF \ud30c\uc77c\uc774 \uc544\ub2d9\ub2c8\ub2e4. \ub2e4\uc2dc \ud655\uc778\ud574 \uc8fc\uc138\uc694."),!1;return t}},{key:"excelCheck",value:function(e){if(0===e.target.files.length)return!1;var t=e.target.files[0],n=this.parseFileName(t.name),i=n.toLowerCase(),a=i.lastIndexOf("."),r=i.substring(a+1);if(a<0)n+=".xls";else if("xls"!==r&&"xlsx"!==r)return this.alertService.alert("\uc5d1\uc140 \ud30c\uc77c\uc774 \uc544\ub2d9\ub2c8\ub2e4. \ub2e4\uc2dc \ud655\uc778\ud574 \uc8fc\uc138\uc694."),!1;return t}},{key:"imageUpload",value:function(e,t){var n=new FormData;for(var i in t)if(t.hasOwnProperty(i))try{n.set(i,t[i])}catch(a){n.append(i,t[i])}return this.api.post(e,n)}},{key:"fileUpload",value:function(e,t){var n=new FormData;for(var i in t)if(t.hasOwnProperty(i))try{n.set(i,t[i])}catch(a){n.append(i,t[i])}return this.api.put(e,n)}},{key:"fileDelete",value:function(e,t){var n=Object.assign({},this.api.defaultParams,{condition:t});return this.api.delete(e,n)}},{key:"fileDownload",value:function(e){var t,n,o=this;switch(e.params||(e=Object.assign(e,{params:""})),e.type||(e.type="excel"),e.type){case"excel":t=".xls",n="application/vnd.ms-excel";break;case"pdf":t=".pdf",n="application/pdf"}var s=function(i){var a=document.createElement("a"),r=new Blob([i],{type:n});a.href=URL.createObjectURL(r),a.download=e.filename+t,a.click()};if("post"===e.requestMethod){var c=r.assign({},this.api.defaultParams,{condition:e.params});return this.api.postBlob(e.url,c).pipe(Object(a.a)(1)).subscribe((function(e){"application/json"===e.type?o.alertService.alert("You must wait a minute before making another request."):s(e)}))}return this.api.get(e.url,e.params,{responseType:"blob",headers:new i.e({"Content-Type":"application/json",Accept:"application/json"})}).pipe(Object(a.a)(1)).subscribe((function(e){s(e)}))}},{key:"parseFileName",value:function(e){var t=/[\{\}\[\]\/?,;:|\)*~`!^\-_+<>@\#$%&\\\=\(\'\"' ']/gi,n=e;return t.test(n)?n.replace(t,""):n}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o.bc(s.a),o.bc(c.a))},e.\u0275prov=o.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},"8A7v":function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return h}));var i,a,r=n("LRne"),o=n("z6cu"),s=n("eIep"),c=n("LvDl"),l=n("AytR").a.API_URL,u={selectDetailCode:"".concat(l,"/common/detail-code"),postBasisWordSetup:"".concat(l,"/admin/basis/word-setup"),postUms:"".concat(l,"/common/ums/send")},p=n("fXoL"),d=n("tpT/"),m=((i=function(){function e(t){_classCallCheck(this,e),this.api=t}return _createClass(e,[{key:"getTemplateTypeList",value:function(e){var t=c.assign({},this.api.defaultParams,{condition:e});return this.api.post(u.selectDetailCode,t).pipe(Object(s.a)((function(e){return e.succeedYn?Object(r.a)(e.result.list):Object(o.a)(e||"api response error")})))}},{key:"getBasisWordSetupList",value:function(e){var t=c.assign({},this.api.defaultParams,{condition:e});return this.api.post(u.postBasisWordSetup,t).pipe(Object(s.a)((function(e){return e.succeedYn?Object(r.a)(e.result.list):Object(o.a)(e||"api response error")})))}},{key:"sendUms",value:function(e){var t=c.assign({},this.api.defaultParams,{condition:e});return this.api.post(u.postUms,t).pipe(Object(s.a)((function(e){return e.succeedYn?Object(r.a)(e.result):Object(o.a)(e||"api response error")})))}}]),e}()).\u0275fac=function(e){return new(e||i)(p.bc(d.a))},i.\u0275prov=p.Mb({token:i,factory:i.\u0275fac,providedIn:"root"}),i),b=n("3Pt+"),f=n("6UzV"),h=((a=function(){function e(t){var n=this;_classCallCheck(this,e),this.fb=t,this.generateUmsPutForm=function(){return n.fb.group({bookingCode:[null],bookingItemCode:[null],sender:n.fb.group({userNo:[null],name:[{value:null,disabled:!0},[b.z.required]],phoneNo:[null,[b.z.required]],emailAddress:[null,[b.z.required,f.a.email()]]}),receivers:n.fb.array([n.generateUmsReceiver({smsSendYn:!0,emailSendYn:!1})]),smsSendYn:[null],emailSendYn:[null],itemCategoryCode:[null],sendTypeCode:[null,[b.z.required]],alimTalkTemplateCode:[null],smsTitle:[null],smsDetail:[null,[b.z.required]],emailTitle:[null],emailDetail:[null]})},this.initUmsPutForm=function(){return{bookingCode:null,bookingItemCode:null,sender:{userNo:null,name:null,phoneNo:null,emailAddress:null},receivers:[{userNo:null,name:null,phoneNo:null,emailAddress:null}],smsSendYn:!0,emailSendYn:!1,itemCategoryCode:null,sendTypeCode:"UMH01",alimTalkTemplateCode:null,smsTitle:null,smsDetail:null,emailTitle:null,emailDetail:null}}}return _createClass(e,[{key:"generateUmsReceiver",value:function(e){var t=e.smsSendYn,n=e.emailSendYn,i=t?[b.z.required,f.a.mobile()]:[f.a.mobile()],a=n?[b.z.required,f.a.email()]:[f.a.email()];return this.fb.group({userNo:[null],name:[null],phoneNo:[null,i],emailAddress:[null,a]})}}]),e}()).\u0275fac=function(e){return new(e||a)(p.bc(b.f))},a.\u0275prov=p.Mb({token:a,factory:a.\u0275fac,providedIn:"root"}),a)},Dwql:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i={};n.r(i),n.d(i,"loadTemplateTypeAction",(function(){return r})),n.d(i,"loadTemplateTypeSuccessAction",(function(){return o})),n.d(i,"loadTemplateTypeFailureAction",(function(){return s})),n.d(i,"loadTemplateListAction",(function(){return c})),n.d(i,"loadTemplateListSuccessAction",(function(){return l})),n.d(i,"loadTemplateListFailureAction",(function(){return u})),n.d(i,"loadTemplateInfoAction",(function(){return p})),n.d(i,"loadTemplateInfoSuccessAction",(function(){return d})),n.d(i,"loadTemplateInfoFailureAction",(function(){return m})),n.d(i,"sendUmsAction",(function(){return b})),n.d(i,"sendUmsSuccessAction",(function(){return f})),n.d(i,"sendUmsFailureAction",(function(){return h}));var a=n("kt0X"),r=Object(a.o)("[Ums] load template type",Object(a.t)()),o=Object(a.o)("[Ums] load template type success",Object(a.t)()),s=Object(a.o)("[Ums] load template type failure",Object(a.t)()),c=Object(a.o)("[Ums] load template list",Object(a.t)()),l=Object(a.o)("[Ums] load template list success",Object(a.t)()),u=Object(a.o)("[Ums] load template list failure",Object(a.t)()),p=Object(a.o)("[Ums] load template info",Object(a.t)()),d=Object(a.o)("[Ums] load template info success",Object(a.t)()),m=Object(a.o)("[Ums] load template info failure",Object(a.t)()),b=Object(a.o)("[Ums] load send ums",Object(a.t)()),f=Object(a.o)("[Ums] load send ums success"),h=Object(a.o)("[Ums] load send ums failure",Object(a.t)())},"LpL+":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return d}));var i=n("kt0X"),a=n("Dwql"),r=Object(i.q)({templateTypeList:null,templateList:null,selectedTemplateInfo:null},Object(i.s)(a.a.loadTemplateTypeSuccessAction,(function(e,t){var n=t.dataList;return Object.assign(Object.assign({},e),{templateTypeList:n})})),Object(i.s)(a.a.loadTemplateListSuccessAction,(function(e,t){var n=t.dataList;return Object.assign(Object.assign({},e),{templateList:n})})),Object(i.s)(a.a.loadTemplateInfoSuccessAction,(function(e,t){var n=t.dataList;return Object.assign(Object.assign({},e),{selectedTemplateInfo:n[0]||null})}))),o="ums";function s(e,t){return Object(i.m)({main:r})(e,t)}var c=Object(i.p)(o),l=Object(i.r)(c,(function(e){return e.main})),u=Object(i.r)(l,(function(e){return e.templateTypeList})),p=Object(i.r)(l,(function(e){return e.templateList})),d=Object(i.r)(l,(function(e){return e.selectedTemplateInfo}))},YyVL:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var i,a,r=n("ofXK"),o=n("3Pt+"),s=n("snw9"),c=n("kt0X"),l=n("WG3B"),u=n("xoAz"),p=n("wPo9"),d=n("7rOj"),m=n("+NQf"),b=n("6LsY"),f=n("l1P7"),h=n("v7zA"),v=n("7UZF"),g=n("hHe4"),y=n("1OXJ"),T=n("5hwk"),k=n("lxvf"),C=n("vu/V"),O=(n("/Bmo"),n("sW+t"),n("LpL+")),j=n("LRne"),S=n("bOdf"),I=n("zp1y"),_=n("IzEk"),L=n("eIep"),V=n("lJxs"),A=n("JIr8"),F=n("LvDl"),w=n("Dwql"),W=n("fXoL"),U=n("8A7v"),D=n("Xb6A"),N=n("EsKh"),P=((a=function(){function e(t,n,i,a,r){var o=this;_classCallCheck(this,e),this._actions$=t,this._apiService=n,this.store=i,this._errorService=a,this.alertService=r,this.loadTemplateType$=Object(s.c)((function(){return o._actions$.pipe(Object(s.d)(w.a.loadTemplateTypeAction),Object(S.a)((function(e){return Object(j.a)(e).pipe(Object(I.a)(o.templateTypeList$.pipe(Object(_.a)(1))))})),Object(L.a)((function(e){var t=_slicedToArray(e,2),n=t[0],i=n.condition,a=n.isForceLoad,r=t[1];return!0===a||null===r?o._apiService.getTemplateTypeList(i).pipe(Object(V.a)((function(e){return w.a.loadTemplateTypeSuccessAction({dataList:e})})),Object(A.a)((function(e){var t="TemplateType list lookup failed.",n=[w.a.loadTemplateTypeFailureAction({error:t})];return o._catchErr(e,t,n),[]}))):Object(j.a)(w.a.loadTemplateTypeSuccessAction({dataList:F.cloneDeep(r)}))})))})),this.loadTemplateList$=Object(s.c)((function(){return o._actions$.pipe(Object(s.d)(w.a.loadTemplateListAction),Object(L.a)((function(e){var t=e.condition;return o._apiService.getBasisWordSetupList(t).pipe(Object(V.a)((function(e){return w.a.loadTemplateListSuccessAction({dataList:e})})),Object(A.a)((function(e){var t="Template list lookup failed.",n=[w.a.loadTemplateListFailureAction({error:t})];return o._catchErr(e,t,n),[]})))})))})),this.loadTemplateInfo$=Object(s.c)((function(){return o._actions$.pipe(Object(s.d)(w.a.loadTemplateInfoAction),Object(L.a)((function(e){var t=e.condition;return o._apiService.getBasisWordSetupList(t).pipe(Object(V.a)((function(e){return w.a.loadTemplateInfoSuccessAction({dataList:e})})),Object(A.a)((function(e){var t="Failed to retrieve template information.",n=[w.a.loadTemplateInfoFailureAction({error:t})];return o._catchErr(e,t,n),[]})))})))})),this.sendUms$=Object(s.c)((function(){return o._actions$.pipe(Object(s.d)(w.a.sendUmsAction),Object(L.a)((function(e){var t=e.condition;return o._apiService.sendUms(t).pipe(Object(V.a)((function(e){var t=[w.a.sendUmsSuccessAction()];o._runPage("The message was successfully sent.",t)})),Object(A.a)((function(e){var t="UMS dispatch failed.",n=[w.a.sendUmsFailureAction({error:t})];return o._catchErr(e,t,n),[]})))})))}),{dispatch:!1}),this.templateTypeList$=i.pipe(Object(c.u)(O.e))}return _createClass(e,[{key:"_runPage",value:function(e,t){var n=this;this.alertService.alert({message:e,accept:(null==t?void 0:t.length)>0?function(){t.forEach((function(e){n.store.dispatch(e)}))}:function(){}})}},{key:"_catchErr",value:function(e,t,n){var i=this,a=this._errorService.errorHandler(e,t);F.isNil(a)||(F.isNil(a.accept)&&(a.accept=(null==n?void 0:n.length)>0?function(){n.forEach((function(e){i.store.dispatch(e)}))}:function(){}),this.alertService.alert(a))}}]),e}()).\u0275fac=function(e){return new(e||a)(W.bc(s.a),W.bc(U.b),W.bc(c.h),W.bc(D.a),W.bc(N.a))},a.\u0275prov=W.Mb({token:a,factory:a.\u0275fac}),a),E=((i=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=W.Ob({type:i}),i.\u0275inj=W.Nb({factory:function(e){return new(e||i)},imports:[[r.c,o.m,o.w,l.m,u.a,p.a,d.a,T.a,m.a,b.a,f.a,h.a,v.a,g.a,y.a,k.a,C.a,c.j.forFeature(O.a,O.b),s.b.forFeature([P])]]}),i)},"sW+t":function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var i=n("fXoL"),a=n("XNiG"),r=n("1G5W"),o=n("LvDl"),s=n("3Pt+"),c=n("6UzV"),l=n("8A7v"),u=n("EsKh"),p=n("+Sob"),d=n("gbCm"),m=n("ofXK"),b=n("pb6r"),f=["templateSearch"];function h(e,t){if(1&e){var n=i.Xb();i.Wb(0,"a",30),i.fc("click",(function(){return i.Fc(n),i.hc(2).onAddReceiver()})),i.Pc(1,"\ucd94\uac00"),i.Vb()}}function v(e,t){if(1&e){var n=i.Xb();i.Wb(0,"a",31),i.fc("click",(function(){i.Fc(n);var e=i.hc().index;return i.hc().onDelReceiver(e)})),i.Pc(1,"\uc0ad\uc81c"),i.Vb()}}var g=function(e){return["receivers",e,"name"]},y=function(e){return["receivers",e,"phoneNo"]},T=function(e){return["receivers",e,"emailAddress"]};function k(e,t){if(1&e&&(i.Wb(0,"tr",27),i.Wb(1,"th",8),i.Pc(2," RECP "),i.Nc(3,h,2,0,"a",28),i.Nc(4,v,2,0,"a",29),i.Vb(),i.Wb(5,"td"),i.Rb(6,"app-input-text",9),i.Vb(),i.Wb(7,"th",8),i.Pc(8,"No."),i.Vb(),i.Wb(9,"td"),i.Rb(10,"app-input-text",10),i.Vb(),i.Wb(11,"th",8),i.Pc(12,"Email"),i.Vb(),i.Wb(13,"td"),i.Rb(14,"app-input-text",11),i.Vb(),i.Vb()),2&e){var n=t.index,a=i.hc();i.pc("formGroupName",n),i.Cb(3),i.pc("ngIf",0===n),i.Cb(1),i.pc("ngIf",n>0),i.Cb(2),i.pc("isInvalid",a.checkIsInvalid(i.uc(6,g,n))),i.Cb(4),i.pc("isInvalid",a.checkIsInvalid(i.uc(8,y,n))),i.Cb(4),i.pc("isInvalid",a.checkIsInvalid(i.uc(10,T,n)))}}var C=function(){return["sender","name"]},O=function(){return["sender","phoneNo"]},j=function(){return["sender","emailAddress"]},S=function(){var e=function(){function e(t,n,r){_classCallCheck(this,e),this._dataService=t,this._cd=n,this.alertService=r,this.changeSendTypeEvent=new i.n,this.changeTemplateEvent=new i.n,this.submitEvent=new i.n,this._$unsubscribe=new a.a,this.putForm=this._dataService.generateUmsPutForm(),this.putFormData=this._dataService.initUmsPutForm(),this.categoryOptionList=[{value:"IC01",label:"\ud56d\uacf5"},{value:"IC02",label:"\ud638\ud154"},{value:"IC03",label:"\ub80c\ud130\uce74"},{value:"IC04",label:"\uc561\ud2f0\ube44\ud2f0"}],this._initFormSub()}return _createClass(e,[{key:"sendTypeList",get:function(){return this._sendTypeList},set:function(e){this._sendTypeList=null==e?void 0:e.filter((function(e){return["UFL99","UHT99","URT99","UAT99","UMS01"].indexOf(e.detailCode)<0}))}},{key:"receivers",get:function(){return this.putForm.get("receivers")}},{key:"ngOnChanges",value:function(e){(null==e?void 0:e.sendTypeList)&&!1===e.sendTypeList.firstChange?this._setDefaultSendType():(null==e?void 0:e.templateList)&&!1===e.templateList.firstChange?(this.filteredTemplateList=o.cloneDeep(e.templateList.currentValue),this.templateKeyword=""):(null==e?void 0:e.templateInfo)&&!1===e.templateInfo.firstChange?this._setTemplate():(this.putFormData=this._setPutFormData(),this._setReceivers())}},{key:"ngOnDestroy",value:function(){this._$unsubscribe.next(),this._$unsubscribe.complete()}},{key:"onAddReceiver",value:function(){if(this.receivers.length>4)this.alertService.alert("No more can be added.");else{var e=this.putForm.get("smsSendYn").value,t=this.putForm.get("emailSendYn").value;this.receivers.push(this._dataService.generateUmsReceiver({smsSendYn:e,emailSendYn:t}))}}},{key:"onDelReceiver",value:function(e){this.receivers.removeAt(e)}},{key:"onChangeTemplateCode",value:function(e,t){var n=t.wordingSetupSeq;this.changeTemplateEvent.emit({wordingSetupSeq:n})}},{key:"onSubmit",value:function(){if(this.putForm.invalid){this._checkValid=!0;var e=this.putForm.value,t=e.smsSendYn,n=e.emailSendYn,i=e.receivers;return t&&(i.every((function(e){return!o.isNil(e.phoneNo)}))||this.alertService.alert("Enter your correct mobile phone number.")),void(n&&(i.every((function(e){return!o.isNil(e.emailAddress)}))||this.alertService.alert("Enter your correct mobile phone number.")))}var a=this._setPutCondition();this.submitEvent.emit(a),this._checkValid=!1}},{key:"checkIsInvalid",value:function(e){return this._checkValid&&this.putForm.get(e)&&this.putForm.get(e).invalid}},{key:"_setPutFormData",value:function(){var e,t=this._dataService.initUmsPutForm(),n={bookingCode:this.bookingCode||null,bookingItemCode:this.bookingItemCode||null,sender:this.sender||o.cloneDeep(t.sender),receivers:(null===(e=this.bookers)||void 0===e?void 0:e.length)>0?o.cloneDeep(this.bookers):o.cloneDeep(t.receivers),itemCategoryCode:this.itemCategoryCode||null};return Object.assign({},t,n)}},{key:"_setReceivers",value:function(){var e;if((null===(e=this.bookers)||void 0===e?void 0:e.length)>0){var t=this.putForm.get("smsSendYn").value,n=this.putForm.get("emailSendYn").value;this.receivers.clear();for(var i=0;i<this.bookers.length;i++)this.receivers.push(this._dataService.generateUmsReceiver({smsSendYn:t,emailSendYn:n}))}}},{key:"_setPutCondition",value:function(){var e=this._dataService.initUmsPutForm(),t=this.putForm.getRawValue(),n=t.receivers.map((function(e){return o.omitBy(e,o.isNil)})),i=Object.assign({},o.pick(Object.assign(Object.assign({},t),{receivers:n}),Object.keys(e)));return o.omitBy(i,o.isNil)}},{key:"_setDefaultSendType",value:function(){var e;(null===(e=this.sendTypeList)||void 0===e?void 0:e.length)>0&&(this.putFormData=Object.assign({},this.putFormData,{sendTypeCode:this.sendTypeList[0].detailCode}))}},{key:"_setTemplate",value:function(){if(!o.isNil(this.templateInfo)){var e=this.templateInfo,t=e.alimTalkTemplateCode,n=e.smsTitle,i=e.smsDetail,a=e.emailTitle,r=e.emailDetail;this.putForm.patchValue({alimTalkTemplateCode:t,smsTitle:n,smsDetail:i,emailTitle:a,emailDetail:r})}}},{key:"_initFormSub",value:function(){var e=this;this.putForm.get("sendTypeCode").valueChanges.pipe(Object(r.a)(this._$unsubscribe)).subscribe((function(t){t&&e.changeSendTypeEvent.emit(t)})),this.putForm.get("smsSendYn").valueChanges.pipe(Object(r.a)(this._$unsubscribe)).subscribe((function(t){!0===t?(e.putForm.get("smsDetail").setValidators([s.z.required]),e.receivers.controls.forEach((function(e){e.get("phoneNo").setValidators([s.z.required,c.a.mobile()]),e.get("phoneNo").updateValueAndValidity()}))):(e.putForm.get("smsDetail").clearValidators(),e.receivers.controls.forEach((function(e){e.get("phoneNo").setValidators([c.a.mobile()]),e.get("phoneNo").updateValueAndValidity()}))),e.putForm.get("smsDetail").updateValueAndValidity()})),this.putForm.get("emailSendYn").valueChanges.pipe(Object(r.a)(this._$unsubscribe)).subscribe((function(t){!0===t?(e.putForm.get("emailDetail").setValidators([s.z.required]),e.putForm.get("emailTitle").setValidators([s.z.required]),e.receivers.controls.forEach((function(e){e.get("emailAddress").setValidators([s.z.required,c.a.email()]),e.get("emailAddress").updateValueAndValidity()}))):(e.putForm.get("emailDetail").clearValidators(),e.putForm.get("emailTitle").clearValidators(),e.receivers.controls.forEach((function(e){e.get("emailAddress").setValidators([c.a.email()]),e.get("emailAddress").updateValueAndValidity()}))),e.putForm.get("emailDetail").updateValueAndValidity(),e.putForm.get("emailTitle").updateValueAndValidity()}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i.Qb(l.a),i.Qb(i.h),i.Qb(u.a))},e.\u0275cmp=i.Kb({type:e,selectors:[["app-ums-form"]],viewQuery:function(e,t){var n;1&e&&i.Xc(f,!0),2&e&&i.Dc(n=i.gc())&&(t.searchInput=n.first)},inputs:{itemCategoryCode:"itemCategoryCode",bookingItemCode:"bookingItemCode",bookingCode:"bookingCode",bookers:"bookers",sender:"sender",sendTypeList:"sendTypeList",templateList:"templateList",templateInfo:"templateInfo"},outputs:{changeSendTypeEvent:"changeSendTypeEvent",changeTemplateEvent:"changeTemplateEvent",submitEvent:"submitEvent"},features:[i.Ab],decls:65,vars:14,consts:[[3,"formGroup","connectForm","ngSubmit"],[1,"page-item"],[1,"page-item-header"],[1,"title"],[1,"table","table-bordered","table-responsive",2,"max-height","258px","overflow","auto"],["width","100px"],["width","160px"],["formGroupName","sender"],["scope","row",1,"th-bg"],["formControlName","name",3,"isInvalid"],["formControlName","phoneNo","inputFormat","phone",3,"isInvalid"],["formControlName","emailAddress",3,"isInvalid"],["formArrayName","receivers"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"page-item-header","justify-content-between"],[1,"form-group"],["formControlName","smsSendYn","binary","true","label","SMS"],["formControlName","emailSendYn","binary","true","label","email"],[1,"table","table-bordered","table-responsive"],[1,"td-bg","align-t"],[1,"textarea"],["cols","30","rows","20","formControlName","smsDetail","placeholder","Please enter the contents"],[1,"pd10"],["formControlName","emailTitle","placeholder","Email title",3,"isInvalid"],["cols","30","rows","15","placeholder","Please enter the contents of the mail","formControlName","emailDetail"],[1,"button-area","align-r","mt10"],["type","submit",1,"btn","btn-secondary","sm"],[3,"formGroupName"],["class","icon xs plus align-m ml10",3,"click",4,"ngIf"],["class","icon xs minus align-m ml10",3,"click",4,"ngIf"],[1,"icon","xs","plus","align-m","ml10",3,"click"],[1,"icon","xs","minus","align-m","ml10",3,"click"]],template:function(e,t){1&e&&(i.Wb(0,"form",0),i.fc("ngSubmit",(function(){return t.onSubmit()})),i.Wb(1,"div",1),i.Wb(2,"div",2),i.Wb(3,"p",3),i.Pc(4,"Set up UMS"),i.Vb(),i.Vb(),i.Wb(5,"div",4),i.Wb(6,"table"),i.Wb(7,"caption"),i.Pc(8," Set up UMS "),i.Vb(),i.Wb(9,"colgroup"),i.Rb(10,"col",5),i.Rb(11,"col",6),i.Rb(12,"col",5),i.Rb(13,"col"),i.Rb(14,"col",5),i.Rb(15,"col"),i.Vb(),i.Wb(16,"tbody"),i.Wb(17,"tr",7),i.Wb(18,"th",8),i.Pc(19,"From"),i.Vb(),i.Wb(20,"td"),i.Rb(21,"app-input-text",9),i.Vb(),i.Wb(22,"th",8),i.Pc(23,"No."),i.Vb(),i.Wb(24,"td"),i.Rb(25,"app-input-text",10),i.Vb(),i.Wb(26,"th",8),i.Pc(27,"Email"),i.Vb(),i.Wb(28,"td"),i.Rb(29,"app-input-text",11),i.Vb(),i.Vb(),i.Ub(30,12),i.Nc(31,k,15,12,"tr",13),i.Tb(),i.Vb(),i.Vb(),i.Vb(),i.Vb(),i.Wb(32,"div",1),i.Wb(33,"div",14),i.Wb(34,"p",3),i.Pc(35,"SMS & Email"),i.Vb(),i.Wb(36,"div",15),i.Rb(37,"app-checkbox",16),i.Rb(38,"app-checkbox",17),i.Vb(),i.Vb(),i.Wb(39,"div",18),i.Wb(40,"table"),i.Wb(41,"caption"),i.Pc(42," SMS & Email "),i.Vb(),i.Wb(43,"colgroup"),i.Rb(44,"col"),i.Rb(45,"col"),i.Vb(),i.Wb(46,"tbody"),i.Wb(47,"tr"),i.Wb(48,"td",19),i.Wb(49,"div",20),i.Rb(50,"textarea",21),i.Vb(),i.Vb(),i.Wb(51,"div",22),i.Wb(52,"div"),i.Pc(53,"Title"),i.Vb(),i.Wb(54,"div"),i.Rb(55,"app-input-text",23),i.Vb(),i.Vb(),i.Wb(56,"div",22),i.Wb(57,"div"),i.Pc(58,"Detail"),i.Vb(),i.Wb(59,"div"),i.Wb(60,"div",20),i.Rb(61,"textarea",24),i.Vb(),i.Vb(),i.Vb(),i.Vb(),i.Vb(),i.Vb(),i.Vb(),i.Wb(62,"div",25),i.Wb(63,"button",26),i.Pc(64,"Send"),i.Vb(),i.Vb(),i.Vb(),i.Vb()),2&e&&(i.pc("formGroup",t.putForm)("connectForm",t.putFormData),i.Cb(21),i.pc("isInvalid",t.checkIsInvalid(i.tc(11,C))),i.Cb(4),i.pc("isInvalid",t.checkIsInvalid(i.tc(12,O))),i.Cb(4),i.pc("isInvalid",t.checkIsInvalid(i.tc(13,j))),i.Cb(2),i.pc("ngForOf",t.receivers.controls),i.Cb(18),i.Gb("valid-error",t.checkIsInvalid("smsDetail")),i.Cb(6),i.pc("isInvalid",t.checkIsInvalid("emailTitle")),i.Cb(5),i.Gb("valid-error",t.checkIsInvalid("emailDetail")))},directives:[s.B,s.s,s.k,p.a,s.l,d.a,s.r,s.i,s.e,m.n,b.a,s.c,m.o],encapsulation:2,changeDetection:0}),e}()}}]);