function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _createForOfIteratorHelper(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=_unsupportedIterableToArray(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,i=!0,r=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return i=e.done,e},e:function(e){r=!0,a=e},f:function(){try{i||null==o.return||o.return()}finally{if(r)throw a}}}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],o=!0,a=!1,i=void 0;try{for(var r,l=e[Symbol.iterator]();!(o=(r=l.next()).done)&&(n.push(r.value),!t||n.length!==t);o=!0);}catch(c){a=!0,i=c}finally{try{o||null==l.return||l.return()}finally{if(a)throw i}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function _objectDestructuringEmpty(e){if(null==e)throw new TypeError("Cannot destructure undefined")}(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{FVAC:function(e,t,n){"use strict";n.r(t),n.d(t,"CONTAINERS",(function(){return za})),n.d(t,"COMPONENTS",(function(){return Qa})),n.d(t,"RateAllotmentModule",(function(){return Ka}));var o=n("pxUr"),a=n("ofXK"),i=n("3Pt+"),r=n("snw9"),l=n("kt0X"),c=n("WG3B"),s=n("xoAz"),u=n("wPo9"),p=n("1OXJ"),d=n("l1P7"),m=n("kKjH"),b=n("5hwk"),h=n("+NQf"),f=n("7UZF"),v=n("w8np"),y=n("v7zA"),P=n("hHe4"),C=n("6LsY"),g=n("7rOj"),D=n("tyNb"),k=Object(l.o)("[rateAllotmentAction] getRateAllotment",Object(l.t)()),S=Object(l.o)("[rateAllotmentAction] getRateAllotment \uc131\uacf5",Object(l.t)()),I=Object(l.o)("[rateAllotmentAction] getRateAllotment \uc2e4\ud328",Object(l.t)()),O=Object(l.o)("[rateAllotmentAction] addCheckedDateInfo",Object(l.t)()),R=Object(l.o)("[rateAllotmentAction] promotionCheckedDateInfo",Object(l.t)()),T=Object(l.o)("[rateAllotmentAction] setCheckedDateInfo"),V=Object(l.o)("[rateAllotmentAction] resetPromotionCheckedDateInfo"),A=Object(l.o)("[rateAllotmentAction] change search condition",Object(l.t)()),N=Object(l.o)("[rateAllotmentAction] change search year",Object(l.t)()),F=Object(l.o)("[rateAllotmentAction] change search month",Object(l.t)()),_=Object(l.o)("[rateAllotmentAction] call contract type list",Object(l.t)()),E=Object(l.o)("[rateAllotmentAction] contract type list success",Object(l.t)()),L=Object(l.o)("[rateAllotmentAction] contract type list failed",Object(l.t)()),W=Object(l.o)("[rateAllotmentAction] call promotion type list",Object(l.t)()),x=Object(l.o)("[rateAllotmentAction] promotion type list success",Object(l.t)()),j=Object(l.o)("[rateAllotmentAction] promotion type list failed",Object(l.t)()),Y=Object(l.o)("[rateAllotmentAction] open calendar popup"),M=Object(l.o)("[rateAllotmentAction] close calendar popup"),$=Object(l.o)("[rateAllotmentAction] open plan popup"),q=Object(l.o)("[rateAllotmentAction] close plan popup"),w=Object(l.o)("[rateAllotmentAction] open room popup"),H=Object(l.o)("[rateAllotmentAction] close room popup"),U=Object(l.o)("[rateAllotmentAction] open rate popup"),G=Object(l.o)("[rateAllotmentAction] close rate popup"),B=Object(l.o)("[rateAllotmentAction] open allotment popup"),X=Object(l.o)("[rateAllotmentAction] close allotment popup"),z=Object(l.o)("[rateAllotmentAction] open stop sale popup"),Q=Object(l.o)("[rateAllotmentAction] close stop sale popup"),K=Object(l.o)("[rateAllotmentAction] open promotion popup"),J=Object(l.o)("[rateAllotmentAction] close promotion popup"),Z=Object(l.q)({rateAllotmentList:null,rateAllotmentListSearchCondition:null,promotionTypeList:null,otherSearchInfo:null,mainLoading:null,checkedDateInfo:[],isOpenCalendarPopup:!1,isOpenPlanDetailPopup:!1,isOpenRoomDetailPopup:!1,isOpenAllotmentDetailPopup:!1,isOpenStopSaleDetailPopup:!1,isOpenPromotionDetailPopup:!1,isOpenRateDetailPopup:!1,expandedTreeData:{contract:[],room:[],plan:[],promotion:[]},currentYear:null,currentMonth:null,contractTypeCodeList:null,promotionCheckedDateInfo:null},Object(l.s)(k,(function(e){return Object.assign(Object.assign({},e),{mainLoading:!0})})),Object(l.s)(S,(function(e,t){var n=t.dataList;return Object.assign(Object.assign({},e),{rateAllotmentList:n,mainLoading:!1})})),Object(l.s)(E,(function(e,t){var n=t.dataList;return Object.assign(Object.assign({},e),{contractTypeCodeList:n})})),Object(l.s)(I,(function(e,t){return _objectDestructuringEmpty(t),Object.assign(Object.assign({},e),{mainLoading:!1})})),Object(l.s)(x,(function(e,t){var n=t.dataList;return Object.assign(Object.assign({},e),{promotionTypeList:n})})),Object(l.s)(O,(function(e,t){var n,o=t.data,a=o.checked,i=o.hotelContractSeq,r=o.date,l=o.roomId,c=o.planId,s=o.type,u=o.params,p=e.checkedDateInfo,d=null!==(n=null==p?void 0:p.find((function(e){return e.hotelContractSeq===i})))&&void 0!==n?n:{hotelContractSeq:i,rooms:[],plans:[]};switch(s){case"room":if(a){var m,b=d.rooms.find((function(e){return e.roomId===l}));if(b){m=Object.assign(Object.assign({},b),{dates:[].concat(_toConsumableArray(b.dates),[r])});var h=d.rooms.filter((function(e){return e.roomId!==l}));h=[].concat(_toConsumableArray(h),[m]),d=Object.assign(Object.assign({},d),{rooms:h})}else m={roomId:l,type:s,dates:[r],params:u},d=Object.assign(Object.assign({},d),{rooms:[].concat(_toConsumableArray(d.rooms),[m])})}else{var f,v=d.rooms.find((function(e){return e.roomId===l}));if((null==v?void 0:v.dates.length)>1){f=Object.assign(Object.assign({},v),{dates:v.dates.filter((function(e){return e!==r}))});var y=d.rooms.filter((function(e){return e.roomId!==l}));y=[].concat(_toConsumableArray(y),[f]),d=Object.assign(Object.assign({},d),{rooms:y})}else d=Object.assign(Object.assign({},d),{rooms:d.rooms.filter((function(e){return e.roomId!==l}))})}break;case"plan":if(a){var P,C=d.plans.find((function(e){return e.planId===c}));if(C){P=C.dates.includes(r)?Object.assign(Object.assign({},C),{params:u}):Object.assign(Object.assign({},C),{dates:[].concat(_toConsumableArray(C.dates),[r])});var g=d.plans.filter((function(e){return e.planId!==c}));g=[].concat(_toConsumableArray(g),[P]),d=Object.assign(Object.assign({},d),{plans:g})}else P={roomId:l,planId:c,type:s,dates:[r],params:u},d=Object.assign(Object.assign({},d),{plans:[].concat(_toConsumableArray(d.plans),[P])})}else{var D,k=d.plans.find((function(e){return e.planId===c}));if((null==k?void 0:k.dates.length)>1){D=Object.assign(Object.assign({},k),{dates:k.dates.filter((function(e){return e!==r}))});var S=d.plans.filter((function(e){return e.planId!==c}));S=[].concat(_toConsumableArray(S),[D]),d=Object.assign(Object.assign({},d),{plans:S})}else d=Object.assign(Object.assign({},d),{plans:d.plans.filter((function(e){return e.planId!==c}))})}}return p=0===d.rooms.length&&0===d.plans.length?p.filter((function(e){return!(e.hotelContractSeq===i)})):p.find((function(e){return e.hotelContractSeq===i}))?p.map((function(e){return e.hotelContractSeq===i?d:e})):[].concat(_toConsumableArray(p),[d]),Object.assign(Object.assign({},e),{checkedDateInfo:p})})),Object(l.s)(R,(function(e,t){var n=t.data;return Object.assign(Object.assign({},e),{promotionCheckedDateInfo:n})})),Object(l.s)(V,(function(e){return Object.assign(Object.assign({},e),{promotionCheckedDateInfo:null})})),Object(l.s)(A,(function(e,t){var n=t.condition,o=t.otherSearchInfo;return Object.assign(Object.assign({},e),{rateAllotmentListSearchCondition:n,otherSearchInfo:o})})),Object(l.s)(N,(function(e,t){var n=t.year;return Object.assign(Object.assign({},e),{currentYear:n})})),Object(l.s)(F,(function(e,t){var n=t.month;return Object.assign(Object.assign({},e),{currentMonth:n})})),Object(l.s)(T,(function(e){return Object.assign(Object.assign({},e),{checkedDateInfo:[]})})),Object(l.s)(Y,(function(e){return Object.assign(Object.assign({},e),{isOpenCalendarPopup:!0})})),Object(l.s)(M,(function(e){return Object.assign(Object.assign({},e),{isOpenCalendarPopup:!1})})),Object(l.s)($,(function(e){return Object.assign(Object.assign({},e),{isOpenPlanDetailPopup:!0})})),Object(l.s)(q,(function(e){return Object.assign(Object.assign({},e),{isOpenPlanDetailPopup:!1})})),Object(l.s)(w,(function(e){return Object.assign(Object.assign({},e),{isOpenRoomDetailPopup:!0})})),Object(l.s)(H,(function(e){return Object.assign(Object.assign({},e),{isOpenRoomDetailPopup:!1})})),Object(l.s)(U,(function(e){return Object.assign(Object.assign({},e),{isOpenRateDetailPopup:!0})})),Object(l.s)(G,(function(e){return Object.assign(Object.assign({},e),{isOpenRateDetailPopup:!1})})),Object(l.s)(B,(function(e){return Object.assign(Object.assign({},e),{isOpenAllotmentDetailPopup:!0})})),Object(l.s)(X,(function(e){return Object.assign(Object.assign({},e),{isOpenAllotmentDetailPopup:!1})})),Object(l.s)(z,(function(e){return Object.assign(Object.assign({},e),{isOpenStopSaleDetailPopup:!0})})),Object(l.s)(Q,(function(e){return Object.assign(Object.assign({},e),{isOpenStopSaleDetailPopup:!1})})),Object(l.s)(K,(function(e){return Object.assign(Object.assign({},e),{isOpenPromotionDetailPopup:!0})})),Object(l.s)(J,(function(e){return Object.assign(Object.assign({},e),{isOpenPromotionDetailPopup:!1})})));function ee(e,t){return Object(l.m)({planDetailSharedMaster:Z})(e,t)}var te,ne,oe,ae,ie=Object(l.p)("rateAllotmentShared"),re=Object(l.r)(ie,(function(e){return e.planDetailSharedMaster})),le=Object(l.r)(re,(function(e){return e.rateAllotmentList})),ce=Object(l.r)(re,(function(e){return e.rateAllotmentListSearchCondition})),se=Object(l.r)(re,(function(e){return e.promotionTypeList})),ue=Object(l.r)(re,(function(e){return e.otherSearchInfo})),pe=Object(l.r)(re,(function(e){return e.checkedDateInfo})),de=Object(l.r)(re,(function(e){return e.mainLoading})),me=Object(l.r)(re,(function(e){return e.isOpenCalendarPopup})),be=Object(l.r)(re,(function(e){return e.isOpenPlanDetailPopup})),he=Object(l.r)(re,(function(e){return e.isOpenRoomDetailPopup})),fe=Object(l.r)(re,(function(e){return e.isOpenRateDetailPopup})),ve=Object(l.r)(re,(function(e){return e.isOpenAllotmentDetailPopup})),ye=Object(l.r)(re,(function(e){return e.isOpenStopSaleDetailPopup})),Pe=Object(l.r)(re,(function(e){return e.isOpenPromotionDetailPopup})),Ce=(Object(l.r)(re,(function(e){return e.expandedTreeData})),Object(l.r)(re,(function(e){return e.currentYear}))),ge=Object(l.r)(re,(function(e){return e.currentMonth})),De=Object(l.r)(re,(function(e){return e.contractTypeCodeList})),ke=Object(l.r)(re,(function(e){return e.promotionCheckedDateInfo})),Se=n("XNiG"),Ie=n("VRyK"),Oe=n("1G5W"),Re=n("pLZG"),Te=n("LvDl"),Ve=n("pfiq"),Ae=n("itXk"),Ne=n("IzEk"),Fe=n("Kj3r"),_e=n("zP0r"),Ee=n("fXoL"),Le=n("0qeV"),We=n("wd/R"),xe=n.n(We),je=((te=_createClass((function e(t){var n=this;_classCallCheck(this,e),this.fb=t,this.generateSearchForm=function(){return n.fb.group({hotelCode:[null,i.z.required],hotelNameEn:[null],ownerCompCode:[11e4],sellerCompCode:[0],contractTypes:[null],vendorRoomTypeSeq:[null],onSalesOnly:[!0],hasPriceOnly:[!0],hasAllotmentOnly:[!0],yearMonth:[We().format("YYYYMM")],year:[We().format("YYYY")],month:[We().format("MM")]})},this.initSearchFormData=function(){return{hotelCode:null,hotelNameEn:null,ownerCompCode:11e4,sellerCompCode:0,contractTypes:[],vendorRoomTypeSeq:null,onSalesOnly:!0,hasPriceOnly:!0,hasAllotmentOnly:!0,yearMonth:We().format("YYYYMM")}}}))).\u0275fac=function(e){return new(e||te)(Ee.bc(i.f))},te.\u0275prov=Ee.Mb({token:te,factory:te.\u0275fac,providedIn:"root"}),te),Ye=n("xDUJ"),Me=n("bMKz"),$e=n("+Sob"),qe=n("0xcq"),we=n("U6NN"),He=n("pb6r"),Ue=function(){return["hotelCode","hotelNameEn"]},Ge=function(){return["CMP02"]},Be=function(e){return{compTypeCodes:e}},Xe=function(){return["compCode","compName"]},ze=((ne=function(){function e(t,n,o,a,i,r,c){_classCallCheck(this,e),this.service=t,this.formBuilder=n,this._dataService=o,this.cd=a,this.formService=i,this.UserConditionService=r,this.store=c,this.roomTypeOptions=[],this.unsubscribe$=new Se.a,this.loading$=c.pipe(Object(l.u)(de)),this.searchCondition$=c.pipe(Object(l.u)(ce)),this.otherSearchInfo$=c.pipe(Object(l.u)(ue)),this.currentYear$=c.pipe(Object(l.u)(Ce)),this.currentMonth$=c.pipe(Object(l.u)(ge)),this.contractTypeCodeList$=c.pipe(Object(l.u)(De)),this.searchForm=this._dataService.generateSearchForm()}return _createClass(e,[{key:"searchCondition",get:function(){return this._searchCondition},set:function(e){this._searchCondition=e,e&&this.searchForm.patchValue(this._setSearchFormData(e))}},{key:"ngOnInit",value:function(){this._loadDetailCode(),this._initSubscription(),this._initSearchCondition()}},{key:"ngOnDestroy",value:function(){this.unsubscribe$.next(),this.unsubscribe$.complete()}},{key:"onSelectHotel",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=e.hotelCode,a=e.hotelNameEn;this.searchForm.get("hotelNameEn").setValue(a),n||this.searchForm.get("vendorRoomTypeSeq").reset(),this.service.getRoomTypeList({hotelCode:o}).pipe(Object(Ne.a)(1)).subscribe((function(e){t.roomTypeOptions=e,t.cd.detectChanges()}))}},{key:"checkIsInvalid",value:function(e){return this.checkValid&&this.searchForm.get(e)&&this.searchForm.get(e).invalid}},{key:"onSubmit",value:function(){if(this.searchForm.invalid)this.checkValid=!0;else{var e=Te.cloneDeep(this.searchForm.value);this.store.dispatch(T());var t=this._setOtherSearchCondition();this.store.dispatch(A({condition:e,otherSearchInfo:t})),this.UserConditionService.setSearchSettingSessionStorage(e,"rate&allotment",t),this.checkValid=!1}}},{key:"onReset",value:function(){this.roomTypeOptions=[],this.searchForm=this._dataService.generateSearchForm()}},{key:"_setOtherSearchInfo",value:function(e){this.sellerInput=(null==e?void 0:e.sellerInput)||null,this.hotelInput=(null==e?void 0:e.hotelInput)||null}},{key:"_setSearchFormData",value:function(e){var t=this._dataService.initSearchFormData();return Te.isEmpty(e)?t:Object.assign({},t,Te.pick(e,Object.keys(t)))}},{key:"_setOtherSearchCondition",value:function(){var e={};return this.autoCopmpletes.forEach((function(t){Object.assign(e,t.getInputValue())})),e}},{key:"_setSearchCondition",value:function(e){return Te.omitBy(e,Te.isNil)}},{key:"_initSubscription",value:function(){var e=this;Object(Ae.a)([this.searchCondition$]).pipe(Object(Fe.a)(200),Object(Re.a)((function(e){var t=_slicedToArray(e,1)[0];return!Te.isEmpty(t)})),Object(Oe.a)(this.unsubscribe$),Object(_e.a)(1)).subscribe((function(t){var n=_slicedToArray(t,1)[0],o=Object.assign({},e._setSearchCondition(n));e.store.dispatch(k({condition:o}))})),this.otherSearchInfo$.pipe(Object(Oe.a)(this.unsubscribe$)).subscribe((function(t){e.otherSearchInfo=t,e._setOtherSearchInfo(t)})),this.currentYear$.pipe(Object(_e.a)(1),Object(Oe.a)(this.unsubscribe$)).subscribe((function(t){e.searchForm.get("year").patchValue(t),e.searchForm.get("yearMonth").patchValue("".concat(t).concat(e.searchForm.get("month").value)),e.onSubmit()})),this.currentMonth$.pipe(Object(_e.a)(1),Object(Oe.a)(this.unsubscribe$)).subscribe((function(t){e.searchForm.get("month").patchValue(t),e.searchForm.get("yearMonth").patchValue("".concat(e.searchForm.get("year").value).concat(t)),e.onSubmit()})),this.contractTypeCodeList$.pipe(Object(_e.a)(1),Object(Oe.a)(this.unsubscribe$)).subscribe((function(t){e.contractTypeCodeList=t})),this.searchForm.get("hotelCode").valueChanges.pipe(Object(Oe.a)(this.unsubscribe$)).subscribe((function(t){e.service.getRoomTypeList({hotelCode:t}).pipe(Object(Ne.a)(1)).subscribe((function(t){e.roomTypeOptions=t,e.cd.detectChanges()}))}))}},{key:"_initSearchCondition",value:function(){var e=this;if(this.searchCondition$.subscribe((function(t){e.searchCondition=t})),0===Te.size(this.searchCondition)){var t=this._dataService.initSearchFormData(),n=this.UserConditionService.selectSearchSetting(t,"rate&allotment");this.store.dispatch(A({condition:n[0],otherSearchInfo:n[1]}))}}},{key:"_loadDetailCode",value:function(){this.store.dispatch(_({condition:{masterCode:"HO023"}}))}}]),e}()).\u0275fac=function(e){return new(e||ne)(Ee.Qb(Le.a),Ee.Qb(i.f),Ee.Qb(je),Ee.Qb(Ee.h),Ee.Qb(Ye.a),Ee.Qb(Me.a),Ee.Qb(l.h))},ne.\u0275cmp=Ee.Kb({type:ne,selectors:[["app-search"]],viewQuery:function(e,t){var n;1&e&&Ee.Xc(Ve.a,!0),2&e&&Ee.Dc(n=Ee.gc())&&(t.autoCopmpletes=n)},decls:38,vars:27,consts:[[1,"grid-search-box","multi",3,"formGroup","connectForm"],[1,"form-option-area"],[1,"row"],[1,"col-2"],[1,"form-label"],["formControlName","hotelCode","apiUrl","common/hotel/list","dataKey","hotelCode","inputFieldFormat","{0} - &{1}","placeholder","Code or Name",1,"d-inline-flex","flex-fill",3,"inputFieldValue","inputId","apiSearchTerm","inputFieldFormatKeyList","isInvalid","onSelect"],["inputId","sellerInput","formControlName","sellerCompCode","apiUrl","common/comp","dataKey","compCode","inputFieldFormat","[{0}] {1}","placeholder","Code or Name",1,"d-inline-flex","flex-fill",3,"inputFieldValue","apiCondition","apiSearchTerm","inputFieldFormatKeyList","isInvalid"],[1,"col-1"],["formControlName","contractTypes","dataKey","detailCode","displayWord","detailCodeName",1,"d-inline-flex","flex-fill",3,"options","useAllOptionYn"],["formControlName","vendorRoomTypeSeq",1,"d-inline-flex","flex-fill",3,"options"],["name","onSalesOnly","label","On Sale Only","formControlName","onSalesOnly",3,"binary"],["name","hasPriceOnly","label","Has Price Only","formControlName","hasPriceOnly",3,"binary"],["name","hasAllotmentOnly","label","Has Allotment Only","formControlName","hasAllotmentOnly",3,"binary"],[1,"form-button-area"],[1,"btn","btn-primary","sm",3,"click"],[1,"btn","btn-reset","sm",3,"click"],[1,"loading-mask","pos-fixed"],[1,"content-loading","align-items-center"],[1,"icon-loading","lg"],[1,"loading-title"]],template:function(e,t){1&e&&(Ee.Wb(0,"form",0),Ee.Wb(1,"div",1),Ee.Wb(2,"div",2),Ee.Wb(3,"div",3),Ee.Wb(4,"span",4),Ee.Wb(5,"sup"),Ee.Pc(6,"Hotel"),Ee.Vb(),Ee.Vb(),Ee.Wb(7,"app-auto-complete",5),Ee.fc("onSelect",(function(e){return t.onSelectHotel(e)})),Ee.Vb(),Ee.Vb(),Ee.Wb(8,"div",3),Ee.Wb(9,"span",4),Ee.Pc(10,"Seller"),Ee.Vb(),Ee.Rb(11,"app-auto-complete",6),Ee.Vb(),Ee.Vb(),Ee.Wb(12,"div",2),Ee.Wb(13,"div",7),Ee.Wb(14,"span",4),Ee.Pc(15,"Contract Type"),Ee.Vb(),Ee.Rb(16,"app-multi-select-detailcode",8),Ee.Vb(),Ee.Wb(17,"div",7),Ee.Wb(18,"span",4),Ee.Pc(19,"Room Type"),Ee.Vb(),Ee.Rb(20,"app-selectbox",9),Ee.Vb(),Ee.Wb(21,"div",7),Ee.Rb(22,"app-checkbox",10),Ee.Vb(),Ee.Wb(23,"div",7),Ee.Rb(24,"app-checkbox",11),Ee.Vb(),Ee.Wb(25,"div",7),Ee.Rb(26,"app-checkbox",12),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Wb(27,"div",13),Ee.Wb(28,"button",14),Ee.fc("click",(function(){return t.onSubmit()})),Ee.Pc(29," Search "),Ee.Vb(),Ee.Wb(30,"button",15),Ee.fc("click",(function(){return t.onReset()})),Ee.Pc(31,"Reset"),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Wb(32,"div",16),Ee.ic(33,"async"),Ee.Wb(34,"div",17),Ee.Rb(35,"div",18),Ee.Wb(36,"div",19),Ee.Pc(37,"loading..."),Ee.Vb(),Ee.Vb(),Ee.Vb()),2&e&&(Ee.pc("formGroup",t.searchForm)("connectForm",t.searchForm),Ee.Cb(7),Ee.pc("inputFieldValue",t.hotelInput)("inputId","hotelInput")("apiSearchTerm","keyword")("inputFieldFormatKeyList",Ee.tc(22,Ue))("isInvalid",t.checkIsInvalid("hotelCode")),Ee.Cb(4),Ee.pc("inputFieldValue",t.sellerInput)("apiCondition",Ee.uc(24,Be,Ee.tc(23,Ge)))("apiSearchTerm","compName")("inputFieldFormatKeyList",Ee.tc(26,Xe))("isInvalid",t.checkIsInvalid("sellerCompCode")),Ee.Cb(5),Ee.pc("options",t.contractTypeCodeList)("useAllOptionYn",!0),Ee.Cb(4),Ee.pc("options",t.roomTypeOptions),Ee.Cb(2),Ee.pc("binary",!0),Ee.Cb(2),Ee.pc("binary",!0),Ee.Cb(2),Ee.pc("binary",!0),Ee.Cb(6),Ee.Gb("active",Ee.jc(33,20,t.loading$)))},directives:[i.B,i.s,i.k,$e.a,Ve.a,i.r,i.i,qe.a,we.a,He.a],pipes:[a.b],styles:[".form[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;margin-bottom:0}.orangeButton[_ngcontent-%COMP%]{background-color:#f35c3a;color:#fff}.shortForm[_ngcontent-%COMP%]{max-width:500px;min-width:500px}.calendarWrapper[_ngcontent-%COMP%]{display:flex}.seperatorLine[_ngcontent-%COMP%]{width:1px;background-color:#e0e0e0;height:120px;margin:-16px 12px}"],changeDetection:0}),ne),Qe=n("EsKh"),Ke=((oe=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getPlanListByTypeData",value:function(e,t){var n,o=[],a=[],i=[],r=_createForOfIteratorHelper(e.vendorRoomTypes);try{for(r.s();!(n=r.n()).done;){var l=n.value,c=this._getRoomType(l);o.push(c);var s=l.vendorRoomPlans;if(s){var u,p=_createForOfIteratorHelper(s);try{for(p.s();!(u=p.n()).done;){var d=u.value,m=this._getRatePlan(l,d);a.push(m);var b=d.planPromotions;if(b){var h,f=_createForOfIteratorHelper(b);try{for(f.s();!(h=f.n()).done;){var v=h.value,y=v.promotionDetails;if(y){var P,C=_createForOfIteratorHelper(y);try{for(C.s();!(P=C.n()).done;){var g=P.value;if(!Te.isNil(g.derivedRoomPlanSeq)&&g.manualInsertYn){var D=this._getPromotionPlan(l,d,v,g);i.push(D)}}}catch(k){C.e(k)}finally{C.f()}}}}catch(k){f.e(k)}finally{f.f()}}}}catch(k){p.e(k)}finally{p.f()}}}}catch(k){r.e(k)}finally{r.f()}return{roomTypeList:o.filter((function(e){return Te.isObject(e)})).filter((function(e){var n,o;return!!Te.isNil(null===(o=null===(n=t[0])||void 0===n?void 0:n.rooms[0])||void 0===o?void 0:o.roomId)||e.vendorRoomTypeSeq===t[0].rooms[0].roomId})).filter((function(e){var n,o;return!!Te.isNil(null===(o=null===(n=t[0])||void 0===n?void 0:n.plans[0])||void 0===o?void 0:o.planId)||e.vendorRoomPlanSeq===t[0].plans[0].planId})),ratePlanList:a.filter((function(e){return Te.isObject(e)})).filter((function(e){var n,o;return!!Te.isNil(null===(o=null===(n=t[0])||void 0===n?void 0:n.rooms[0])||void 0===o?void 0:o.roomId)||e.vendorRoomTypeSeq===t[0].rooms[0].roomId})).filter((function(e){var n,o;return!!Te.isNil(null===(o=null===(n=t[0])||void 0===n?void 0:n.plans[0])||void 0===o?void 0:o.planId)||e.vendorRoomPlanSeq===t[0].plans[0].planId})),promotionPlanList:i.filter((function(e){return Te.isObject(e)})).filter((function(e){var n,o;return!!Te.isNil(null===(o=null===(n=t[0])||void 0===n?void 0:n.rooms[0])||void 0===o?void 0:o.roomId)||e.vendorRoomTypeSeq===t[0].rooms[0].roomId})).filter((function(e){var n,o;return!!Te.isNil(null===(o=null===(n=t[0])||void 0===n?void 0:n.plans[0])||void 0===o?void 0:o.planId)||e.vendorRoomPlanSeq===t[0].plans[0].planId}))}}},{key:"_getRoomType",value:function(e){return{vendorRoomTypeSeq:e.vendorRoomTypeSeq,vendorRoomPlanSeq:null,roomTypeNameEn:e.vendorRoomTypeNameEn,roomPlanNameEn:null,salesStopYn:e.salesStopYn}}},{key:"_getRatePlan",value:function(e,t){return{vendorRoomTypeSeq:e.vendorRoomTypeSeq,vendorRoomPlanSeq:t.vendorRoomPlanSeq,roomTypeNameEn:e.vendorRoomTypeNameEn,roomPlanNameEn:t.roomPlanNameEn,salesStopYn:t.salesStopYn}}},{key:"_getPromotionPlan",value:function(e,t,n,o){return{vendorRoomTypeSeq:e.vendorRoomTypeSeq,vendorRoomPlanSeq:o.derivedRoomPlanSeq,roomTypeNameEn:e.vendorRoomTypeNameEn,roomPlanNameEn:t.roomPlanNameEn,planPromotionSeq:o.planPromotionSeq,planPromotionName:n.planPromotionName,salesStopYn:t.salesStopYn}}}]),e}()).\u0275fac=function(e){return new(e||oe)},oe.\u0275prov=Ee.Mb({token:oe,factory:oe.\u0275fac,providedIn:"root"}),oe),Je=n("OMYy"),Ze=((ae=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getPlanListByTypeData",value:function(e){var t,n=[],o=[],a=_createForOfIteratorHelper(e.vendorRoomTypes);try{for(a.s();!(t=a.n()).done;){var i=t.value,r=i.vendorRoomPlans;if(r){var l,c=_createForOfIteratorHelper(r);try{for(c.s();!(l=c.n()).done;){var s=l.value;if(!s.salesStopYn){var u=this._getRoomPlan(e,i,s);n.push(u);var p=s.planPromotions;if(p){var d,m=_createForOfIteratorHelper(p);try{for(m.s();!(d=m.n()).done;){var b=d.value,h=b.promotionDetails;if(h){var f,v=_createForOfIteratorHelper(h);try{for(v.s();!(f=v.n()).done;){var y=f.value;if(!Te.isNil(y.derivedRoomPlanSeq)&&y.manualInsertYn){var P=this._getPromotionPlan(e,i,s,b,y);o.push(P)}}}catch(C){v.e(C)}finally{v.f()}}}}catch(C){m.e(C)}finally{m.f()}}}}}catch(C){c.e(C)}finally{c.f()}}}}catch(C){a.e(C)}finally{a.f()}return{roomPlanList:n,promotionPlanList:o}}},{key:"_getRoomPlan",value:function(e,t,n){return{netProvideYn:e.netProvideYn,vendorCommRate:e.vendorCommRate,hotelContractTypeCode:e.hotelContractTypeCode,hotelContractSeq:e.hotelContractSeq,currencyCode:e.currencyCode,sendAmountTypeCode:e.sendAmountTypeCode,extraTaxPaymentYn:e.extraTaxPaymentYn,vendorRoomTypeSeq:null==t?void 0:t.vendorRoomTypeSeq,vendorRoomPlanSeq:null==n?void 0:n.vendorRoomPlanSeq,roomPlanNameEn:"[".concat(null==n?void 0:n.vendorRoomPlanSeq,"] ").concat(null==t?void 0:t.vendorRoomTypeNameEn," - ").concat(null==n?void 0:n.roomPlanNameEn)}}},{key:"_getPromotionPlan",value:function(e,t,n,o,a){return{netProvideYn:e.netProvideYn,vendorCommRate:e.vendorCommRate,hotelContractTypeCode:e.hotelContractTypeCode,hotelContractSeq:e.hotelContractSeq,currencyCode:e.currencyCode,sendAmountTypeCode:e.sendAmountTypeCode,extraTaxPaymentYn:e.extraTaxPaymentYn,planPromotionSeq:a.planPromotionSeq,vendorRoomTypeSeq:t.vendorRoomTypeSeq,vendorRoomPlanSeq:a.derivedRoomPlanSeq,promotionPlanNameEn:"".concat(o.planPromotionName," - ").concat(o.planPromotionTypeName," : ").concat(a.checkInFromDate," ~ ").concat(a.checkInToDate)}}}]),e}()).\u0275fac=function(e){return new(e||ae)},ae.\u0275prov=Ee.Mb({token:ae,factory:ae.\u0275fac,providedIn:"root"}),ae);function et(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"button",7),Ee.fc("click",(function(){Ee.Fc(n);var e=Ee.hc().$implicit;return Ee.hc().openAddPromotion(e.planPromotionName)})),Ee.Rb(1,"i",8),Ee.Vb()}}function tt(e,t){1&e&&(Ee.Ub(0),Ee.Rb(1,"td"),Ee.Tb())}function nt(e,t){if(1&e&&(Ee.Ub(0),Ee.Nc(1,tt,2,0,"ng-container",0),Ee.Tb()),2&e){var n=t.$implicit,o=Ee.hc(3);Ee.Cb(1),Ee.pc("ngForOf",o.getFullDate(n.dailyPrices))}}function ot(e,t){if(1&e&&(Ee.Ub(0),Ee.Nc(1,nt,2,1,"ng-container",0),Ee.Tb()),2&e){var n=t.$implicit;Ee.Cb(1),Ee.pc("ngForOf",n.adultCounts)}}function at(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"button",14),Ee.fc("click",(function(){Ee.Fc(n);var e=Ee.hc(3).$implicit;return Ee.hc(3).openModifyPromotion(e)})),Ee.Pc(1),Ee.ic(2,"date"),Ee.ic(3,"date"),Ee.Vb()}if(2&e){var o=Ee.hc(3).$implicit;Ee.sc("title","",o.planPromotionSeq," : ",o.planPromotionName,""),Ee.Cb(1),Ee.Sc(" ",Ee.kc(2,4,o.checkInFromDate,"MM-dd"),"~",Ee.kc(3,7,o.checkInToDate,"MM-dd")," ")}}function it(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"span",16),Ee.fc("click",(function(){Ee.Fc(n);var e=Ee.hc(4).$implicit,t=Ee.hc(2).$implicit;return Ee.hc().openRateHandler(t,e)})),Ee.Pc(1," M "),Ee.Vb()}}function rt(e,t){if(1&e&&(Ee.Wb(0,"button"),Ee.Nc(1,it,2,0,"span",15),Ee.Vb()),2&e){var n=Ee.hc(3).$implicit;Ee.Cb(1),Ee.pc("ngIf",n.manualInsertYn)}}function lt(e,t){if(1&e&&(Ee.Ub(0),Ee.Wb(1,"span",17),Ee.Pc(2),Ee.Vb(),Ee.Tb()),2&e){var n=Ee.hc().$implicit;Ee.Cb(2),Ee.Rc("",n.adultCount," ADT")}}function ct(e,t){if(1&e&&(Ee.Ub(0),Ee.Wb(1,"span",21),Ee.Pc(2),Ee.ic(3,"number"),Ee.Vb(),Ee.Tb()),2&e){var n=Ee.hc(4).$implicit;Ee.Cb(2),Ee.Qc(Ee.jc(3,1,n.vendorSellingNetAmount))}}function st(e,t){if(1&e&&(Ee.Ub(0),Ee.Wb(1,"span"),Ee.Pc(2),Ee.ic(3,"number"),Ee.Vb(),Ee.Nc(4,ct,4,3,"ng-container",6),Ee.Wb(5,"span"),Ee.Pc(6),Ee.ic(7,"number"),Ee.Vb(),Ee.Tb()),2&e){var n=Ee.hc(3).$implicit,o=Ee.hc(6);Ee.Cb(2),Ee.Rc(" ",Ee.kc(3,3,n.vendorNetAmount+n.vendorTaxAmount,".2"),""),Ee.Cb(2),Ee.pc("ngIf","HOC01"===o.contractData.hotelContractTypeCode),Ee.Cb(2),Ee.Rc("(",Ee.kc(7,6,n.vendorGrossMspAmount,".2"),")")}}function ut(e,t){if(1&e&&(Ee.Ub(0),Ee.Wb(1,"span",21),Ee.Pc(2),Ee.ic(3,"number"),Ee.Vb(),Ee.Tb()),2&e){var n=Ee.hc(4).$implicit;Ee.Cb(2),Ee.Qc(Ee.jc(3,1,n.vendorSellingNetAmount))}}function pt(e,t){if(1&e&&(Ee.Wb(0,"span"),Ee.Pc(1),Ee.ic(2,"number"),Ee.Vb(),Ee.Nc(3,ut,4,3,"ng-container",6),Ee.Wb(4,"span"),Ee.Pc(5),Ee.ic(6,"number"),Ee.Vb()),2&e){var n=Ee.hc(3).$implicit,o=Ee.hc(6);Ee.Cb(1),Ee.Rc(" ",Ee.jc(2,3,n.vendorNetAmount+n.vendorTaxAmount),""),Ee.Cb(2),Ee.pc("ngIf","HOC01"===o.contractData.hotelContractTypeCode),Ee.Cb(2),Ee.Rc("(",Ee.jc(6,5,n.vendorGrossMspAmount),")")}}var dt=function(e,t){return{stop:e,derived:t}};function mt(e,t){if(1&e&&(Ee.Wb(0,"p",19),Ee.Nc(1,st,8,9,"ng-container",9),Ee.Nc(2,pt,7,7,"ng-template",null,20,Ee.Oc),Ee.Vb()),2&e){var n=Ee.Ec(3),o=Ee.hc(2).$implicit,a=Ee.hc(3).$implicit,i=Ee.hc(3);Ee.pc("ngClass",Ee.vc(3,dt,a.salesStopYn||o.salesStopYn,i.planData.originRoomPlanSeq)),Ee.Cb(1),Ee.pc("ngIf","USD"==i.contractData.currencyCode)("ngIfElse",n)}}function bt(e,t){if(1&e&&(Ee.Ub(0),Ee.Nc(1,mt,4,6,"p",18),Ee.Tb()),2&e){var n=Ee.hc().$implicit;Ee.Cb(1),Ee.pc("ngIf",!!n.appliedDate)}}function ht(e,t){if(1&e&&(Ee.Wb(0,"td"),Ee.Nc(1,bt,2,1,"ng-container",6),Ee.Vb()),2&e){var n=t.$implicit;Ee.Cb(1),Ee.pc("ngIf",n.vendorNetAmount+n.vendorTaxAmount>0)}}function ft(e,t){if(1&e&&(Ee.Wb(0,"tr",12),Ee.Wb(1,"th"),Ee.Nc(2,at,4,10,"button",13),Ee.Nc(3,rt,2,1,"button",6),Ee.Nc(4,lt,3,1,"ng-container",6),Ee.Vb(),Ee.Nc(5,ht,2,1,"td",0),Ee.Vb()),2&e){var n=t.$implicit,o=t.index,a=Ee.hc(5);Ee.Cb(2),Ee.pc("ngIf",0==o),Ee.Cb(1),Ee.pc("ngIf",0==o),Ee.Cb(1),Ee.pc("ngIf",!(0===n.adultCount&&a.roomChargeYn)),Ee.Cb(1),Ee.pc("ngForOf",a.getFullDate(n.dailyPrices))}}function vt(e,t){if(1&e&&(Ee.Ub(0),Ee.Nc(1,ft,6,4,"tr",11),Ee.Tb()),2&e){var n=Ee.hc().$implicit;Ee.Cb(1),Ee.pc("ngForOf",n.adultCounts)}}function yt(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"span",16),Ee.fc("click",(function(){Ee.Fc(n);var e=Ee.hc(2).$implicit,t=Ee.hc(2).$implicit;return Ee.hc().openRateHandler(t,e)})),Ee.Pc(1," M "),Ee.Vb()}}function Pt(e,t){1&e&&Ee.Rb(0,"td")}var Ct=function(){return[]};function gt(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"tr",12),Ee.Wb(1,"th"),Ee.Wb(2,"button",14),Ee.fc("click",(function(){Ee.Fc(n);var e=Ee.hc().$implicit;return Ee.hc(3).openModifyPromotion(e)})),Ee.Pc(3),Ee.ic(4,"date"),Ee.ic(5,"date"),Ee.Vb(),Ee.Wb(6,"button"),Ee.Nc(7,yt,2,0,"span",15),Ee.Vb(),Ee.Vb(),Ee.Nc(8,Pt,1,0,"td",0),Ee.Vb()}if(2&e){var o=Ee.hc().$implicit,a=Ee.hc(3);Ee.Cb(2),Ee.sc("title","",o.planPromotionSeq," : ",o.planPromotionName,""),Ee.Cb(1),Ee.Sc(" ",Ee.kc(4,6,o.checkInFromDate,"MM-dd"),"~",Ee.kc(5,9,o.checkInToDate,"MM-dd")," "),Ee.Cb(4),Ee.pc("ngIf",o.manualInsertYn),Ee.Cb(1),Ee.pc("ngForOf",Ee.tc(12,Ct).constructor(a.getDayCount()))}}function Dt(e,t){if(1&e&&(Ee.Ub(0),Ee.Nc(1,vt,2,1,"ng-container",9),Ee.Nc(2,gt,9,13,"ng-template",null,10,Ee.Oc),Ee.Tb()),2&e){var n=t.$implicit,o=Ee.Ec(3);Ee.Cb(1),Ee.pc("ngIf",n.adultCounts)("ngIfElse",o)}}function kt(e,t){if(1&e&&(Ee.Ub(0),Ee.Nc(1,Dt,4,2,"ng-container",0),Ee.Tb()),2&e){var n=Ee.hc().$implicit;Ee.Cb(1),Ee.pc("ngForOf",n.promotionDetails)}}var St=function(e,t){return{"fa-minus":e,"fa-plus":t}};function It(e,t){if(1&e){var n=Ee.Xb();Ee.Ub(0),Ee.Wb(1,"tr",1),Ee.Wb(2,"th"),Ee.Wb(3,"button",2),Ee.Wb(4,"i",3),Ee.fc("click",(function(){Ee.Fc(n);var e=t.$implicit;return Ee.hc().toggleSubContentHandler(e.planPromotionTypeCode)})),Ee.Vb(),Ee.Vb(),Ee.Wb(5,"button",4),Ee.Pc(6),Ee.Vb(),Ee.Nc(7,et,2,0,"button",5),Ee.Vb(),Ee.Nc(8,ot,2,1,"ng-container",0),Ee.Vb(),Ee.Nc(9,kt,2,1,"ng-container",6),Ee.Tb()}if(2&e){var o=t.$implicit,a=Ee.hc();Ee.Cb(4),Ee.pc("ngClass",Ee.vc(6,St,a.isOpenSubContent(o.planPromotionTypeCode),!a.isOpenSubContent(o.planPromotionTypeCode))),Ee.Cb(1),Ee.qc("title",o.planPromotionTypeName),Ee.Cb(1),Ee.Rc(" ",o.planPromotionTypeName," "),Ee.Cb(1),Ee.pc("ngIf",a.checkPlusButtonShow(o)),Ee.Cb(1),Ee.pc("ngForOf",o.promotionDetails),Ee.Cb(1),Ee.pc("ngIf",a.isOpenSubContent(o.planPromotionTypeCode))}}var Ot,Rt=((Ot=function(){function e(t){_classCallCheck(this,e),this.store=t,this.openPromotionDetailEvent=new Ee.n,this.openRateDetailEvent=new Ee.n,this.unsubscribe$=new Se.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e,t=this;this.searchCondition$=this.store.pipe(Object(l.u)(ce)),this.searchCondition$.subscribe((function(e){t.condition=e})),this.subscribeToSearchCondition(),this.openPromotionIdList=null===(e=this.promotionData)||void 0===e?void 0:e.map((function(e){return e.planPromotionTypeCode}))}},{key:"ngOnChanges",value:function(e){var t,n;e.promotionData&&(this.openPromotionIdList=null!==(n=null===(t=this.promotionData)||void 0===t?void 0:t.map((function(e){return e.planPromotionTypeCode})))&&void 0!==n?n:[])}},{key:"ngOnDestroy",value:function(){this.unsubscribe$.next(),this.unsubscribe$.complete()}},{key:"toggleSubContentHandler",value:function(e){if(this.openPromotionIdList.find((function(t){return t===e})))this.openPromotionIdList=this.openPromotionIdList.filter((function(t){return t!==e}));else{var t=Te.cloneDeep(this.openPromotionIdList);t.push(e),this.openPromotionIdList=t}}},{key:"isOpenSubContent",value:function(e){return this.openPromotionIdList.find((function(t){return t===e}))}},{key:"subscribeToSearchCondition",value:function(){var e=this;this.searchCondition$=this.store.pipe(Object(l.u)(ce)),this.searchCondition$.subscribe((function(t){e.selectedHotelSimple=t&&{hotelCode:t.hotelCode,hotelNameEn:t.hotelNameEn}}))}},{key:"getFullDate",value:function(e){var t,n;if(!e)return[];var o=null!==(n=null===(t=this.condition)||void 0===t?void 0:t.yearMonth)&&void 0!==n?n:xe()().format("YYYYMM");return Object(Je.b)(o).map((function(e){return e.yyyymmdd})).map((function(t){var n=e.find((function(e){return e.appliedDate===t}));return Object.assign({},n)}))}},{key:"openAddPromotion",value:function(e){var t=Te.find(this.promotionData,{planPromotionName:e});if(t){var n=Te.take(t.promotionDetails,1);this.openPromotionDetailEvent.emit({isNewPromotion:!0,addWithOnlyDate:!0,planPromotionSeq:n[0].planPromotionSeq,list:[{vendorRoomTypeSeq:this.roomData.vendorRoomTypeSeq,vendorRoomPlanSeq:this.planData.vendorRoomPlanSeq,vendorRoomTypeNameEn:this.roomData.vendorRoomTypeNameEn,roomPlanNameEn:this.planData.roomPlanNameEn}]})}}},{key:"openModifyPromotion",value:function(e){this.openPromotionDetailEvent.emit({planPromotionSeq:e.planPromotionSeq,list:[{vendorRoomTypeSeq:this.roomData.vendorRoomTypeSeq,vendorRoomPlanSeq:this.planData.vendorRoomPlanSeq,vendorRoomTypeNameEn:this.roomData.vendorRoomTypeNameEn,roomPlanNameEn:this.planData.roomPlanNameEn}]})}},{key:"openRateHandler",value:function(e,t){var n={currencyCode:this.contractData.currencyCode,netProvideYn:this.contractData.netProvideYn,vendorCommRate:this.contractData.vendorCommRate,localPriceYn:this.contractData.localPriceYn,priceCmsPmsCompName:this.contractData.priceCmsPmsCompName,localAllotmentYn:this.contractData.localAllotmentYn,allotmentCmsPmsCompName:this.contractData.allotmentCmsPmsCompName,vendorSellingNetAmount:null,planPromotionSeq:t.planPromotionSeq,appliedFromDate:t.checkInFromDate,appliedToDate:t.checkInToDate,appliedMonYn:t.checkInMonYn,appliedTueYn:t.checkInTueYn,appliedWedYn:t.checkInWedYn,appliedThuYn:t.checkInThuYn,appliedFriYn:t.checkInFriYn,appliedSatYn:t.checkInSatYn,appliedSunYn:t.checkInSunYn};this.store.dispatch(R({data:[{hotelContractSeq:this.contractData.hotelContractSeq,rooms:[{roomId:this.roomData.vendorRoomTypeSeq,dates:[],type:"room",params:n}],plans:[{roomId:this.roomData.vendorRoomTypeSeq,planId:t.derivedRoomPlanSeq,dates:[],type:"plan",params:n}]}]})),this.openRateDetailEvent.emit()}},{key:"checkPlusButtonShow",value:function(e){var t=Te.head(e.promotionDetails);return!0!==(null==t?void 0:t.manualInsertYn)}},{key:"getDayCount",value:function(){return Number(xe()(this.condition.yearMonth).daysInMonth())}}]),e}()).\u0275fac=function(e){return new(e||Ot)(Ee.Qb(l.h))},Ot.\u0275cmp=Ee.Kb({type:Ot,selectors:[["app-promotion"]],inputs:{promotionData:"promotionData",contractData:"contractData",planData:"planData",roomData:"roomData",roomChargeYn:"roomChargeYn"},outputs:{openPromotionDetailEvent:"openPromotionDetailEvent",openRateDetailEvent:"openRateDetailEvent"},features:[Ee.Ab],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[1,"promotion-header"],["type","button",1,"btn-row-toggle"],[1,"fas",3,"ngClass","click"],["type","button",1,"btn-promotion",3,"title"],["type","button","class","btn-add-option",3,"click",4,"ngIf"],[4,"ngIf"],["type","button",1,"btn-add-option",3,"click"],[1,"fas","fa-plus"],[4,"ngIf","ngIfElse"],["onlyDate",""],["class","roomplan-include-option date",4,"ngFor","ngForOf"],[1,"roomplan-include-option","date"],["type","button","class","btn-roomplan-date",3,"title","click",4,"ngIf"],["type","button",1,"btn-roomplan-date",3,"title","click"],["class","manual yes",3,"click",4,"ngIf"],[1,"manual","yes",3,"click"],[1,"person-type"],["class","net",3,"ngClass",4,"ngIf"],[1,"net",3,"ngClass"],["otherCurrency",""],[2,"color","#0000BF"]],template:function(e,t){1&e&&Ee.Nc(0,It,10,9,"ng-container",0),2&e&&Ee.pc("ngForOf",t.promotionData)},directives:[a.n,a.l,a.o],pipes:[a.e,a.f],styles:["","[_nghost-%COMP%] {\n        display: contents;\n      }"],changeDetection:0}),Ot);function Tt(e,t){1&e&&(Ee.Wb(0,"span",12),Ee.Pc(1,"(H)"),Ee.Vb())}function Vt(e,t){1&e&&(Ee.Ub(0),Ee.Rb(1,"i",13),Ee.Tb())}function At(e,t){1&e&&Ee.Rb(0,"i",14)}var Nt=function(e){return{disabled:e}};function Ft(e,t){if(1&e&&Ee.Rb(0,"td",17),2&e){var n=t.$implicit,o=Ee.hc(2).$implicit;Ee.Gb("selling-stop",n.salesStopYn),Ee.pc("ngClass",Ee.uc(3,Nt,o.salesStopYn||n.salesStopYn))}}function _t(e,t){if(1&e&&(Ee.Ub(0,15),Ee.Nc(1,Ft,1,5,"td",16),Ee.Tb()),2&e){var n=t.$implicit,o=Ee.hc(2);Ee.Cb(1),Ee.pc("ngForOf",o.getFullDate(n.dailyPrices))("ngForTrackBy",o.trackByDate)}}function Et(e,t){if(1&e&&(Ee.Ub(0),Ee.Wb(1,"span",21),Ee.Pc(2),Ee.Vb(),Ee.Tb()),2&e){var n=Ee.hc().$implicit;Ee.Cb(2),Ee.Rc(" ",n.adultCount," ADT ")}}function Lt(e,t){if(1&e&&(Ee.Ub(0),Ee.Wb(1,"span",28),Ee.Pc(2),Ee.ic(3,"number"),Ee.Vb(),Ee.Tb()),2&e){var n=Ee.hc(4).$implicit;Ee.Cb(2),Ee.Qc(Ee.jc(3,1,n.vendorSellingNetAmount))}}function Wt(e,t){if(1&e&&(Ee.Ub(0),Ee.Wb(1,"span"),Ee.Pc(2),Ee.ic(3,"number"),Ee.Vb(),Ee.Nc(4,Lt,4,3,"ng-container",11),Ee.Wb(5,"span"),Ee.Pc(6),Ee.ic(7,"number"),Ee.Vb(),Ee.Tb()),2&e){var n=Ee.hc(3).$implicit,o=Ee.hc(4);Ee.Cb(2),Ee.Rc(" ",Ee.kc(3,3,n.vendorNetAmount+n.vendorTaxAmount,".2"),""),Ee.Cb(2),Ee.pc("ngIf","HOC01"===o.contractData.hotelContractTypeCode),Ee.Cb(2),Ee.Rc("(",Ee.kc(7,6,n.vendorGrossMspAmount,".2"),")")}}function xt(e,t){if(1&e&&(Ee.Ub(0),Ee.Wb(1,"span",28),Ee.Pc(2),Ee.ic(3,"number"),Ee.Vb(),Ee.Tb()),2&e){var n=Ee.hc(4).$implicit;Ee.Cb(2),Ee.Qc(Ee.jc(3,1,n.vendorSellingNetAmount))}}function jt(e,t){if(1&e&&(Ee.Wb(0,"span"),Ee.Pc(1),Ee.ic(2,"number"),Ee.Vb(),Ee.Nc(3,xt,4,3,"ng-container",11),Ee.Wb(4,"span"),Ee.Pc(5),Ee.ic(6,"number"),Ee.Vb()),2&e){var n=Ee.hc(3).$implicit,o=Ee.hc(4);Ee.Cb(1),Ee.Rc(" ",Ee.jc(2,3,n.vendorNetAmount+n.vendorTaxAmount),""),Ee.Cb(2),Ee.pc("ngIf","HOC01"===o.contractData.hotelContractTypeCode),Ee.Cb(2),Ee.Rc("(",Ee.jc(6,5,n.vendorGrossMspAmount),")")}}var Yt=function(e){return{stop:e}};function Mt(e,t){if(1&e&&(Ee.Wb(0,"p",26),Ee.Nc(1,Wt,8,9,"ng-container",8),Ee.Nc(2,jt,7,7,"ng-template",null,27,Ee.Oc),Ee.Vb()),2&e){var n=Ee.Ec(3),o=Ee.hc(2).$implicit,a=Ee.hc(3).$implicit,i=Ee.hc();Ee.pc("ngClass",Ee.uc(3,Yt,a.salesStopYn||o.salesStopYn)),Ee.Cb(1),Ee.pc("ngIf","USD"===i.contractData.currencyCode)("ngIfElse",n)}}function $t(e,t){if(1&e){var n=Ee.Xb();Ee.Ub(0),Ee.Wb(1,"label",22),Ee.Wb(2,"input",23),Ee.fc("click",(function(e){Ee.Fc(n);var t=Ee.hc().$implicit,o=Ee.hc(3).$implicit;return Ee.hc().changeCheckbox(e,t,o.vendorRoomPlanSeq)})),Ee.Vb(),Ee.Rb(3,"span",24),Ee.Vb(),Ee.Nc(4,Mt,4,5,"p",25),Ee.Tb()}if(2&e){var o=Ee.hc().$implicit;Ee.Cb(4),Ee.pc("ngIf",!!o.appliedDate)}}function qt(e,t){if(1&e&&(Ee.Wb(0,"td"),Ee.Nc(1,$t,5,1,"ng-container",11),Ee.Vb()),2&e){var n=t.$implicit;Ee.Gb("selling-stop",n.salesStopYn),Ee.Cb(1),Ee.pc("ngIf",!!n.appliedDate)}}function wt(e,t){if(1&e&&(Ee.Wb(0,"tr",19),Ee.Wb(1,"th"),Ee.Nc(2,Et,3,1,"ng-container",11),Ee.Vb(),Ee.Nc(3,qt,2,3,"td",20),Ee.Vb()),2&e){var n=t.$implicit,o=Ee.hc(2).$implicit,a=Ee.hc();Ee.Cb(2),Ee.pc("ngIf",!(0===n.adultCount&&o.roomChargeYn)),Ee.Cb(1),Ee.pc("ngForOf",a.getFullDate(n.dailyPrices))("ngForTrackBy",a.trackByDate)}}function Ht(e,t){if(1&e&&(Ee.Ub(0),Ee.Nc(1,wt,4,3,"tr",18),Ee.Tb()),2&e){var n=Ee.hc().$implicit;Ee.Cb(1),Ee.pc("ngForOf",n.adultCounts)}}function Ut(e,t){if(1&e&&(Ee.Ub(0),Ee.Wb(1,"span",21),Ee.Pc(2),Ee.Vb(),Ee.Tb()),2&e){var n=Ee.hc().$implicit;Ee.Cb(2),Ee.Rc(" ",n.adultCount," ADT ")}}function Gt(e,t){if(1&e&&(Ee.Ub(0),Ee.Wb(1,"span",28),Ee.Pc(2),Ee.ic(3,"number"),Ee.Vb(),Ee.Tb()),2&e){var n=Ee.hc(3).$implicit;Ee.Cb(2),Ee.Qc(Ee.jc(3,1,n.vendorSellingNetAmount))}}function Bt(e,t){if(1&e&&(Ee.Ub(0),Ee.Wb(1,"span"),Ee.Pc(2),Ee.ic(3,"number"),Ee.Vb(),Ee.Nc(4,Gt,4,3,"ng-container",11),Ee.Wb(5,"span"),Ee.Pc(6),Ee.ic(7,"number"),Ee.Vb(),Ee.Tb()),2&e){var n=Ee.hc(2).$implicit,o=Ee.hc(4);Ee.Cb(2),Ee.Rc(" ",Ee.kc(3,3,n.vendorNetAmount+n.vendorTaxAmount,".2"),""),Ee.Cb(2),Ee.pc("ngIf","HOC01"===o.contractData.hotelContractTypeCode),Ee.Cb(2),Ee.Rc("(",Ee.kc(7,6,n.vendorGrossMspAmount,".2"),")")}}function Xt(e,t){if(1&e&&(Ee.Ub(0),Ee.Wb(1,"span",28),Ee.Pc(2),Ee.ic(3,"number"),Ee.Vb(),Ee.Tb()),2&e){var n=Ee.hc(3).$implicit;Ee.Cb(2),Ee.Qc(Ee.jc(3,1,n.vendorSellingNetAmount))}}function zt(e,t){if(1&e&&(Ee.Wb(0,"span"),Ee.Pc(1),Ee.ic(2,"number"),Ee.Vb(),Ee.Nc(3,Xt,4,3,"ng-container",11),Ee.Wb(4,"span"),Ee.Pc(5),Ee.ic(6,"number"),Ee.Vb()),2&e){var n=Ee.hc(2).$implicit,o=Ee.hc(4);Ee.Cb(1),Ee.Rc(" ",Ee.jc(2,3,n.vendorNetAmount+n.vendorTaxAmount),""),Ee.Cb(2),Ee.pc("ngIf","HOC01"===o.contractData.hotelContractTypeCode),Ee.Cb(2),Ee.Rc("(",Ee.jc(6,5,n.vendorGrossMspAmount),")")}}function Qt(e,t){if(1&e){var n=Ee.Xb();Ee.Ub(0),Ee.Wb(1,"label",22),Ee.Wb(2,"input",29),Ee.fc("click",(function(e){Ee.Fc(n);var t=Ee.hc().$implicit,o=Ee.hc(3).$implicit;return Ee.hc().changeCheckbox(e,t,o.vendorRoomPlanSeq)})),Ee.Vb(),Ee.Rb(3,"span",24),Ee.Vb(),Ee.Wb(4,"p",26),Ee.Nc(5,Bt,8,9,"ng-container",8),Ee.Nc(6,zt,7,7,"ng-template",null,30,Ee.Oc),Ee.Vb(),Ee.Tb()}if(2&e){var o=Ee.Ec(7),a=Ee.hc().$implicit,i=Ee.hc(3).$implicit,r=Ee.hc();Ee.Cb(4),Ee.pc("ngClass",Ee.uc(3,Yt,i.salesStopYn||a.salesStopYn)),Ee.Cb(1),Ee.pc("ngIf","USD"===r.contractData.currencyCode)("ngIfElse",o)}}function Kt(e,t){if(1&e&&(Ee.Wb(0,"td"),Ee.Nc(1,Qt,8,5,"ng-container",11),Ee.Vb()),2&e){var n=t.$implicit;Ee.Gb("selling-stop",n.salesStopYn),Ee.Cb(1),Ee.pc("ngIf",!!n.appliedDate)}}function Jt(e,t){if(1&e&&(Ee.Wb(0,"tr",19),Ee.Wb(1,"th"),Ee.Nc(2,Ut,3,1,"ng-container",11),Ee.Vb(),Ee.Nc(3,Kt,2,3,"td",20),Ee.Vb()),2&e){var n=t.$implicit,o=Ee.hc(2).$implicit,a=Ee.hc();Ee.Cb(2),Ee.pc("ngIf",!(0===n.adultCount&&o.roomChargeYn)),Ee.Cb(1),Ee.pc("ngForOf",a.getFullDate(n.dailyPrices))("ngForTrackBy",a.trackByDate)}}function Zt(e,t){if(1&e&&(Ee.Ub(0),Ee.Nc(1,Jt,4,3,"tr",18),Ee.Tb()),2&e){var n=Ee.hc().$implicit;Ee.Cb(1),Ee.pc("ngForOf",n.adultCounts)}}function en(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"app-promotion",32),Ee.fc("openPromotionDetailEvent",(function(e){return Ee.Fc(n),Ee.hc(3).openPromotionDetailPopupHandler(e)}))("openRateDetailEvent",(function(){return Ee.Fc(n),Ee.hc(3).openRateDetailPopupHandler()})),Ee.Vb()}if(2&e){var o=Ee.hc(2).$implicit,a=Ee.hc();Ee.pc("promotionData",o.planPromotions)("roomChargeYn",o.roomChargeYn)("planData",o)("roomData",a.roomData)("contractData",a.contractData)}}function tn(e,t){if(1&e&&(Ee.Ub(0),Ee.Nc(1,en,1,5,"app-promotion",31),Ee.Tb()),2&e){var n=Ee.hc().$implicit,o=Ee.hc();Ee.Cb(1),Ee.pc("ngIf",o.isOpenSubContent(n.vendorRoomPlanSeq))}}var nn=function(e,t){return{"fa-minus":e,"fa-plus":t}},on=function(e){return{"text-decoration":e}};function an(e,t){if(1&e){var n=Ee.Xb();Ee.Ub(0),Ee.Wb(1,"tr",1),Ee.Wb(2,"th"),Ee.Wb(3,"button",2),Ee.Wb(4,"i",3),Ee.fc("click",(function(){Ee.Fc(n);var e=t.$implicit;return Ee.hc().toggleSubContentHandler(e.vendorRoomPlanSeq)})),Ee.Vb(),Ee.Vb(),Ee.Wb(5,"button",4),Ee.fc("click",(function(e){Ee.Fc(n);var o=t.$implicit;return Ee.hc().planPopupHandler(e,o)})),Ee.Wb(6,"span",5),Ee.Pc(7),Ee.Vb(),Ee.Vb(),Ee.Nc(8,Tt,2,0,"span",6),Ee.Wb(9,"span",7),Ee.Nc(10,Vt,2,0,"ng-container",8),Ee.Nc(11,At,1,0,"ng-template",null,9,Ee.Oc),Ee.Vb(),Ee.Vb(),Ee.Nc(13,_t,2,2,"ng-container",10),Ee.Vb(),Ee.Nc(14,Ht,2,1,"ng-container",11),Ee.Nc(15,Zt,2,1,"ng-container",11),Ee.Nc(16,tn,2,1,"ng-container",11),Ee.Tb()}if(2&e){var o=t.$implicit,a=Ee.Ec(12),i=Ee.hc();Ee.Cb(4),Ee.pc("ngClass",Ee.vc(12,nn,i.isOpenSubContent(o.vendorRoomPlanSeq),!i.isOpenSubContent(o.vendorRoomPlanSeq))),Ee.Cb(1),Ee.sc("title","",o.vendorRoomPlanSeq,"-",o.roomPlanNameEn,""),Ee.Cb(1),Ee.pc("ngStyle",Ee.uc(15,on,"D"===o.dataStatusCode?"line-through":"none")),Ee.Cb(1),Ee.Qc(o.roomPlanNameEn),Ee.Cb(1),Ee.pc("ngIf",o.hotelOwnerYn),Ee.Cb(2),Ee.pc("ngIf",o.roomChargeYn)("ngIfElse",a),Ee.Cb(3),Ee.pc("ngForOf",o.adultCounts),Ee.Cb(1),Ee.pc("ngIf",o.roomChargeYn&&i.isOpenSubContent(o.vendorRoomPlanSeq)),Ee.Cb(1),Ee.pc("ngIf",!o.roomChargeYn&&i.isOpenSubContent(o.vendorRoomPlanSeq)),Ee.Cb(1),Ee.pc("ngIf",!1===o.cmsInsertYn)}}var rn,ln=((rn=function(){function e(t){_classCallCheck(this,e),this.store=t,this.openPlanDetailEvent=new Ee.n,this.openPromotionDetailEvent=new Ee.n,this.openRateDetailEvent=new Ee.n,this.unsubscribe$=new Se.a,this.trackByPlan=function(e){return e.vendorRoomPlanSeq},this.trackByDate=function(e){return(null==e?void 0:e.appliedDate)?e.appliedDate.charAt(9)+e.appliedDate.charAt(8):null}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.searchCondition$=this.store.pipe(Object(l.u)(ce)),this.searchCondition$.pipe(Object(Oe.a)(this.unsubscribe$)).subscribe((function(t){e.selectedHotelSimple=t&&{hotelCode:t.hotelCode,hotelNameEn:t.hotelNameEn},e.yearMonth=t&&t.yearMonth})),this.selectedCheckedDate$=this.store.pipe(Object(l.u)(pe)),this.selectedCheckedDate$.pipe(Object(Oe.a)(this.unsubscribe$)).subscribe((function(t){e.checkedDateInfo=t})),this.planData&&(this.openPlanIdList=this.planData.map((function(e){return e.vendorRoomPlanSeq})))}},{key:"ngOnChanges",value:function(e){var t,n;e.planData&&(this.openPlanIdList=null!==(n=null===(t=this.planData)||void 0===t?void 0:t.map((function(e){return e.vendorRoomPlanSeq})))&&void 0!==n?n:[])}},{key:"ngOnDestroy",value:function(){this.unsubscribe$.next(),this.unsubscribe$.complete()}},{key:"toggleSubContentHandler",value:function(e){if(this.openPlanIdList.find((function(t){return t===e})))this.openPlanIdList=this.openPlanIdList.filter((function(t){return t!==e}));else{var t=Te.cloneDeep(this.openPlanIdList);t.push(e),this.openPlanIdList=t}}},{key:"isOpenSubContent",value:function(e){return this.openPlanIdList.find((function(t){return t===e}))}},{key:"planPopupHandler",value:function(e,t){this.openPlanDetailEvent.emit({planMasterInfo:t,planSeq:t.vendorRoomPlanSeq})}},{key:"getFullDate",value:function(e){if(!e)return[];var t=this.yearMonth?this.yearMonth:xe()().format("YYYYMM");return Object(Je.b)(t).map((function(e){return e.yyyymmdd})).map((function(t){var n=e.find((function(e){return e.appliedDate===t}));return Object.assign({},n)}))}},{key:"changeCheckbox",value:function(e,t,n){this.store.dispatch(O({data:{checked:e.target.checked,hotelContractSeq:this.contractData.hotelContractSeq,date:t.appliedDate,planId:n,roomId:this.vendorRoomTypeSeq,type:"plan",params:{vendorContractAmount:t.vendorContractAmount,vendorGrossAmount:t.vendorGrossMspAmount,vendorNetAmount:t.vendorNetAmount,vendorMspAmount:t.vendorGrossMspAmount,vendorTaxAmount:t.vendorTaxAmount,vendorSellingNetAmount:t.vendorSellingNetAmount,salesStopYn:t.salesStopYn,currencyCode:this.contractData.currencyCode,netProvideYn:this.contractData.netProvideYn,vendorCommRate:this.contractData.vendorCommRate,localPriceYn:this.contractData.localPriceYn,priceCmsPmsCompName:this.contractData.priceCmsPmsCompName,localAllotmentYn:this.contractData.localAllotmentYn,allotmentCmsPmsCompName:this.contractData.allotmentCmsPmsCompName,extraTaxPaymentYn:this.contractData.extraTaxPaymentYn}}}))}},{key:"openPromotionDetailPopupHandler",value:function(e){this.openPromotionDetailEvent.emit(e)}},{key:"openRateDetailPopupHandler",value:function(){this.openRateDetailEvent.emit()}}]),e}()).\u0275fac=function(e){return new(e||rn)(Ee.Qb(l.h))},rn.\u0275cmp=Ee.Kb({type:rn,selectors:[["app-plan"]],inputs:{planData:"planData",roomData:"roomData",contractData:"contractData",vendorRoomTypeSeq:"vendorRoomTypeSeq"},outputs:{openPlanDetailEvent:"openPlanDetailEvent",openPromotionDetailEvent:"openPromotionDetailEvent",openRateDetailEvent:"openRateDetailEvent"},features:[Ee.Ab],decls:1,vars:2,consts:[[4,"ngFor","ngForOf","ngForTrackBy"],[1,"roomplan-header","roomplan-include-option"],["type","button",1,"btn-row-toggle"],[1,"fas",3,"ngClass","click"],["type","button",1,"btn-roomplan",3,"title","click"],[3,"ngStyle"],["class","owner",4,"ngIf"],[1,"icon-group"],[4,"ngIf","ngIfElse"],["elseBlock",""],["class","dateContainer",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"owner"],[1,"fas","fa-bed"],[1,"fas","fa-male"],[1,"dateContainer"],["class","dateItem",3,"ngClass","selling-stop",4,"ngFor","ngForOf","ngForTrackBy"],[1,"dateItem",3,"ngClass"],["class","roomplan-include-option person",4,"ngFor","ngForOf"],[1,"roomplan-include-option","person"],[3,"selling-stop",4,"ngFor","ngForOf","ngForTrackBy"],[1,"person-type"],[1,"checkbox","only"],["type","checkbox","value","plan",1,"checkbox-control-input",3,"click"],[1,"checkbox-control-text"],["class","net",3,"ngClass",4,"ngIf"],[1,"net",3,"ngClass"],["otherCurrency1",""],[2,"color","#0000BF"],["type","checkbox",1,"checkbox-control-input",3,"click"],["otherCurrency2",""],[3,"promotionData","roomChargeYn","planData","roomData","contractData","openPromotionDetailEvent","openRateDetailEvent",4,"ngIf"],[3,"promotionData","roomChargeYn","planData","roomData","contractData","openPromotionDetailEvent","openRateDetailEvent"]],template:function(e,t){1&e&&Ee.Nc(0,an,17,17,"ng-container",0),2&e&&Ee.pc("ngForOf",t.planData)("ngForTrackBy",t.trackByPlan)},directives:[a.n,a.l,a.p,a.o,Rt],pipes:[a.f],styles:["","[_nghost-%COMP%] {\n        display: contents;\n      }"],changeDetection:0}),rn);function cn(e,t){if(1&e&&(Ee.Ub(0),Ee.Pc(1),Ee.Tb()),2&e){var n=Ee.hc(2).$implicit;Ee.Cb(1),Ee.Sc(" ",n.leftCountSum,"/",n.allotmentCountSum," ")}}function sn(e,t){if(1&e&&Ee.Pc(0),2&e){var n=Ee.hc(2).$implicit;Ee.Sc(" ",n.leftCountSum,"/",n.leftCountSum," ")}}var un=function(e,t,n){return{ohmy:e,cms:t,stop:n}};function pn(e,t){if(1&e){var n=Ee.Xb();Ee.Ub(0),Ee.Wb(1,"label",14),Ee.Wb(2,"input",15),Ee.fc("click",(function(e){Ee.Fc(n);var t=Ee.hc().$implicit,o=Ee.hc(3).$implicit;return Ee.hc().changeCheckbox(e,t,o.vendorRoomTypeSeq)})),Ee.Vb(),Ee.Rb(3,"span",16),Ee.Vb(),Ee.Wb(4,"p",17),Ee.Nc(5,cn,2,2,"ng-container",8),Ee.Nc(6,sn,1,2,"ng-template",null,18,Ee.Oc),Ee.Vb(),Ee.Tb()}if(2&e){var o=Ee.Ec(7),a=Ee.hc().$implicit,i=Ee.hc().$implicit;Ee.Cb(4),Ee.pc("ngClass",Ee.wc(3,un,i.localAllotmentYn,!i.localAllotmentYn,i.salesStopYn||a.salesStopYn)),Ee.Cb(1),Ee.pc("ngIf",i.localAllotmentYn)("ngIfElse",o)}}function dn(e,t){if(1&e&&(Ee.Wb(0,"td"),Ee.Nc(1,pn,8,7,"ng-container",13),Ee.Vb()),2&e){var n=t.$implicit;Ee.Gb("selling",!1===n.salesStopYn)("selling-stop",n.salesStopYn),Ee.Cb(1),Ee.pc("ngIf",null==n?null:n.appliedDay)}}function mn(e,t){if(1&e&&(Ee.Ub(0),Ee.Nc(1,dn,2,5,"td",12),Ee.Tb()),2&e){var n=t.$implicit,o=Ee.hc(3);Ee.Cb(1),Ee.pc("ngForOf",o.getFullDate(n.allotments))("ngForTrackBy",o.trackByDate)}}function bn(e,t){if(1&e&&(Ee.Ub(0),Ee.Nc(1,mn,2,2,"ng-container",11),Ee.Tb()),2&e){var n=Ee.hc().$implicit;Ee.Cb(1),Ee.pc("ngForOf",n.roomAllotments)}}function hn(e,t){1&e&&Ee.Rb(0,"td")}function fn(e,t){if(1&e&&Ee.Nc(0,hn,1,0,"td",11),2&e){var n=Ee.hc(2);Ee.pc("ngForOf",n.monthInfo)}}function vn(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"app-plan",19),Ee.fc("openPlanDetailEvent",(function(e){return Ee.Fc(n),Ee.hc(2).openPlanDetailPopupHandler(e)}))("openPromotionDetailEvent",(function(e){return Ee.Fc(n),Ee.hc(2).openPromotionDetailPopupHandler(e)}))("openRateDetailEvent",(function(){return Ee.Fc(n),Ee.hc(2).openRateDetailPopupHandler()})),Ee.Vb()}if(2&e){var o=Ee.hc().$implicit,a=Ee.hc();Ee.pc("planData",o.vendorRoomPlans)("vendorRoomTypeSeq",o.vendorRoomTypeSeq)("contractData",a.contractData)("roomData",o)}}var yn=function(e,t){return{"fa-minus":e,"fa-plus":t}},Pn=function(e){return{"text-decoration":e}};function Cn(e,t){if(1&e){var n=Ee.Xb();Ee.Ub(0),Ee.Wb(1,"tr",1),Ee.Wb(2,"th"),Ee.Wb(3,"button",2),Ee.Wb(4,"i",3),Ee.fc("click",(function(){Ee.Fc(n);var e=t.$implicit;return Ee.hc().toggleSubContentHandler(e.vendorRoomTypeSeq)})),Ee.Vb(),Ee.Vb(),Ee.Wb(5,"button",4),Ee.fc("click",(function(e){Ee.Fc(n);var o=t.$implicit;return Ee.hc().roomPopupHandler(e,o)})),Ee.Wb(6,"span",5),Ee.Pc(7),Ee.Vb(),Ee.Vb(),Ee.Wb(8,"button",6),Ee.fc("click",(function(e){Ee.Fc(n);var o=t.$implicit;return Ee.hc().calendarPopupHandler(e,o)})),Ee.Rb(9,"i",7),Ee.Vb(),Ee.Vb(),Ee.Nc(10,bn,2,1,"ng-container",8),Ee.Nc(11,fn,1,1,"ng-template",null,9,Ee.Oc),Ee.Vb(),Ee.Nc(13,vn,1,4,"app-plan",10),Ee.Tb()}if(2&e){var o=t.$implicit,a=Ee.Ec(12),i=Ee.hc();Ee.Cb(4),Ee.pc("ngClass",Ee.vc(8,yn,i.isOpenSubContent(o.vendorRoomTypeSeq),!i.isOpenSubContent(o.vendorRoomTypeSeq))),Ee.Cb(1),Ee.sc("title","",o.vendorRoomTypeSeq,"-",o.vendorRoomTypeNameEn,""),Ee.Cb(1),Ee.pc("ngStyle",Ee.uc(11,Pn,"D"===o.dataStatusCode?"line-through":"none")),Ee.Cb(1),Ee.Qc(o.vendorRoomTypeNameEn),Ee.Cb(3),Ee.pc("ngIf",o.roomAllotments&&o.roomAllotments.length>0)("ngIfElse",a),Ee.Cb(3),Ee.pc("ngIf",i.isOpenSubContent(o.vendorRoomTypeSeq))}}var gn,Dn=((gn=function(){function e(t,n){_classCallCheck(this,e),this.service=t,this.store=n,this.openPlanDetailEvent=new Ee.n,this.openRoomDetailEvent=new Ee.n,this.openPromotionDetailEvent=new Ee.n,this.openRateDetailEvent=new Ee.n,this.openCalendarDetailEvent=new Ee.n,this.unsubscribe$=new Se.a,this.trackByRoomData=function(e){return e.vendorRoomTypeSeq},this.trackByAllotment=function(e){return e.roomAllotmentSeq},this.trackByDate=function(e){return(null==e?void 0:e.appliedDate)?e.appliedDate.charAt(9)+e.appliedDate.charAt(8):null}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.searchCondition$=this.store.pipe(Object(l.u)(ce)),this.searchCondition$.pipe(Object(Oe.a)(this.unsubscribe$)).subscribe((function(t){e.condition=t,e.selectedHotelSimple=t&&{hotelCode:t.hotelCode,hotelNameEn:t.hotelNameEn},e.yearMonth=t&&t.yearMonth})),this.selectedCheckedDate$=this.store.pipe(Object(l.u)(pe)),this.selectedCheckedDate$.pipe(Object(Oe.a)(this.unsubscribe$)).subscribe((function(t){e.checkedDateInfo=t})),this.openRoomIdList=this.roomData.map((function(e){return e.vendorRoomTypeSeq}))}},{key:"ngOnChanges",value:function(e){var t,n;e.roomData&&(this.openRoomIdList=null!==(n=null===(t=this.roomData)||void 0===t?void 0:t.map((function(e){return e.vendorRoomTypeSeq})))&&void 0!==n?n:[])}},{key:"ngOnDestroy",value:function(){this.unsubscribe$.next(),this.unsubscribe$.complete()}},{key:"toggleSubContentHandler",value:function(e){if(this.openRoomIdList.find((function(t){return t===e})))this.openRoomIdList=this.openRoomIdList.filter((function(t){return t!==e}));else{var t=Te.cloneDeep(this.openRoomIdList);t.push(e),this.openRoomIdList=t}}},{key:"getFullDate",value:function(e){if(!e)return[];var t=this.yearMonth?this.yearMonth:xe()().format("YYYYMM");return Object(Je.b)(t).map((function(e){return e.yyyymmdd})).map((function(t){var n=e.find((function(e){return e.appliedDate===t}));return Object.assign({},n)}))}},{key:"isOpenSubContent",value:function(e){return this.openRoomIdList.find((function(t){return t===e}))}},{key:"changeCheckbox",value:function(e,t,n){this.store.dispatch(O({data:{checked:e.target.checked,hotelContractSeq:this.contractData.hotelContractSeq,date:t.appliedDate,roomId:n,planId:null,type:"room",params:{leftCountSum:t.leftCountSum,minNights:t.minNights,salesStopYn:t.salesStopYn,localAllotmentYn:this.contractData.localAllotmentYn}}}))}},{key:"calendarPopupHandler",value:function(e,t){this.openCalendarDetailEvent.emit({isPreview:!0,allotmentParameters:{vendorRoomTypeSeq:t.vendorRoomTypeSeq,vendorCompCode:this.contractData.vendorCompCode,hotelCode:Number(this.contractData.cmsPmsHotelCode),hotelContractNo:this.contractData.hotelContractNo,hotelContractTypeCode:this.contractData.hotelContractTypeCode,ownerCompCode:this.contractData.ownerCompCode,sellerCompCode:0}})}},{key:"roomPopupHandler",value:function(e,t){this.openRoomDetailEvent.emit(t)}},{key:"openPlanDetailPopupHandler",value:function(e){this.openPlanDetailEvent.emit(e)}},{key:"openPromotionDetailPopupHandler",value:function(e){this.openPromotionDetailEvent.emit(e)}},{key:"openRateDetailPopupHandler",value:function(){this.openRateDetailEvent.emit()}}]),e}()).\u0275fac=function(e){return new(e||gn)(Ee.Qb(Le.a),Ee.Qb(l.h))},gn.\u0275cmp=Ee.Kb({type:gn,selectors:[["app-room"]],inputs:{monthInfo:"monthInfo",roomData:"roomData",contractData:"contractData"},outputs:{openPlanDetailEvent:"openPlanDetailEvent",openRoomDetailEvent:"openRoomDetailEvent",openPromotionDetailEvent:"openPromotionDetailEvent",openRateDetailEvent:"openRateDetailEvent",openCalendarDetailEvent:"openCalendarDetailEvent"},features:[Ee.Ab],decls:1,vars:2,consts:[[4,"ngFor","ngForOf","ngForTrackBy"],[1,"roomtype-header"],["type","button",1,"btn-row-toggle"],[1,"fas",3,"ngClass","click"],["type","button",1,"btn-roomtype",3,"title","click"],[3,"ngStyle"],["type","button",1,"btn-roomtype-calendar",3,"click"],[1,"fas","fa-calendar-alt"],[4,"ngIf","ngIfElse"],["emptyDays",""],[3,"planData","vendorRoomTypeSeq","contractData","roomData","openPlanDetailEvent","openPromotionDetailEvent","openRateDetailEvent",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"selling","selling-stop",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[1,"checkbox","only"],["type","checkbox","value","room",1,"checkbox-control-input",3,"click"],[1,"checkbox-control-text"],[2,"text-align","center","line-height","22px",3,"ngClass"],["localAllotmentNo",""],[3,"planData","vendorRoomTypeSeq","contractData","roomData","openPlanDetailEvent","openPromotionDetailEvent","openRateDetailEvent"]],template:function(e,t){1&e&&Ee.Nc(0,Cn,14,13,"ng-container",0),2&e&&Ee.pc("ngForOf",t.roomData)("ngForTrackBy",t.trackByRoomData)},directives:[a.n,a.l,a.p,a.o,ln],styles:["","[_nghost-%COMP%] {\n        display: contents;\n      }"],changeDetection:0}),gn);function kn(e,t){1&e&&(Ee.Wb(0,"tbody"),Ee.Wb(1,"tr"),Ee.Wb(2,"td",2),Ee.Pc(3,"No records available."),Ee.Vb(),Ee.Vb(),Ee.Vb())}function Sn(e,t){if(1&e&&(Ee.Wb(0,"li"),Ee.Pc(1),Ee.Vb()),2&e){var n=Ee.hc().$implicit;Ee.Cb(1),Ee.Rc("Contract Status: ",n.contractStatusCode,"")}}function In(e,t){if(1&e&&(Ee.Wb(0,"li"),Ee.Pc(1),Ee.Vb()),2&e){var n=Ee.hc().$implicit;Ee.Cb(1),Ee.Rc("Comm Rate : ",n.vendorCommRate,"%")}}function On(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"li"),Ee.Wb(1,"button",10),Ee.fc("click",(function(){Ee.Fc(n);var e=Ee.hc().$implicit;return Ee.hc().openRateHandler(e)})),Ee.Pc(2," Rate "),Ee.Vb(),Ee.Vb()}}function Rn(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"li"),Ee.Wb(1,"button",10),Ee.fc("click",(function(){Ee.Fc(n);var e=Ee.hc().$implicit;return Ee.hc().openAllotmentHandler(e)})),Ee.Pc(2," Allotment "),Ee.Vb(),Ee.Vb()}}function Tn(e,t){if(1&e){var n=Ee.Xb();Ee.Ub(0),Ee.Wb(1,"app-room",11),Ee.fc("openPlanDetailEvent",(function(e){return Ee.Fc(n),Ee.hc(2).openPlanDetailPopupHandler(e)}))("openRoomDetailEvent",(function(e){return Ee.Fc(n),Ee.hc(2).openRoomDetailPopupHandler(e)}))("openPromotionDetailEvent",(function(e){return Ee.Fc(n),Ee.hc(2).openPromotionDetailPopupHandler(e)}))("openRateDetailEvent",(function(){Ee.Fc(n);var e=Ee.hc().$implicit;return Ee.hc().openRateDetailPopupHandler(e)}))("openCalendarDetailEvent",(function(e){return Ee.Fc(n),Ee.hc(2).openCalendarDetailPopupHandler(e)})),Ee.Vb(),Ee.Tb()}if(2&e){var o=Ee.hc().$implicit,a=Ee.hc();Ee.Cb(1),Ee.pc("roomData",o.vendorRoomTypes)("contractData",o)("monthInfo",a.monthInfo)}}var Vn=function(e,t){return{"fa-minus":e,"fa-plus":t}};function An(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"tbody"),Ee.Wb(1,"tr",3),Ee.Wb(2,"th"),Ee.Wb(3,"button",4),Ee.Wb(4,"i",5),Ee.fc("click",(function(){Ee.Fc(n);var e=t.$implicit;return Ee.hc().toggleSubContentHandler(e.hotelContractSeq)})),Ee.Vb(),Ee.Wb(5,"span",6),Ee.Pc(6),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Wb(7,"th"),Ee.Wb(8,"div",7),Ee.Wb(9,"ul",8),Ee.Nc(10,Sn,2,1,"li",0),Ee.Wb(11,"li"),Ee.Pc(12),Ee.Vb(),Ee.Wb(13,"li"),Ee.Pc(14),Ee.Vb(),Ee.Nc(15,In,2,1,"li",0),Ee.Wb(16,"li"),Ee.Pc(17),Ee.Vb(),Ee.Wb(18,"li"),Ee.Pc(19),Ee.Vb(),Ee.Vb(),Ee.Wb(20,"ul",9),Ee.Nc(21,On,3,0,"li",0),Ee.Nc(22,Rn,3,0,"li",0),Ee.Wb(23,"li"),Ee.Wb(24,"button",10),Ee.fc("click",(function(){Ee.Fc(n);var e=t.$implicit;return Ee.hc().openStopSalesHandler(e)})),Ee.Pc(25," Stop or Start Selling "),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Nc(26,Tn,2,3,"ng-container",0),Ee.Vb()}if(2&e){var o=t.$implicit,a=Ee.hc();Ee.Cb(4),Ee.pc("ngClass",Ee.vc(14,Vn,a.isOpenSubContent(o.hotelContractSeq),!a.isOpenSubContent(o.hotelContractSeq))),Ee.Cb(1),Ee.pc("title",o.hotelContractTypeName),Ee.Cb(1),Ee.Sc("",o.hotelContractTypeName," : ",o.hotelContractSeq," "),Ee.Cb(1),Ee.Db("colspan",a.monthInfo.length),Ee.Cb(3),Ee.pc("ngIf",o.contractStatusCode),Ee.Cb(2),Ee.Rc("Curr : ",o.currencyCode,""),Ee.Cb(2),Ee.Qc(o.netProvideYn?"NET":"Gross"),Ee.Cb(1),Ee.pc("ngIf",!o.netProvideYn),Ee.Cb(2),Ee.Rc(" Rate : ",o.localPriceYn?"Local":o.priceCmsPmsCompName," "),Ee.Cb(2),Ee.Rc(" Allotment : ",o.localAllotmentYn?"Local":o.allotmentCmsPmsCompName," "),Ee.Cb(2),Ee.pc("ngIf","HOC03"!=o.hotelContractTypeCode),Ee.Cb(1),Ee.pc("ngIf","HOC03"!=o.hotelContractTypeCode),Ee.Cb(4),Ee.pc("ngIf",a.isOpenSubContent(o.hotelContractSeq))}}var Nn,Fn=((Nn=function(){function e(t,n){_classCallCheck(this,e),this.store=t,this.rateDetailDataService=n,this.openPlanDetailEvent=new Ee.n,this.openRoomDetailEvent=new Ee.n,this.openRateDetailEvent=new Ee.n,this.openAllotmentDetailEvent=new Ee.n,this.openPromotionDetailEvent=new Ee.n,this.openStopSaleDetailEvent=new Ee.n,this.openCalendarDetailEvent=new Ee.n,this.unsubscribe$=new Se.a,this.isDetail=!1,this.trackByContractTypeItem=function(e){return e.hotelContractSeq}}return _createClass(e,[{key:"ngOnInit",value:function(){this.subscribeToSearchCondition()}},{key:"ngOnDestroy",value:function(){this.unsubscribe$.next(),this.unsubscribe$.complete()}},{key:"subscribeToSearchCondition",value:function(){var e=this;this.gridState$=this.store.pipe(Object(l.u)(le)),this.gridState$.pipe(Object(Oe.a)(this.unsubscribe$)).subscribe((function(t){e.openContractIdList=null==t?void 0:t.map((function(e){return e.hotelContractSeq}))})),this.searchCondition$=this.store.pipe(Object(l.u)(ce)),this.searchCondition$.pipe(Object(Oe.a)(this.unsubscribe$)).subscribe((function(t){e.selectedHotelSimple=t&&{hotelCode:t.hotelCode,hotelNameEn:t.hotelNameEn}}))}},{key:"toggleSubContentHandler",value:function(e){if(this.openContractIdList.find((function(t){return t===e})))this.openContractIdList=this.openContractIdList.filter((function(t){return t!==e}));else{var t=Te.cloneDeep(this.openContractIdList);t.push(e),this.openContractIdList=t}}},{key:"isOpenSubContent",value:function(e){return this.openContractIdList.find((function(t){return t===e}))}},{key:"openAllotmentHandler",value:function(e){this.openAllotmentDetailEvent.emit(e)}},{key:"openStopSalesHandler",value:function(e){this.openStopSaleDetailEvent.emit(e)}},{key:"openRateHandler",value:function(e){var t=this.rateDetailDataService.getPlanListByTypeData(e);this.openRateDetailEvent.emit(t)}},{key:"openPlanDetailPopupHandler",value:function(e){this.openPlanDetailEvent.emit(e)}},{key:"openRoomDetailPopupHandler",value:function(e){this.openRoomDetailEvent.emit(e)}},{key:"openPromotionDetailPopupHandler",value:function(e){this.openPromotionDetailEvent.emit(e)}},{key:"openRateDetailPopupHandler",value:function(e){var t=this.rateDetailDataService.getPlanListByTypeData(e);this.openRateDetailEvent.emit(t)}},{key:"openCalendarDetailPopupHandler",value:function(e){this.openCalendarDetailEvent.emit(e)}}]),e}()).\u0275fac=function(e){return new(e||Nn)(Ee.Qb(l.h),Ee.Qb(Ze))},Nn.\u0275cmp=Ee.Kb({type:Nn,selectors:[["app-collection"]],inputs:{monthInfo:"monthInfo"},outputs:{openPlanDetailEvent:"openPlanDetailEvent",openRoomDetailEvent:"openRoomDetailEvent",openRateDetailEvent:"openRateDetailEvent",openAllotmentDetailEvent:"openAllotmentDetailEvent",openPromotionDetailEvent:"openPromotionDetailEvent",openStopSaleDetailEvent:"openStopSaleDetailEvent",openCalendarDetailEvent:"openCalendarDetailEvent"},decls:4,vars:7,consts:[[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[2,"font-size","13px"],[1,"rate-header"],["type","button",1,"btn-rate-toggle"],[1,"fas",3,"ngClass","click"],[3,"title"],[1,"control-area"],[1,"ul-rate-detail"],[1,"ul-rate-control"],["type","button",1,"btn-rate-control",3,"click"],[3,"roomData","contractData","monthInfo","openPlanDetailEvent","openRoomDetailEvent","openPromotionDetailEvent","openRateDetailEvent","openCalendarDetailEvent"]],template:function(e,t){1&e&&(Ee.Nc(0,kn,4,0,"tbody",0),Ee.ic(1,"async"),Ee.Nc(2,An,27,17,"tbody",1),Ee.ic(3,"async")),2&e&&(Ee.pc("ngIf",!Ee.jc(1,3,t.gridState$)),Ee.Cb(2),Ee.pc("ngForOf",Ee.jc(3,5,t.gridState$))("ngForTrackBy",t.trackByContractTypeItem))},directives:[a.o,a.n,a.l,Dn],pipes:[a.b],styles:["","[_nghost-%COMP%] {\n        display: contents;\n      }"],changeDetection:0}),Nn),_n=["calendar"],En=["dateController"];function Ln(e,t){1&e&&Ee.Rb(0,"col",16)}function Wn(e,t){if(1&e&&(Ee.Wb(0,"option",17),Ee.Pc(1),Ee.Vb()),2&e){var n=t.$implicit;Ee.pc("ngValue",n.value),Ee.Cb(1),Ee.Rc(" ",n.label," ")}}function xn(e,t){if(1&e&&(Ee.Wb(0,"option",17),Ee.Pc(1),Ee.Vb()),2&e){var n=t.$implicit;Ee.pc("ngValue",n.value),Ee.Cb(1),Ee.Rc(" ",n.label," ")}}var jn=function(e){return{today:e}};function Yn(e,t){if(1&e&&(Ee.Wb(0,"th",18),Ee.Wb(1,"p",19),Ee.Pc(2),Ee.Vb(),Ee.Wb(3,"p",20),Ee.Pc(4),Ee.Vb(),Ee.Vb()),2&e){var n=t.$implicit,o=t.index;Ee.Eb("calendarItem "+n.day.toLowerCase()),Ee.qc("id",o+1),Ee.pc("ngClass",Ee.uc(6,jn,n.isToday)),Ee.Cb(2),Ee.Qc(n.day),Ee.Cb(2),Ee.Qc(n.date)}}xe.a.locale("en");var Mn,$n=((Mn=function(){function e(t){_classCallCheck(this,e),this.store=t,this.openPlanDetailEvent=new Ee.n,this.openRoomDetailEvent=new Ee.n,this.openRateDetailEvent=new Ee.n,this.openAllotmentDetailEvent=new Ee.n,this.openPromotionDetailEvent=new Ee.n,this.openStopSaleDetailEvent=new Ee.n,this.openCalendarDetailEvent=new Ee.n,this.unsubscribe$=new Se.a,this.yearsOptions=[],this.monthsOptions=[1,2,3,4,5,6,7,8,9,10,11,12].map((function(e){var t=Te.padStart(String(e),2,"0");return{label:t,value:t}})),this.searchCondition$=this.store.pipe(Object(l.u)(ce));for(var n=2023;n<=2032;n++)this.yearsOptions.push({label:String(n),value:String(n)})}return _createClass(e,[{key:"dateList",get:function(){var e=this.searchCondition.yearMonth;return Object(Je.b)(e)}},{key:"ngOnInit",value:function(){var e=this;setTimeout((function(){e.moveDateTo(xe()().date().toString())}),100),this.searchCondition$.pipe(Object(Oe.a)(this.unsubscribe$),Object(Re.a)((function(e){return!Te.isNil(e)}))).subscribe((function(t){var n,o;e.searchCondition=Te.cloneDeep(t),e.currentMonth=null!==(n=e.searchCondition.yearMonth.slice(4,6))&&void 0!==n?n:"",e.currentYear=null!==(o=e.searchCondition.yearMonth.slice(0,4))&&void 0!==o?o:""}))}},{key:"ngOnDestroy",value:function(){this.unsubscribe$.next(null),this.unsubscribe$.complete()}},{key:"openAllotmentDetailPopupHandler",value:function(e){this.openAllotmentDetailEvent.emit(e)}},{key:"openStopSaleDetailPopupHandler",value:function(e){this.openStopSaleDetailEvent.emit(e)}},{key:"openPlanDetailPopupHandler",value:function(e){this.openPlanDetailEvent.emit(e)}},{key:"openRoomDetailPopupHandler",value:function(e){this.openRoomDetailEvent.emit(e)}},{key:"openPromotionDetailPopupHandler",value:function(e){this.openPromotionDetailEvent.emit(e)}},{key:"openRateDetailPopupHandler",value:function(e){this.openRateDetailEvent.emit(e)}},{key:"openCalendarDetailPopupHandler",value:function(e){this.openCalendarDetailEvent.emit(e)}},{key:"prevMonth",value:function(){var e,t,n=xe()(String(this.searchCondition.yearMonth),"YYYYMM").subtract(1,"months").format("YYYYMM"),o=null!==(e=n.slice(4,6))&&void 0!==e?e:"",a=null!==(t=n.slice(0,4))&&void 0!==t?t:"",i=Te.first(this.yearsOptions);Number(a)<Number(i.value)||(this.currentYear!=a&&(this.currentYear=a,this.changeYear()),this.currentYear=a,this.currentMonth=o,this.searchCondition.yearMonth="".concat(a).concat(o),this.changeMonth())}},{key:"nextMonth",value:function(){var e,t,n=xe()(String(this.searchCondition.yearMonth),"YYYYMM").add(1,"months").format("YYYYMM"),o=null!==(e=n.slice(4,6))&&void 0!==e?e:"",a=null!==(t=n.slice(0,4))&&void 0!==t?t:"",i=Te.last(this.yearsOptions);Number(a)>Number(i.value)||(this.currentYear!=a&&(this.currentYear=a,this.changeYear()),this.currentYear=a,this.currentMonth=o,this.searchCondition.yearMonth="".concat(a).concat(o),this.changeMonth())}},{key:"changeYear",value:function(){this.store.dispatch(N({year:this.currentYear}))}},{key:"changeMonth",value:function(){this.store.dispatch(F({month:this.currentMonth}))}},{key:"moveDateTo",value:function(e){var t=document.getElementById(e);t&&this.calendar.nativeElement.scrollTo({behavior:"smooth",left:t.offsetLeft-this.dateController.nativeElement.offsetWidth})}}]),e}()).\u0275fac=function(e){return new(e||Mn)(Ee.Qb(l.h))},Mn.\u0275cmp=Ee.Kb({type:Mn,selectors:[["app-calendar"]],viewQuery:function(e,t){var n;1&e&&(Ee.Xc(_n,!0),Ee.Xc(En,!0)),2&e&&(Ee.Dc(n=Ee.gc())&&(t.calendar=n.first),Ee.Dc(n=Ee.gc())&&(t.dateController=n.first))},outputs:{openPlanDetailEvent:"openPlanDetailEvent",openRoomDetailEvent:"openRoomDetailEvent",openRateDetailEvent:"openRateDetailEvent",openAllotmentDetailEvent:"openAllotmentDetailEvent",openPromotionDetailEvent:"openPromotionDetailEvent",openStopSaleDetailEvent:"openStopSaleDetailEvent",openCalendarDetailEvent:"openCalendarDetailEvent"},decls:25,vars:7,consts:[[1,"rate-allotment"],["calendar",""],[2,"z-index","1"],["width","400px"],["width","90px",4,"ngFor","ngForOf"],["dateController",""],[1,"cal-wrap"],[1,"btn-cal-prev",3,"click"],["src","../../assets/images/common/ico-tabs-prev.png","alt","\uc774\uc804"],[1,"select-box"],[3,"ngModel","ngModelChange","change"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"btn-cal-next",3,"click"],["src","../../assets/images/common/ico-tabs-next.png","alt","\ub2e4\uc74c"],[3,"ngClass","class","id",4,"ngFor","ngForOf"],[3,"monthInfo","openPlanDetailEvent","openRoomDetailEvent","openRateDetailEvent","openAllotmentDetailEvent","openStopSaleDetailEvent","openPromotionDetailEvent","openCalendarDetailEvent"],["width","90px"],[3,"ngValue"],[3,"ngClass","id"],[1,"week-day"],[1,"day"]],template:function(e,t){1&e&&(Ee.Wb(0,"div",0,1),Ee.Wb(2,"table",2),Ee.Wb(3,"caption"),Ee.Pc(4," Rate Allotment Detail "),Ee.Vb(),Ee.Wb(5,"colgroup"),Ee.Rb(6,"col",3),Ee.Nc(7,Ln,1,0,"col",4),Ee.Vb(),Ee.Wb(8,"thead"),Ee.Wb(9,"tr"),Ee.Wb(10,"th",null,5),Ee.Wb(12,"div",6),Ee.Wb(13,"a",7),Ee.fc("click",(function(){return t.prevMonth()})),Ee.Rb(14,"img",8),Ee.Vb(),Ee.Wb(15,"div",9),Ee.Wb(16,"select",10),Ee.fc("ngModelChange",(function(e){return t.currentYear=e}))("change",(function(){return t.changeYear()})),Ee.Nc(17,Wn,2,2,"option",11),Ee.Vb(),Ee.Vb(),Ee.Wb(18,"div",9),Ee.Wb(19,"select",10),Ee.fc("ngModelChange",(function(e){return t.currentMonth=e}))("change",(function(){return t.changeMonth()})),Ee.Nc(20,xn,2,2,"option",11),Ee.Vb(),Ee.Vb(),Ee.Wb(21,"a",12),Ee.fc("click",(function(){return t.nextMonth()})),Ee.Rb(22,"img",13),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Nc(23,Yn,5,8,"th",14),Ee.Vb(),Ee.Vb(),Ee.Wb(24,"app-collection",15),Ee.fc("openPlanDetailEvent",(function(e){return t.openPlanDetailPopupHandler(e)}))("openRoomDetailEvent",(function(e){return t.openRoomDetailPopupHandler(e)}))("openRateDetailEvent",(function(e){return t.openRateDetailPopupHandler(e)}))("openAllotmentDetailEvent",(function(e){return t.openAllotmentDetailPopupHandler(e)}))("openStopSaleDetailEvent",(function(e){return t.openStopSaleDetailPopupHandler(e)}))("openPromotionDetailEvent",(function(e){return t.openPromotionDetailPopupHandler(e)}))("openCalendarDetailEvent",(function(e){return t.openCalendarDetailPopupHandler(e)})),Ee.Vb(),Ee.Vb(),Ee.Vb()),2&e&&(Ee.Cb(7),Ee.pc("ngForOf",t.dateList),Ee.Cb(9),Ee.pc("ngModel",t.currentYear),Ee.Cb(1),Ee.pc("ngForOf",t.yearsOptions),Ee.Cb(2),Ee.pc("ngModel",t.currentMonth),Ee.Cb(1),Ee.pc("ngForOf",t.monthsOptions),Ee.Cb(3),Ee.pc("ngForOf",t.dateList),Ee.Cb(1),Ee.pc("monthInfo",t.dateList))},directives:[a.n,i.y,i.r,i.u,Fn,i.v,i.A,a.l],styles:[".calendarWrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between}.calendarWrapper[_ngcontent-%COMP%]   .selectContainer[_ngcontent-%COMP%]{display:flex;width:100%;gap:8px;padding-left:300px}.calendarWrapper[_ngcontent-%COMP%]   .selectContainer[_ngcontent-%COMP%]   app-selectbox[_ngcontent-%COMP%]{max-width:200px}.calendarWrapper[_ngcontent-%COMP%]   .selectContainer[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:26px;height:26px;background-color:#fff;border:1px solid #d7d7d7;display:flex;align-items:center;justify-content:center}.calendarWrapper[_ngcontent-%COMP%]   .calendarContainer[_ngcontent-%COMP%]{display:flex;margin-top:12px}.calendarWrapper[_ngcontent-%COMP%]   .calendarContainer[_ngcontent-%COMP%]   .calendarItem[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;gap:4px;max-width:100px;min-width:100px}.calendarWrapper[_ngcontent-%COMP%]   .calendarContainer[_ngcontent-%COMP%]   .calendarItem.sat[_ngcontent-%COMP%]{color:#00f}.calendarWrapper[_ngcontent-%COMP%]   .calendarContainer[_ngcontent-%COMP%]   .calendarItem.sun[_ngcontent-%COMP%]{color:red}.calendarWrapper[_ngcontent-%COMP%]   .calendarContainer[_ngcontent-%COMP%]   .calendarItem.today[_ngcontent-%COMP%]{border:1px solid #888}"],changeDetection:0}),Mn),qn=n("kDLv"),wn=n("bKIL"),Hn=n("RtN6");n("AytR");var Un={ROOM:0,PROMOTION:1},Gn={CONTRACT:"CTR",GROSS:"GRS",NET:"NET"},Bn=n("/uUt"),Xn=function(){var e=function(){function e(t){var n=this;_classCallCheck(this,e),this.fb=t,this.generateRatePutForm=function(){return n.fb.group({hotelCode:[null,[i.z.required]],ratePeriod:n.fb.group({periods:n.fb.array([]),includeDates:[],excludeDates:[]}),roomTypePlans:null})},this.generateSubmitPlanFormGroup=function(){return n.fb.group({roomPlanFormListFormArray:n.fb.array([]),promotionPlanFormListFormArray:n.fb.array([])})},this.generateRatePlanNetGroup=function(e,t){var o=n.fb.group({vendorRoomTypeSeq:[null,[i.z.required]],vendorRoomPlanSeq:[null,[i.z.required]],currencyCode:[null],adultCount:[0,[i.z.required]],vendorNetAmount:[null,[i.z.required]],vendorTaxAmount:[{value:0,disabled:!e},[i.z.required]],vendorGrossAmount:[{value:null,disabled:!0}],vendorMspAmount:null,vendorContractAmount:null,roomPlanNameEn:null,promotionPlanNameEn:null,vendorRoomTypeNameEn:null,vendorSellingNetRate:null,vendorSellingNetAmount:null,salesStopYn:[!1,[i.z.required]]});if(t){var a=o.controls.vendorContractAmount;a.setValidators([i.z.required]),a.updateValueAndValidity()}return o},this.generateRatePlanGrossGroup=function(e,t){var o=n.fb.group({vendorRoomTypeSeq:[null,[i.z.required]],vendorRoomPlanSeq:[null,[i.z.required]],currencyCode:[null],adultCount:[0,[i.z.required]],vendorNetAmount:[{value:null,disabled:!0},[i.z.required]],vendorTaxAmount:[{value:0,disabled:!e},[i.z.required]],vendorGrossAmount:null,vendorMspAmount:[{value:null,disabled:!0}],vendorContractAmount:null,roomPlanNameEn:null,promotionPlanNameEn:null,vendorRoomTypeNameEn:null,vendorSellingNetRate:null,vendorSellingNetAmount:null,salesStopYn:[!1,[i.z.required]]});if(t){var a=o.controls.vendorContractAmount;a.setValidators([i.z.required]),a.updateValueAndValidity()}return o},this.initRoomTypePlanKeysDefaultData=function(){return{vendorRoomTypeSeq:null,vendorRoomPlanSeq:null,adultCount:null,vendorNetAmount:null,vendorSellingNetAmount:null,vendorTaxAmount:null,vendorGrossAmount:null,vendorMspAmount:null,vendorContractAmount:null,salesStopYn:null}},this.generatePeriodGroups=function(){return n.fb.group({appliedFromDate:[null],appliedToDate:[null],appliedMonYn:[!0],appliedTueYn:[!0],appliedWedYn:[!0],appliedThuYn:[!0],appliedFriYn:[!0],appliedSatYn:[!0],appliedSunYn:[!0]},{validators:n.compareDatesValidators("dateRangeCompare",["appliedFromDate","appliedToDate"])})},this.setPeriodGroups=function(e){return n.fb.group(e)}}return _createClass(e,[{key:"compareDatesValidators",value:function(e,t){return function(n){if(!n)return null;var o=n,a=t.length,i=t.map((function(e){return o.get(e).value})),r=!1;return i.forEach((function(e,t){if(!r&&t+1<a){var n=i[t+1];r=Te.isNil(e)||Te.isNil(n)?!Te.isNil(e)||!Te.isNil(n):xe()(n).isBefore(xe()(e))}})),r?_defineProperty({},e,!0):null}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ee.bc(i.f))},e.\u0275prov=Ee.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),zn=n("gbCm");function Qn(e,t){if(1&e&&(Ee.Ub(0),Ee.Wb(1,"dl"),Ee.Wb(2,"dt"),Ee.Pc(3,"Rate(%)"),Ee.Vb(),Ee.Wb(4,"dd"),Ee.Rb(5,"app-input-text",18),Ee.Vb(),Ee.Vb(),Ee.Wb(6,"dl"),Ee.Wb(7,"dt"),Ee.Pc(8,"V.Selling Net"),Ee.Vb(),Ee.Wb(9,"dd"),Ee.Rb(10,"app-input-text",19),Ee.Vb(),Ee.Vb(),Ee.Tb()),2&e){var n=Ee.hc().index,o=Ee.hc();Ee.Cb(5),Ee.pc("isInvalid",o.checkIsRoomPlanListInvalid(n,"vendorSellingNetRate")),Ee.Cb(5),Ee.pc("inputFormat","currency")("isInvalid",o.checkIsRoomPlanListInvalid(n,"vendorSellingNetAmount"))}}function Kn(e,t){1&e&&(Ee.Ub(0),Ee.Wb(1,"sup"),Ee.Pc(2,"Contract"),Ee.Vb(),Ee.Tb())}function Jn(e,t){1&e&&(Ee.Ub(0),Ee.Pc(1," Contract "),Ee.Tb())}function Zn(e,t){if(1&e&&(Ee.Wb(0,"div",8),Ee.Ub(1,9),Ee.Wb(2,"div",10),Ee.Pc(3),Ee.Vb(),Ee.Wb(4,"div",11),Ee.Wb(5,"dl"),Ee.Wb(6,"dt"),Ee.Wb(7,"sup"),Ee.Pc(8,"Net"),Ee.Vb(),Ee.Vb(),Ee.Wb(9,"dd"),Ee.Rb(10,"app-input-text",12),Ee.Vb(),Ee.Vb(),Ee.Nc(11,Qn,11,3,"ng-container",13),Ee.Wb(12,"dl"),Ee.Wb(13,"dt"),Ee.Wb(14,"sup"),Ee.Pc(15,"Extra Tax"),Ee.Vb(),Ee.Vb(),Ee.Wb(16,"dd"),Ee.Rb(17,"app-input-text",14),Ee.Vb(),Ee.Vb(),Ee.Wb(18,"dl"),Ee.Wb(19,"dt"),Ee.Pc(20,"Gross"),Ee.Vb(),Ee.Wb(21,"dd"),Ee.Rb(22,"app-input-text",15),Ee.Vb(),Ee.Vb(),Ee.Wb(23,"dl"),Ee.Wb(24,"dt"),Ee.Pc(25,"MSP"),Ee.Vb(),Ee.Wb(26,"dd"),Ee.Rb(27,"app-input-text",16),Ee.Vb(),Ee.Vb(),Ee.Wb(28,"dl"),Ee.Wb(29,"dt"),Ee.Nc(30,Kn,3,0,"ng-container",13),Ee.Nc(31,Jn,2,0,"ng-container",13),Ee.Vb(),Ee.Wb(32,"dd"),Ee.Rb(33,"app-input-text",17),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Tb(),Ee.Vb()),2&e){var n=t.$implicit,o=t.index,a=Ee.hc();Ee.Cb(1),Ee.qc("formGroupName",o),Ee.Cb(2),Ee.Qc(n.value.roomPlanNameEn),Ee.Cb(7),Ee.pc("inputFormat","currency")("isInvalid",a.checkIsRoomPlanListInvalid(o,"vendorNetAmount")),Ee.Cb(1),Ee.pc("ngIf",a.isExclusiveRate),Ee.Cb(6),Ee.pc("inputFormat","currency")("isInvalid",a.checkIsRoomPlanListInvalid(o,"vendorTaxAmount")),Ee.Cb(5),Ee.pc("inputFormat","currency")("isInvalid",a.checkIsRoomPlanListInvalid(o,"vendorGrossAmount")),Ee.Cb(5),Ee.pc("inputFormat","currency")("isInvalid",a.checkIsRoomPlanListInvalid(o,"vendorMspAmount")),Ee.Cb(3),Ee.pc("ngIf",a.isSendAmountTypeCodeRequired),Ee.Cb(1),Ee.pc("ngIf",!a.isSendAmountTypeCodeRequired),Ee.Cb(2),Ee.pc("inputFormat","currency")("isInvalid",a.checkIsRoomPlanListInvalid(o,"vendorContractAmount"))}}function eo(e,t){if(1&e&&(Ee.Ub(0),Ee.Wb(1,"dl"),Ee.Wb(2,"dt"),Ee.Pc(3,"Rate(%)"),Ee.Vb(),Ee.Wb(4,"dd"),Ee.Rb(5,"app-input-text",18),Ee.Vb(),Ee.Vb(),Ee.Wb(6,"dl"),Ee.Wb(7,"dt"),Ee.Pc(8,"V.Selling Net"),Ee.Vb(),Ee.Wb(9,"dd"),Ee.Rb(10,"app-input-text",19),Ee.Vb(),Ee.Vb(),Ee.Tb()),2&e){var n=Ee.hc().index,o=Ee.hc();Ee.Cb(5),Ee.pc("isInvalid",o.checkIsPromotionPlanListInvalid(n,"vendorSellingNetRate")),Ee.Cb(5),Ee.pc("inputFormat","currency")("isInvalid",o.checkIsPromotionPlanListInvalid(n,"vendorSellingNetAmount"))}}function to(e,t){1&e&&(Ee.Ub(0),Ee.Wb(1,"sup"),Ee.Pc(2,"Contract"),Ee.Vb(),Ee.Tb())}function no(e,t){1&e&&(Ee.Ub(0),Ee.Pc(1," Contract "),Ee.Tb())}function oo(e,t){if(1&e&&(Ee.Wb(0,"div",8),Ee.Ub(1,9),Ee.Rb(2,"div",20),Ee.Wb(3,"div",11),Ee.Wb(4,"dl"),Ee.Wb(5,"dt"),Ee.Wb(6,"sup"),Ee.Pc(7,"Net"),Ee.Vb(),Ee.Vb(),Ee.Wb(8,"dd"),Ee.Rb(9,"app-input-text",12),Ee.Vb(),Ee.Vb(),Ee.Nc(10,eo,11,3,"ng-container",13),Ee.Wb(11,"dl"),Ee.Wb(12,"dt"),Ee.Wb(13,"sup"),Ee.Pc(14,"Extra Tax"),Ee.Vb(),Ee.Vb(),Ee.Wb(15,"dd"),Ee.Rb(16,"app-input-text",14),Ee.Vb(),Ee.Vb(),Ee.Wb(17,"dl"),Ee.Wb(18,"dt"),Ee.Pc(19,"Gross"),Ee.Vb(),Ee.Wb(20,"dd"),Ee.Rb(21,"app-input-text",15),Ee.Vb(),Ee.Vb(),Ee.Wb(22,"dl"),Ee.Wb(23,"dt"),Ee.Pc(24,"MSP"),Ee.Vb(),Ee.Wb(25,"dd"),Ee.Rb(26,"app-input-text",16),Ee.Vb(),Ee.Vb(),Ee.Wb(27,"dl"),Ee.Wb(28,"dt"),Ee.Nc(29,to,3,0,"ng-container",13),Ee.Nc(30,no,2,0,"ng-container",13),Ee.Vb(),Ee.Wb(31,"dd"),Ee.Rb(32,"app-input-text",17),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Tb(),Ee.Vb()),2&e){var n=t.$implicit,o=t.index,a=Ee.hc();Ee.Cb(1),Ee.qc("formGroupName",o),Ee.Cb(1),Ee.pc("innerHTML",a.convertPromotionTitleToHtml(n.value.promotionPlanNameEn),Ee.Gc),Ee.Cb(7),Ee.pc("inputFormat","currency")("isInvalid",a.checkIsPromotionPlanListInvalid(o,"vendorNetAmount")),Ee.Cb(1),Ee.pc("ngIf",a.isExclusiveRate),Ee.Cb(6),Ee.pc("inputFormat","currency")("isInvalid",a.checkIsPromotionPlanListInvalid(o,"vendorTaxAmount")),Ee.Cb(5),Ee.pc("inputFormat","currency")("isInvalid",a.checkIsPromotionPlanListInvalid(o,"vendorGrossAmount")),Ee.Cb(5),Ee.pc("inputFormat","currency")("isInvalid",a.checkIsPromotionPlanListInvalid(o,"vendorMspAmount")),Ee.Cb(3),Ee.pc("ngIf",a.isSendAmountTypeCodeRequired),Ee.Cb(1),Ee.pc("ngIf",!a.isSendAmountTypeCodeRequired),Ee.Cb(2),Ee.pc("inputFormat","currency")("isInvalid",a.checkIsPromotionPlanListInvalid(o,"vendorContractAmount"))}}function ao(e,t){1&e&&(Ee.Wb(0,"p",21),Ee.Pc(1," No selected item.\n"),Ee.Vb())}var io,ro=((io=function(){function e(t,n){_classCallCheck(this,e),this._dataService=t,this._formService=n,this.isUpdateModal=!1,this.isSendAmountTypeCodeRequired=!1,this._PLAN_TYPE=Un,this._BOOKING_SEND_AMOUNT_TYPE_CODE=Gn,this._checkValid=!1,this._destroy$=new Se.a,this.submitForm=this._dataService.generateSubmitPlanFormGroup()}return _createClass(e,[{key:"checkedRoomPlanList",get:function(){return this._checkedRoomPlanList},set:function(e){var t;this._checkedRoomPlanList=e,this._destroyByCheckedRoomPlanList$&&(this._destroyByCheckedRoomPlanList$.next(),this._destroyByCheckedRoomPlanList$.complete()),this._destroyByCheckedRoomPlanList$=new Se.a,this.roomPlanFormListFormArray.clear();var n,o=_createForOfIteratorHelper(this._checkedRoomPlanList);try{for(o.s();!(n=o.n()).done;){var a=n.value,i=a.sendAmountTypeCode===this._BOOKING_SEND_AMOUNT_TYPE_CODE.CONTRACT;this.isSendAmountTypeCodeRequired=i;var r=this._dataService.generateRatePlanNetGroup(null===(t=this.hotelContractInfo)||void 0===t?void 0:t.extraTaxPaymentYn,i);if(r.patchValue(a),this.isUpdateModal){var l=this._getVendorSellingNetRate(this.hotelContractInfo);r.patchValue(this.hotelContractInfo),r.patchValue({vendorSellingNetRate:l})}this._addSubscribeRoomPlanFormGroup(r),this.roomPlanFormListFormArray.push(r)}}catch(c){o.e(c)}finally{o.f()}}},{key:"checkedPromotionPlanList",get:function(){return this._checkedPromotionPlanList},set:function(e){var t;this._checkedPromotionPlanList=e,this._destroyByCheckedPromotionPlanList$&&(this._destroyByCheckedPromotionPlanList$.next(),this._destroyByCheckedPromotionPlanList$.complete()),this._destroyByCheckedPromotionPlanList$=new Se.a,this.promotionPlanFormListFormArray.clear();var n,o=_createForOfIteratorHelper(this._checkedPromotionPlanList);try{for(o.s();!(n=o.n()).done;){var a=n.value,i=a.sendAmountTypeCode===this._BOOKING_SEND_AMOUNT_TYPE_CODE.CONTRACT;this.isSendAmountTypeCodeRequired=i;var r=this._dataService.generateRatePlanNetGroup(null===(t=this.hotelContractInfo)||void 0===t?void 0:t.extraTaxPaymentYn,i);if(r.patchValue(a),this.isUpdateModal){var l=this._getVendorSellingNetRate(this.hotelContractInfo);r.patchValue(this.hotelContractInfo),r.patchValue({vendorSellingNetRate:l})}this._addSubscribePromotionPlanFormGroup(r),this.promotionPlanFormListFormArray.push(r)}}catch(c){o.e(c)}finally{o.f()}}},{key:"roomPlanFormListFormArray",get:function(){return this.submitForm.controls.roomPlanFormListFormArray}},{key:"promotionPlanFormListFormArray",get:function(){return this.submitForm.controls.promotionPlanFormListFormArray}},{key:"isExclusiveRate",get:function(){var e,t;return!("HOC01"!==(null===(e=this.checkedRoomPlanList[0])||void 0===e?void 0:e.hotelContractTypeCode)&&"HOC01"!==(null===(t=this.checkedPromotionPlanList[0])||void 0===t?void 0:t.hotelContractTypeCode))}},{key:"isNoItem",get:function(){return Te.isEmpty(this.checkedRoomPlanList)&&Te.isEmpty(this.checkedPromotionPlanList)}},{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this._destroyByCheckedRoomPlanList$&&(this._destroyByCheckedRoomPlanList$.next(),this._destroyByCheckedRoomPlanList$.complete()),this._destroyByCheckedPromotionPlanList$&&(this._destroyByCheckedPromotionPlanList$.next(),this._destroyByCheckedPromotionPlanList$.complete()),this._destroy$.next(),this._destroy$.complete()}},{key:"checkIsRoomPlanListInvalid",value:function(e,t){return this._checkValid&&this.roomPlanFormListFormArray.at(e).get(t)&&this.roomPlanFormListFormArray.at(e).get(t).invalid}},{key:"checkIsPromotionPlanListInvalid",value:function(e,t){return this._checkValid&&this.promotionPlanFormListFormArray.at(e).get(t)&&this.promotionPlanFormListFormArray.at(e).get(t).invalid}},{key:"convertPromotionTitleToHtml",value:function(e){var t=e.split(":"),n=t.length,o=t.reduce((function(e,t,o){return o+1>=n?e:e+=t}),""),a=t[n-1];return'<span class="font-weight-bold">'.concat(o.trim(),"</span><br /><span>").concat(a.trim(),"</span>")}},{key:"makeSubmitFormData",value:function(){if(this.submitForm.invalid)return this._checkValid=!0,this.roomPlanFormListFormArray.controls.forEach((function(e){Object.keys(e.controls).forEach((function(t){e.controls[t].invalid&&console.error(t+" is invalid")}))})),void this.promotionPlanFormListFormArray.controls.forEach((function(e){Object.keys(e.controls).forEach((function(t){e.controls[t].invalid&&console.error(t+" is invalid")}))}));var e=this._dataService.initRoomTypePlanKeysDefaultData(),t=this._formService.fitFormArrayDataToDefaultData(this.roomPlanFormListFormArray.getRawValue(),e),n=this._formService.fitFormArrayDataToDefaultData(this.promotionPlanFormListFormArray.getRawValue(),e),o=[].concat(t,n);return this._checkValid=!1,o}},{key:"_addSubscribeRoomPlanFormGroup",value:function(e){var t=e.get("vendorSellingNetAmount");e.get("vendorSellingNetRate").valueChanges.pipe(Object(Oe.a)(this._destroy$),Object(Oe.a)(this._destroyByCheckedRoomPlanList$),Object(Bn.a)()).subscribe((function(n){var o=e.get("vendorNetAmount").value;t.patchValue(o*(1+.01*n))}))}},{key:"_addSubscribePromotionPlanFormGroup",value:function(e){var t=e.get("vendorSellingNetAmount");e.get("vendorSellingNetRate").valueChanges.pipe(Object(Oe.a)(this._destroy$),Object(Oe.a)(this._destroyByCheckedPromotionPlanList$),Object(Bn.a)()).subscribe((function(n){var o=e.get("vendorNetAmount").value;t.patchValue(o*(1+.01*n))}))}},{key:"_getVendorSellingNetRate",value:function(e){return Te.round(100*(e.vendorSellingNetAmount-e.vendorNetAmount)/e.vendorNetAmount,2)||null}}]),e}()).\u0275fac=function(e){return new(e||io)(Ee.Qb(Xn),Ee.Qb(Ye.a))},io.\u0275cmp=Ee.Kb({type:io,selectors:[["app-rate-detail-selected-rate-plan-net"]],inputs:{isUpdateModal:"isUpdateModal",hotelContractInfo:"hotelContractInfo",checkedDateInfo:"checkedDateInfo",checkedRoomPlanList:"checkedRoomPlanList",checkedPromotionPlanList:"checkedPromotionPlanList"},decls:19,vars:6,consts:[[1,"page-item-header"],[1,"promotion-rate-summary"],[1,"align-r","font-size-sm","color-dark-color4","mb5"],[3,"formGroup"],["formArrayName","roomPlanFormListFormArray"],["class","input-contents-item",4,"ngFor","ngForOf"],["formArrayName","promotionPlanFormListFormArray"],["style","text-align: center; font-size: 13px",4,"ngIf"],[1,"input-contents-item"],[3,"formGroupName"],[1,"title"],[1,"input-contents-area"],["formControlName","vendorNetAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],[4,"ngIf"],["formControlName","vendorTaxAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],["formControlName","vendorGrossAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],["formControlName","vendorMspAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],["formControlName","vendorContractAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],["formControlName","vendorSellingNetRate","valueType","number","placeholder","0.00",3,"isInvalid"],["formControlName","vendorSellingNetAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],[1,"title",3,"innerHTML"],[2,"text-align","center","font-size","13px"]],template:function(e,t){1&e&&(Ee.Wb(0,"div",0),Ee.Wb(1,"strong"),Ee.Wb(2,"sup"),Ee.Pc(3,"Select Room Plan or Promotion Rate Plan"),Ee.Vb(),Ee.Vb(),Ee.Wb(4,"ul",1),Ee.Wb(5,"li"),Ee.Pc(6),Ee.Vb(),Ee.Wb(7,"li"),Ee.Pc(8,"NET"),Ee.Vb(),Ee.Wb(9,"li"),Ee.Pc(10),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Wb(11,"p",2),Ee.Pc(12,'The extra tax field can use in case of "Extra Tax Payment : Y " only'),Ee.Vb(),Ee.Ub(13,3),Ee.Ub(14,4),Ee.Nc(15,Zn,34,15,"div",5),Ee.Tb(),Ee.Ub(16,6),Ee.Nc(17,oo,33,15,"div",5),Ee.Tb(),Ee.Tb(),Ee.Nc(18,ao,2,0,"p",7)),2&e&&(Ee.Cb(6),Ee.Rc("Curr : ",null==t.hotelContractInfo?null:t.hotelContractInfo.currencyCode,""),Ee.Cb(4),Ee.Rc("Extra Tax Payment : ",null!=t.hotelContractInfo&&t.hotelContractInfo.extraTaxPaymentYn?"Y":"N",""),Ee.Cb(3),Ee.pc("formGroup",t.submitForm),Ee.Cb(2),Ee.pc("ngForOf",null==t.roomPlanFormListFormArray?null:t.roomPlanFormListFormArray.controls),Ee.Cb(2),Ee.pc("ngForOf",null==t.promotionPlanFormListFormArray?null:t.promotionPlanFormListFormArray.controls),Ee.Cb(1),Ee.pc("ngIf",t.isNoItem))},directives:[i.s,i.k,i.e,a.n,a.o,i.l,zn.a,i.r,i.i],styles:['.page-item-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.ul-rate-detail[_ngcontent-%COMP%]{display:flex;color:#ff682c;font-size:12px}.ul-rate-detail[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:not(:last-child):after{content:"|";color:#262626;margin:0 12px}.title[_ngcontent-%COMP%]{white-space:break-spaces}textarea[_ngcontent-%COMP%]:-moz-read-only{background-color:#f5f5f5}textarea[_ngcontent-%COMP%]:read-only{background-color:#f5f5f5}']}),io);function lo(e,t){if(1&e&&(Ee.Ub(0),Ee.Wb(1,"dl"),Ee.Wb(2,"dt"),Ee.Pc(3,"Rate(%)"),Ee.Vb(),Ee.Wb(4,"dd"),Ee.Rb(5,"app-input-text",18),Ee.Vb(),Ee.Vb(),Ee.Wb(6,"dl"),Ee.Wb(7,"dt"),Ee.Pc(8,"V.Selling Net"),Ee.Vb(),Ee.Wb(9,"dd"),Ee.Rb(10,"app-input-text",19),Ee.Vb(),Ee.Vb(),Ee.Tb()),2&e){var n=Ee.hc().index,o=Ee.hc();Ee.Cb(5),Ee.pc("isInvalid",o.checkIsRoomPlanListInvalid(n,"vendorSellingNetRate")),Ee.Cb(5),Ee.pc("inputFormat","currency")("isInvalid",o.checkIsRoomPlanListInvalid(n,"vendorSellingNetAmount"))}}function co(e,t){1&e&&(Ee.Ub(0),Ee.Wb(1,"sup"),Ee.Pc(2,"Contract"),Ee.Vb(),Ee.Tb())}function so(e,t){1&e&&(Ee.Ub(0),Ee.Pc(1," Contract "),Ee.Tb())}function uo(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"div",8),Ee.Ub(1,9),Ee.Wb(2,"div",10),Ee.Pc(3),Ee.Vb(),Ee.Wb(4,"div",11),Ee.Wb(5,"dl"),Ee.Wb(6,"dt"),Ee.Wb(7,"sup"),Ee.Pc(8,"Net"),Ee.Vb(),Ee.Vb(),Ee.Wb(9,"dd"),Ee.Rb(10,"app-input-text",12),Ee.Vb(),Ee.Vb(),Ee.Nc(11,lo,11,3,"ng-container",13),Ee.Wb(12,"dl"),Ee.Wb(13,"dt"),Ee.Wb(14,"sup"),Ee.Pc(15,"Extra Tax"),Ee.Vb(),Ee.Vb(),Ee.Wb(16,"dd"),Ee.Rb(17,"app-input-text",14),Ee.Vb(),Ee.Vb(),Ee.Wb(18,"dl"),Ee.Wb(19,"dt"),Ee.Pc(20,"Gross"),Ee.Vb(),Ee.Wb(21,"dd"),Ee.Wb(22,"app-input-text",15),Ee.fc("input",(function(e){Ee.Fc(n);var o=t.index,a=Ee.hc();return a.calculateVendorNetAmountByGross(e.target.value,a._PLAN_TYPE.ROOM,o)})),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Wb(23,"dl"),Ee.Wb(24,"dt"),Ee.Pc(25,"MSP"),Ee.Vb(),Ee.Wb(26,"dd"),Ee.Rb(27,"app-input-text",16),Ee.Vb(),Ee.Vb(),Ee.Wb(28,"dl"),Ee.Wb(29,"dt"),Ee.Nc(30,co,3,0,"ng-container",13),Ee.Nc(31,so,2,0,"ng-container",13),Ee.Vb(),Ee.Wb(32,"dd"),Ee.Rb(33,"app-input-text",17),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Tb(),Ee.Vb()}if(2&e){var o=t.$implicit,a=t.index,i=Ee.hc();Ee.Cb(1),Ee.qc("formGroupName",a),Ee.Cb(2),Ee.Qc(o.value.roomPlanNameEn),Ee.Cb(7),Ee.pc("inputFormat","currency")("isInvalid",i.checkIsRoomPlanListInvalid(a,"vendorNetAmount")),Ee.Cb(1),Ee.pc("ngIf",i.isExclusiveRate),Ee.Cb(6),Ee.pc("inputFormat","currency")("isInvalid",i.checkIsRoomPlanListInvalid(a,"vendorTaxAmount")),Ee.Cb(5),Ee.pc("inputFormat","currency")("isInvalid",i.checkIsRoomPlanListInvalid(a,"vendorGrossAmount")),Ee.Cb(5),Ee.pc("inputFormat","currency")("isInvalid",i.checkIsRoomPlanListInvalid(a,"vendorMspAmount")),Ee.Cb(3),Ee.pc("ngIf",i.isSendAmountTypeCodeRequired),Ee.Cb(1),Ee.pc("ngIf",!i.isSendAmountTypeCodeRequired),Ee.Cb(2),Ee.pc("inputFormat","currency")("isInvalid",i.checkIsRoomPlanListInvalid(a,"vendorContractAmount"))}}function po(e,t){if(1&e&&(Ee.Ub(0),Ee.Wb(1,"dl"),Ee.Wb(2,"dt"),Ee.Pc(3,"Rate(%)"),Ee.Vb(),Ee.Wb(4,"dd"),Ee.Rb(5,"app-input-text",18),Ee.Vb(),Ee.Vb(),Ee.Wb(6,"dl"),Ee.Wb(7,"dt"),Ee.Pc(8,"V.Selling Net"),Ee.Vb(),Ee.Wb(9,"dd"),Ee.Rb(10,"app-input-text",19),Ee.Vb(),Ee.Vb(),Ee.Tb()),2&e){var n=Ee.hc().index,o=Ee.hc();Ee.Cb(5),Ee.pc("isInvalid",o.checkIsPromotionPlanListInvalid(n,"vendorSellingNetRate")),Ee.Cb(5),Ee.pc("inputFormat","currency")("isInvalid",o.checkIsPromotionPlanListInvalid(n,"vendorSellingNetAmount"))}}function mo(e,t){1&e&&(Ee.Ub(0),Ee.Wb(1,"sup"),Ee.Pc(2,"Contract"),Ee.Vb(),Ee.Tb())}function bo(e,t){1&e&&(Ee.Ub(0),Ee.Pc(1," Contract "),Ee.Tb())}function ho(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"div",8),Ee.Ub(1,9),Ee.Wb(2,"div",20),Ee.Pc(3),Ee.Vb(),Ee.Wb(4,"div",11),Ee.Wb(5,"dl"),Ee.Wb(6,"dt"),Ee.Wb(7,"sup"),Ee.Pc(8,"Net"),Ee.Vb(),Ee.Vb(),Ee.Wb(9,"dd"),Ee.Rb(10,"app-input-text",12),Ee.Vb(),Ee.Vb(),Ee.Nc(11,po,11,3,"ng-container",13),Ee.Wb(12,"dl"),Ee.Wb(13,"dt"),Ee.Wb(14,"sup"),Ee.Pc(15,"Extra Tax"),Ee.Vb(),Ee.Vb(),Ee.Wb(16,"dd"),Ee.Rb(17,"app-input-text",14),Ee.Vb(),Ee.Vb(),Ee.Wb(18,"dl"),Ee.Wb(19,"dt"),Ee.Pc(20,"Gross"),Ee.Vb(),Ee.Wb(21,"dd"),Ee.Wb(22,"app-input-text",15),Ee.fc("input",(function(e){Ee.Fc(n);var o=t.index,a=Ee.hc();return a.calculateVendorNetAmountByGross(e.target.value,a._PLAN_TYPE.PROMOTION,o)})),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Wb(23,"dl"),Ee.Wb(24,"dt"),Ee.Pc(25,"MSP"),Ee.Vb(),Ee.Wb(26,"dd"),Ee.Rb(27,"app-input-text",16),Ee.Vb(),Ee.Vb(),Ee.Wb(28,"dl"),Ee.Wb(29,"dt"),Ee.Nc(30,mo,3,0,"ng-container",13),Ee.Nc(31,bo,2,0,"ng-container",13),Ee.Vb(),Ee.Wb(32,"dd"),Ee.Rb(33,"app-input-text",17),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Tb(),Ee.Vb()}if(2&e){var o=t.$implicit,a=t.index,i=Ee.hc();Ee.Cb(1),Ee.qc("formGroupName",a),Ee.Cb(1),Ee.pc("innerHTML",i.convertPromotionTitleToHtml(o.value.promotionPlanNameEn),Ee.Gc),Ee.Cb(1),Ee.Qc(o.value.promotionPlanNameEn),Ee.Cb(7),Ee.pc("inputFormat","currency")("isInvalid",i.checkIsPromotionPlanListInvalid(a,"vendorNetAmount")),Ee.Cb(1),Ee.pc("ngIf",i.isExclusiveRate),Ee.Cb(6),Ee.pc("inputFormat","currency")("isInvalid",i.checkIsPromotionPlanListInvalid(a,"vendorTaxAmount")),Ee.Cb(5),Ee.pc("inputFormat","currency")("isInvalid",i.checkIsPromotionPlanListInvalid(a,"vendorGrossAmount")),Ee.Cb(5),Ee.pc("inputFormat","currency")("isInvalid",i.checkIsPromotionPlanListInvalid(a,"vendorMspAmount")),Ee.Cb(3),Ee.pc("ngIf",i.isSendAmountTypeCodeRequired),Ee.Cb(1),Ee.pc("ngIf",!i.isSendAmountTypeCodeRequired),Ee.Cb(2),Ee.pc("inputFormat","currency")("isInvalid",i.checkIsPromotionPlanListInvalid(a,"vendorContractAmount"))}}function fo(e,t){1&e&&(Ee.Wb(0,"p",21),Ee.Pc(1," No selected item.\n"),Ee.Vb())}var vo,yo=((vo=function(){function e(t,n){_classCallCheck(this,e),this._dataService=t,this._formService=n,this.isUpdateModal=!1,this.isSendAmountTypeCodeRequired=!1,this._PLAN_TYPE=Un,this._BOOKING_SEND_AMOUNT_TYPE_CODE=Gn,this._checkValid=!1,this._destroy$=new Se.a,this.submitForm=this._dataService.generateSubmitPlanFormGroup()}return _createClass(e,[{key:"checkedRoomPlanList",get:function(){return this._checkedRoomPlanList},set:function(e){var t;this._checkedRoomPlanList=e,this._destroyByCheckedRoomPlanList$&&(this._destroyByCheckedRoomPlanList$.next(),this._destroyByCheckedRoomPlanList$.complete()),this._destroyByCheckedRoomPlanList$=new Se.a,this.roomPlanFormListFormArray.clear();var n,o=_createForOfIteratorHelper(this._checkedRoomPlanList);try{for(o.s();!(n=o.n()).done;){var a=n.value,i=a.sendAmountTypeCode===this._BOOKING_SEND_AMOUNT_TYPE_CODE.CONTRACT;this.isSendAmountTypeCodeRequired=i;var r=this._dataService.generateRatePlanGrossGroup(null===(t=this.hotelContractInfo)||void 0===t?void 0:t.extraTaxPaymentYn,i);if(r.patchValue(a),this.isUpdateModal){var l=this._getVendorSellingNetRate(this.hotelContractInfo);r.patchValue(this.hotelContractInfo),r.patchValue({vendorSellingNetRate:l})}this._addSubscribeRoomPlanFormGroup(r),this.roomPlanFormListFormArray.push(r)}}catch(c){o.e(c)}finally{o.f()}}},{key:"checkedPromotionPlanList",get:function(){return this._checkedPromotionPlanList},set:function(e){var t;this._checkedPromotionPlanList=e,this._destroyByCheckedPromotionPlanList$&&(this._destroyByCheckedPromotionPlanList$.next(),this._destroyByCheckedPromotionPlanList$.complete()),this._destroyByCheckedPromotionPlanList$=new Se.a,this.promotionPlanFormListFormArray.clear();var n,o=_createForOfIteratorHelper(this._checkedPromotionPlanList);try{for(o.s();!(n=o.n()).done;){var a=n.value,i=a.sendAmountTypeCode===this._BOOKING_SEND_AMOUNT_TYPE_CODE.CONTRACT;this.isSendAmountTypeCodeRequired=i;var r=this._dataService.generateRatePlanGrossGroup(null===(t=this.hotelContractInfo)||void 0===t?void 0:t.extraTaxPaymentYn,i);if(r.patchValue(a),this.isUpdateModal){var l=this._getVendorSellingNetRate(this.hotelContractInfo);r.patchValue(this.hotelContractInfo),r.patchValue({vendorSellingNetRate:l})}this._addSubscribePromotionPlanFormGroup(r),this.promotionPlanFormListFormArray.push(r)}}catch(c){o.e(c)}finally{o.f()}}},{key:"roomPlanFormListFormArray",get:function(){return this.submitForm.controls.roomPlanFormListFormArray}},{key:"promotionPlanFormListFormArray",get:function(){return this.submitForm.controls.promotionPlanFormListFormArray}},{key:"isExclusiveRate",get:function(){var e,t;return!("HOC01"!==(null===(e=this.checkedRoomPlanList[0])||void 0===e?void 0:e.hotelContractTypeCode)&&"HOC01"!==(null===(t=this.checkedPromotionPlanList[0])||void 0===t?void 0:t.hotelContractTypeCode))}},{key:"isNoItem",get:function(){return Te.isEmpty(this.checkedRoomPlanList)&&Te.isEmpty(this.checkedPromotionPlanList)}},{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this._destroyByCheckedRoomPlanList$&&(this._destroyByCheckedRoomPlanList$.next(),this._destroyByCheckedRoomPlanList$.complete()),this._destroyByCheckedPromotionPlanList$&&(this._destroyByCheckedPromotionPlanList$.next(),this._destroyByCheckedPromotionPlanList$.complete()),this._destroy$.next(),this._destroy$.complete()}},{key:"calculateVendorNetAmountByGross",value:function(e,t,n){var o,a,i,r,l,c,s=e.replace(/[^\d\.]/g,""),u=Number(s),p=u-u*((null!==(c=null!==(i=null===(a=null===(o=this.checkedDateInfo[0])||void 0===o?void 0:o.plans[0].params)||void 0===a?void 0:a.vendorCommRate)&&void 0!==i?i:null===(l=null===(r=this.checkedRoomPlanList)||void 0===r?void 0:r[0])||void 0===l?void 0:l.vendorCommRate)&&void 0!==c?c:0)/100),d=t===this._PLAN_TYPE.ROOM?this._getRoomPlanFormGroupByIndex(n):this._getPromotionPlanFormGroupByIndex(n),m=Number(p.toFixed("USD"===d.value.currencyCode||"EUR"===d.value.currencyCode?2:0));d.get("vendorNetAmount").patchValue(m)}},{key:"checkIsRoomPlanListInvalid",value:function(e,t){return this._checkValid&&this.roomPlanFormListFormArray.at(e).get(t)&&this.roomPlanFormListFormArray.at(e).get(t).invalid}},{key:"checkIsPromotionPlanListInvalid",value:function(e,t){return this._checkValid&&this.promotionPlanFormListFormArray.at(e).get(t)&&this.promotionPlanFormListFormArray.at(e).get(t).invalid}},{key:"convertPromotionTitleToHtml",value:function(e){var t=e.split(":"),n=t.length,o=t.reduce((function(e,t,o){return o+1>=n?e:e+=t}),""),a=t[n-1];return'<span class="font-weight-bold">'.concat(o.trim(),"</span><br /><span>").concat(a.trim(),"</span>")}},{key:"makeSubmitFormData",value:function(){if(this.submitForm.invalid)return this._checkValid=!0,this.roomPlanFormListFormArray.controls.forEach((function(e){Object.keys(e.controls).forEach((function(t){e.controls[t].invalid&&console.error(t+" is invalid")}))})),void this.promotionPlanFormListFormArray.controls.forEach((function(e){Object.keys(e.controls).forEach((function(t){e.controls[t].invalid&&console.error(t+" is invalid")}))}));var e=this._dataService.initRoomTypePlanKeysDefaultData(),t=this._formService.fitFormArrayDataToDefaultData(this.roomPlanFormListFormArray.getRawValue(),e),n=this._formService.fitFormArrayDataToDefaultData(this.promotionPlanFormListFormArray.getRawValue(),e),o=[].concat(t,n);return this._checkValid=!1,o}},{key:"_addSubscribeRoomPlanFormGroup",value:function(e){var t=e.get("vendorSellingNetAmount");e.get("vendorSellingNetRate").valueChanges.pipe(Object(Oe.a)(this._destroy$),Object(Oe.a)(this._destroyByCheckedRoomPlanList$),Object(Bn.a)()).subscribe((function(n){var o=e.get("vendorNetAmount").value;t.patchValue(o*(1+.01*n))}))}},{key:"_getRoomPlanFormGroupByIndex",value:function(e){return this.roomPlanFormListFormArray.at(e)}},{key:"_addSubscribePromotionPlanFormGroup",value:function(e){var t=e.get("vendorSellingNetAmount");e.get("vendorSellingNetRate").valueChanges.pipe(Object(Oe.a)(this._destroy$),Object(Oe.a)(this._destroyByCheckedPromotionPlanList$),Object(Bn.a)()).subscribe((function(n){var o=e.get("vendorNetAmount").value;t.patchValue(o*(1+.01*n))}))}},{key:"_getPromotionPlanFormGroupByIndex",value:function(e){return this.promotionPlanFormListFormArray.at(e)}},{key:"_getVendorSellingNetRate",value:function(e){return Te.round(100*(e.vendorSellingNetAmount-e.vendorNetAmount)/e.vendorNetAmount,2)}}]),e}()).\u0275fac=function(e){return new(e||vo)(Ee.Qb(Xn),Ee.Qb(Ye.a))},vo.\u0275cmp=Ee.Kb({type:vo,selectors:[["app-rate-detail-selected-rate-plan-gross"]],inputs:{isUpdateModal:"isUpdateModal",hotelContractInfo:"hotelContractInfo",checkedDateInfo:"checkedDateInfo",checkedRoomPlanList:"checkedRoomPlanList",checkedPromotionPlanList:"checkedPromotionPlanList"},decls:21,vars:7,consts:[[1,"page-item-header"],[1,"promotion-rate-summary"],[1,"align-r","font-size-sm","color-dark-color4","mb5"],[3,"formGroup"],["formArrayName","roomPlanFormListFormArray"],["class","input-contents-item",4,"ngFor","ngForOf"],["formArrayName","promotionPlanFormListFormArray"],["style","text-align: center; font-size: 13px",4,"ngIf"],[1,"input-contents-item"],[3,"formGroupName"],[1,"title"],[1,"input-contents-area"],["formControlName","vendorNetAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],[4,"ngIf"],["formControlName","vendorTaxAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],["formControlName","vendorGrossAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid","input"],["formControlName","vendorMspAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],["formControlName","vendorContractAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],["formControlName","vendorSellingNetRate","valueType","number","placeholder","0.00",3,"isInvalid"],["formControlName","vendorSellingNetAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],[1,"title",3,"innerHTML"],[2,"text-align","center","font-size","13px"]],template:function(e,t){1&e&&(Ee.Wb(0,"div",0),Ee.Wb(1,"strong"),Ee.Wb(2,"sup"),Ee.Pc(3,"Select Room Plan or Promotion Rate Plan"),Ee.Vb(),Ee.Vb(),Ee.Wb(4,"ul",1),Ee.Wb(5,"li"),Ee.Pc(6),Ee.Vb(),Ee.Wb(7,"li"),Ee.Pc(8,"Gross"),Ee.Vb(),Ee.Wb(9,"li"),Ee.Pc(10),Ee.Vb(),Ee.Wb(11,"li"),Ee.Pc(12),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Wb(13,"p",2),Ee.Pc(14,'The extra tax field can use in case of "Extra Tax Payment : Y " only'),Ee.Vb(),Ee.Ub(15,3),Ee.Ub(16,4),Ee.Nc(17,uo,34,15,"div",5),Ee.Tb(),Ee.Ub(18,6),Ee.Nc(19,ho,34,16,"div",5),Ee.Tb(),Ee.Tb(),Ee.Nc(20,fo,2,0,"p",7)),2&e&&(Ee.Cb(6),Ee.Rc("Curr : ",null==t.hotelContractInfo?null:t.hotelContractInfo.currencyCode,""),Ee.Cb(4),Ee.Rc("Comm Rate : ",null==t.hotelContractInfo?null:t.hotelContractInfo.vendorCommRate,"%"),Ee.Cb(2),Ee.Rc("Extra Tax Payment : ",null!=t.hotelContractInfo&&t.hotelContractInfo.extraTaxPaymentYn?"Y":"N",""),Ee.Cb(3),Ee.pc("formGroup",t.submitForm),Ee.Cb(2),Ee.pc("ngForOf",null==t.roomPlanFormListFormArray?null:t.roomPlanFormListFormArray.controls),Ee.Cb(2),Ee.pc("ngForOf",null==t.promotionPlanFormListFormArray?null:t.promotionPlanFormListFormArray.controls),Ee.Cb(1),Ee.pc("ngIf",t.isNoItem))},directives:[i.s,i.k,i.e,a.n,a.o,i.l,zn.a,i.r,i.i],styles:['.page-item-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.ul-rate-detail[_ngcontent-%COMP%]{display:flex;color:#ff682c;font-size:12px}.ul-rate-detail[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:not(:last-child):after{content:"|";color:#262626;margin:0 12px}.title[_ngcontent-%COMP%]{white-space:break-spaces}textarea[_ngcontent-%COMP%]:-moz-read-only{background-color:#f5f5f5}textarea[_ngcontent-%COMP%]:read-only{background-color:#f5f5f5}']}),vo),Po=n("rbKv"),Co=n("kd+X"),go=n("LVFn"),Do=function(e){return["ratePeriod","periods",e]},ko=function(){return{standalone:!0}},So=function(e,t){return{"fa-plus":e,"fa-minus":t}};function Io(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"div",25),Ee.Ub(1,26),Ee.Wb(2,"div",27),Ee.Rb(3,"mat-datepicker-toggle",28),Ee.Rb(4,"input",29),Ee.Rb(5,"mat-datepicker",null,30),Ee.Vb(),Ee.Wb(7,"div",31),Ee.Pc(8,"~"),Ee.Vb(),Ee.Wb(9,"div",32),Ee.Rb(10,"mat-datepicker-toggle",28),Ee.Rb(11,"input",33),Ee.Rb(12,"mat-datepicker",null,34),Ee.Vb(),Ee.Wb(14,"app-checkbox",35),Ee.fc("onChange",(function(e){Ee.Fc(n);var o=t.index;return Ee.hc(2).onDayCheckAll(e,o)})),Ee.Vb(),Ee.Rb(15,"app-checkbox",36),Ee.Rb(16,"app-checkbox",37),Ee.Rb(17,"app-checkbox",38),Ee.Rb(18,"app-checkbox",39),Ee.Rb(19,"app-checkbox",40),Ee.Rb(20,"app-checkbox",41),Ee.Rb(21,"app-checkbox",42),Ee.Wb(22,"button",43),Ee.fc("click",(function(){Ee.Fc(n);var e=t.index;return Ee.hc(2).addRemovePeriod(e)})),Ee.Rb(23,"i",44),Ee.Vb(),Ee.Tb(),Ee.Vb()}if(2&e){var o=t.index,a=Ee.Ec(6),i=Ee.Ec(13),r=Ee.hc(2);Ee.Cb(1),Ee.qc("formGroupName",o),Ee.Cb(1),Ee.Gb("valid-error",r.checkIsInvalid(Ee.uc(12,Do,o))),Ee.Cb(1),Ee.pc("for",a),Ee.Cb(1),Ee.pc("matDatepicker",a),Ee.Cb(5),Ee.Gb("valid-error",r.checkIsInvalid(Ee.uc(14,Do,o))),Ee.Cb(1),Ee.pc("for",i),Ee.Cb(1),Ee.pc("matDatepicker",i),Ee.Cb(3),Ee.pc("ngModel",r.isAllDayCheckedByItem(o))("ngModelOptions",Ee.tc(16,ko)),Ee.Cb(9),Ee.pc("ngClass",Ee.vc(17,So,0==o,o>0))}}function Oo(e,t){if(1&e&&(Ee.Wb(0,"tr"),Ee.Wb(1,"th",10),Ee.Pc(2,"Period"),Ee.Vb(),Ee.Wb(3,"td"),Ee.Ub(4,23),Ee.Nc(5,Io,24,20,"div",24),Ee.Tb(),Ee.Vb(),Ee.Vb()),2&e){var n=Ee.hc();Ee.Cb(5),Ee.pc("ngForOf",n.periodArray.controls)}}function Ro(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"button",45),Ee.fc("click",(function(){return Ee.Fc(n),Ee.hc().showCalendar("include")})),Ee.Pc(1," Select Date "),Ee.Vb()}}function To(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"button",46),Ee.fc("click",(function(){return Ee.Fc(n),Ee.hc().resetIncludeDates()})),Ee.Pc(1," Reset Date "),Ee.Vb()}}function Vo(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"tr"),Ee.Wb(1,"th",10),Ee.Pc(2," Exclude Days "),Ee.Wb(3,"button",45),Ee.fc("click",(function(){return Ee.Fc(n),Ee.hc().showCalendar("exclude")})),Ee.Pc(4," Select Date "),Ee.Vb(),Ee.Wb(5,"button",47),Ee.fc("click",(function(){return Ee.Fc(n),Ee.hc().resetExcludeDates()})),Ee.Pc(6," Reset Date "),Ee.Vb(),Ee.Vb(),Ee.Wb(7,"td"),Ee.Wb(8,"div",13),Ee.Rb(9,"textarea",48),Ee.Vb(),Ee.Vb(),Ee.Vb()}}function Ao(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"app-checkbox",50),Ee.fc("onChange",(function(e){return Ee.Fc(n),Ee.hc(2).onRoomPlanCheckAll(e)})),Ee.Vb()}}function No(e,t){if(1&e&&(Ee.Wb(0,"li"),Ee.Nc(1,Ao,1,0,"app-checkbox",49),Ee.Vb()),2&e){var n=Ee.hc();Ee.Cb(1),Ee.pc("ngIf",!n.isUpdateModal)}}function Fo(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"li"),Ee.Wb(1,"app-checkbox",51),Ee.fc("ngModelChange",(function(e){return Ee.Fc(n),Ee.hc().checkedRoomPlanIdList=e}))("onChange",(function(e){Ee.Fc(n);var o=t.$implicit;return Ee.hc().onRoomPlanCheck(e,o)})),Ee.Vb(),Ee.Vb()}if(2&e){var o=t.$implicit,a=Ee.hc();Ee.Cb(1),Ee.pc("ngModel",a.checkedRoomPlanIdList)("value",o.vendorRoomPlanSeq)("label",o.roomPlanNameEn)("ngModelOptions",Ee.tc(5,ko))("disabled",a.isUpdateModal)}}function _o(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"app-checkbox",53),Ee.fc("onChange",(function(e){return Ee.Fc(n),Ee.hc(2).onPromotionPlanCheckAll(e)})),Ee.Vb()}}function Eo(e,t){if(1&e&&(Ee.Wb(0,"li"),Ee.Nc(1,_o,1,0,"app-checkbox",52),Ee.Vb()),2&e){var n=Ee.hc();Ee.Cb(1),Ee.pc("ngIf",!n.isUpdateModal)}}function Lo(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"li"),Ee.Wb(1,"app-checkbox",51),Ee.fc("ngModelChange",(function(e){return Ee.Fc(n),Ee.hc().checkedPromotionPlanIdList=e}))("onChange",(function(e){Ee.Fc(n);var o=t.$implicit;return Ee.hc().onPromotionPlanCheck(e,o)})),Ee.Vb(),Ee.Vb()}if(2&e){var o=t.$implicit,a=Ee.hc();Ee.Cb(1),Ee.pc("ngModel",a.checkedPromotionPlanIdList)("value",o.planPromotionSeq)("label",o.promotionPlanNameEn)("ngModelOptions",Ee.tc(5,ko))("disabled",a.isUpdateModal)}}function Wo(e,t){if(1&e&&(Ee.Ub(0),Ee.Rb(1,"app-rate-detail-selected-rate-plan-gross",54),Ee.Tb()),2&e){var n=Ee.hc();Ee.Cb(1),Ee.pc("isUpdateModal",n.isUpdateModal)("hotelContractInfo",n.hotelContractInfo)("checkedDateInfo",n.checkedDateInfo)("checkedRoomPlanList",n.checkedRoomPlanList)("checkedPromotionPlanList",n.checkedPromotionPlanList)}}function xo(e,t){if(1&e&&(Ee.Ub(0),Ee.Rb(1,"app-rate-detail-selected-rate-plan-net",54),Ee.Tb()),2&e){var n=Ee.hc();Ee.Cb(1),Ee.pc("isUpdateModal",n.isUpdateModal)("hotelContractInfo",n.hotelContractInfo)("checkedDateInfo",n.checkedDateInfo)("checkedRoomPlanList",n.checkedRoomPlanList)("checkedPromotionPlanList",n.checkedPromotionPlanList)}}var jo,Yo,Mo=((jo=function(){function e(t,n){_classCallCheck(this,e),this._dataService=t,this._alertService=n,this.isUpdateModal=!1,this.isImmutableIncludeDays=!1,this.openCalendarEvent=new Ee.n,this.submitEvent=new Ee.n,this.closeEvent=new Ee.n,this.checkedRoomPlanIdList=[],this.checkedRoomPlanList=[],this.checkedPromotionPlanIdList=[],this.checkedPromotionPlanList=[],this.unsubscribe$=new Se.a,this.upsertForm=this._dataService.generateRatePutForm()}return _createClass(e,[{key:"includeDays",get:function(){return this._includeDays},set:function(e){this._includeDays=e,this._setIncludeDates(this._includeDays)}},{key:"excludeDays",get:function(){return this._excludeDays},set:function(e){this._excludeDays=e,this._setExcludeDates(this._excludeDays)}},{key:"periodArray",get:function(){return this.upsertForm.get("ratePeriod").get("periods")}},{key:"hotelContractInfo",get:function(){var e,t,n,o,a,i,r,l,c,s,u,p,d,m,b,h,f,v,y,P,C=null===(o=null===(n=null===(t=null===(e=this.promotionCheckedDateInfo)||void 0===e?void 0:e[0])||void 0===t?void 0:t.plans)||void 0===n?void 0:n[0])||void 0===o?void 0:o.params,g=null===(l=null===(r=null===(i=null===(a=this.checkedDateInfo)||void 0===a?void 0:a[0])||void 0===i?void 0:i.plans)||void 0===r?void 0:r[0])||void 0===l?void 0:l.params,D={currencyCode:(null===(s=null===(c=this.roomPlanList)||void 0===c?void 0:c[0])||void 0===s?void 0:s.currencyCode)||(null===(p=null===(u=this.promotionPlanList)||void 0===u?void 0:u[0])||void 0===p?void 0:p.currencyCode),vendorCommRate:(null===(m=null===(d=this.roomPlanList)||void 0===d?void 0:d[0])||void 0===m?void 0:m.vendorCommRate)||(null===(h=null===(b=this.promotionPlanList)||void 0===b?void 0:b[0])||void 0===h?void 0:h.vendorCommRate),extraTaxPaymentYn:(null===(v=null===(f=this.roomPlanList)||void 0===f?void 0:f[0])||void 0===v?void 0:v.extraTaxPaymentYn)||(null===(P=null===(y=this.promotionPlanList)||void 0===y?void 0:y[0])||void 0===P?void 0:P.extraTaxPaymentYn)};return C||g||D}},{key:"isModifyPromotion",get:function(){return!!this.promotionCheckedDateInfo}},{key:"isGrossContract",get:function(){var e,t,n,o;return!1===(null===(t=null===(e=this.roomPlanList)||void 0===e?void 0:e[0])||void 0===t?void 0:t.netProvideYn)||!1===(null===(o=null===(n=this.promotionPlanList)||void 0===n?void 0:n[0])||void 0===o?void 0:o.netProvideYn)}},{key:"isNetContract",get:function(){var e,t,n,o;return!0===(null===(t=null===(e=this.roomPlanList)||void 0===e?void 0:e[0])||void 0===t?void 0:t.netProvideYn)||!0===(null===(o=null===(n=this.promotionPlanList)||void 0===n?void 0:n[0])||void 0===o?void 0:o.netProvideYn)}},{key:"roomPlanListLength",get:function(){var e;return(null===(e=this.roomPlanList)||void 0===e?void 0:e.length)||0}},{key:"promotionPlanListLength",get:function(){var e;return(null===(e=this.promotionPlanList)||void 0===e?void 0:e.length)||0}},{key:"periodGroup",value:function(e){return this.periodArray.at(e)}},{key:"isAllDayCheckedByItem",value:function(e){return!0===this.periodArray.at(e).get("appliedMonYn").value&&!0===this.periodArray.at(e).get("appliedTueYn").value&&!0===this.periodArray.at(e).get("appliedWedYn").value&&!0===this.periodArray.at(e).get("appliedThuYn").value&&!0===this.periodArray.at(e).get("appliedFriYn").value&&!0===this.periodArray.at(e).get("appliedSatYn").value&&!0===this.periodArray.at(e).get("appliedSunYn").value}},{key:"ngOnInit",value:function(){this.upsertForm.get("hotelCode").setValue(this.hotelProfile.hotelCode),this._setPlanList(),this._setUpdateFormData(),this.periodArray.push(this._dataService.generatePeriodGroups()),this._setIncludeExcludeDays()}},{key:"ngOnDestroy",value:function(){this.unsubscribe$.next(),this.unsubscribe$.complete()}},{key:"onSubmit",value:function(){var e,t,n,o,a=this;if(this._v_isDateConditionFilled()||this._alertService.alert("Please fill the date condition."),this.upsertForm.invalid||!this._v_isDateConditionFilled())return this.checkValid=!0,void Object.keys(this.upsertForm.controls).forEach((function(e){a.upsertForm.get(e).invalid&&console.error(e+" is invalid.")}));var i=this._getRoomTypePlansFromComponent();if(Te.isEmpty(i))this._alertService.alert("Please fill the room type plan or promotion plan.");else{var r=this.upsertForm.getRawValue();(Te.isNil(null===(t=null===(e=r.ratePeriod.periods)||void 0===e?void 0:e[0])||void 0===t?void 0:t.appliedFromDate)||Te.isNil(null===(o=null===(n=r.ratePeriod.periods)||void 0===n?void 0:n[0])||void 0===o?void 0:o.appliedToDate))&&(r.ratePeriod.periods=null),r.roomTypePlans=i;var l=r;this.checkValid=!1,this.submitEvent.emit(l)}}},{key:"onClose",value:function(){this.closeEvent.emit()}},{key:"checkIsInvalid",value:function(e){return this.checkValid&&this.upsertForm.get(e)&&this.upsertForm.get(e).invalid}},{key:"addRemovePeriod",value:function(e){e?this.removePeriod(e):this.periodArray.push(this._dataService.generatePeriodGroups())}},{key:"removePeriod",value:function(e){this.periodArray.removeAt(e)}},{key:"onRoomPlanCheckAll",value:function(e){var t=this;this.checkedRoomPlanIdList=e?Te.map(this.roomPlanList,"vendorRoomPlanSeq"):[],this.checkedRoomPlanList=this.roomPlanList.filter((function(e){return t.checkedRoomPlanIdList.includes(e.vendorRoomPlanSeq)}))}},{key:"onRoomPlanCheck",value:function(e,t){var n=this;e?this.checkedRoomPlanIdList.push(t.vendorRoomPlanSeq):Te.remove(this.checkedRoomPlanIdList,(function(e){return e===t.vendorRoomPlanSeq})),this.checkedRoomPlanList=this.roomPlanList.filter((function(e){return n.checkedRoomPlanIdList.includes(e.vendorRoomPlanSeq)}))}},{key:"onPromotionPlanCheckAll",value:function(e){var t=this;this.checkedPromotionPlanIdList=e?Te.map(this.promotionPlanList,"planPromotionSeq"):[],this.checkedPromotionPlanList=this.promotionPlanList.filter((function(e){return t.checkedPromotionPlanIdList.includes(e.planPromotionSeq)}))}},{key:"onPromotionPlanCheck",value:function(e,t){var n=this;e?this.checkedPromotionPlanIdList.push(t.planPromotionSeq):Te.remove(this.checkedPromotionPlanIdList,(function(e){return e===t.planPromotionSeq})),this.checkedPromotionPlanList=this.promotionPlanList.filter((function(e){return n.checkedPromotionPlanIdList.includes(e.planPromotionSeq)}))}},{key:"onDayCheckAll",value:function(e,t){var n=this.periodGroup(t);n.get("appliedMonYn").patchValue(e),n.get("appliedTueYn").patchValue(e),n.get("appliedWedYn").patchValue(e),n.get("appliedThuYn").patchValue(e),n.get("appliedFriYn").patchValue(e),n.get("appliedSatYn").patchValue(e),n.get("appliedSunYn").patchValue(e)}},{key:"showCalendar",value:function(e){if("exclude"===e){if(!this._periodDateCheck())return void this._alertService.alert("Input period date first.");var t=this._getPeriodMinDate(),n=We(t,"YYYY-MM-DD").year(),o=We(t,"YYYY-MM-DD").month()+1,a=[];this.periodArray.value.forEach((function(e){a.push({firstDate:e.appliedFromDate,lastDate:e.appliedToDate})})),this.openCalendarEvent.emit({type:e,isPreview:!1,minDate:{year:n,month:o},validDateRange:a})}else this.openCalendarEvent.emit({type:e,isPreview:!1,validDateRange:null})}},{key:"resetIncludeDates",value:function(){this.upsertForm.get("ratePeriod").get("includeDates").setValue([])}},{key:"resetExcludeDates",value:function(){this.upsertForm.get("ratePeriod").get("excludeDates").setValue([])}},{key:"_getPeriodMinDate",value:function(){var e=this.periodArray.getRawValue();return Te.min(Te.map(e,"appliedFromDate"))}},{key:"_periodDateCheck",value:function(){var e=this.periodArray.value,t=Te.map(e,"appliedFromDate"),n=Te.map(e,"appliedToDate");return Te.every(t,Boolean)&&Te.every(n,Boolean)}},{key:"_setPlanList",value:function(){this.roomPlanList=this.planList.roomPlanList,this.promotionPlanList=this.planList.promotionPlanList}},{key:"_setUpdateFormData",value:function(){var e,t,n,o=this;if(this.isUpdateModal){var a=null===(n=null===(t=null===(e=this.checkedDateInfo)||void 0===e?void 0:e[0])||void 0===t?void 0:t.plans)||void 0===n?void 0:n[0];if(Te.isNil(a)&&Te.isNil(this.promotionCheckedDateInfo))return void console.error("This is update modal but, selectedRoomPlanis and promotionCheckedDateInfo are nil at the same time.",this.checkedDateInfo,this.promotionCheckedDateInfo);a?(this.checkedRoomPlanIdList.push(a.planId),this.checkedRoomPlanList=this.roomPlanList.filter((function(e){return o.checkedRoomPlanIdList.includes(e.vendorRoomPlanSeq)})),this.roomPlanList=this.checkedRoomPlanList,this.promotionPlanList=[]):this.promotionCheckedDateInfo&&(this.checkedPromotionPlanIdList.push(this.promotionCheckedDateInfo[0].plans[0].params.planPromotionSeq),this.checkedPromotionPlanList=this.promotionPlanList.filter((function(e){return o.checkedPromotionPlanIdList.includes(e.planPromotionSeq)})),this.promotionPlanList=this.checkedPromotionPlanList,this.roomPlanList=[])}}},{key:"_setIncludeExcludeDays",value:function(){this.includeDays&&this.isImmutableIncludeDays&&this.upsertForm.get("ratePeriod").get("includeDates").setValue(this.includeDays),this.excludeDays&&this.upsertForm.get("ratePeriod").get("excludeDates").setValue(this.excludeDays)}},{key:"_getRoomTypePlansFromComponent",value:function(){return this.isGrossContract?this.ratePlanGrossComponent.makeSubmitFormData():this.isNetContract?this.ratePlanNetComponent.makeSubmitFormData():(console.error("Invalid contract type."),null)}},{key:"_setIncludeDates",value:function(e){var t=this;if(e){var n=!1,o=e.filter((function(e){var o;return!(null===(o=t.excludeDays)||void 0===o?void 0:o.includes(e))||(n=!0,!1)}));n&&this._alertService.alert("Include date and Exclude date cannot be overlapped"),this.upsertForm.get("ratePeriod").get("includeDates").setValue(o)}else this.upsertForm.get("ratePeriod").get("includeDates").setValue([])}},{key:"_setExcludeDates",value:function(e){var t=this;if(e){var n=!1,o=e.filter((function(e){var o;return!(null===(o=t.includeDays)||void 0===o?void 0:o.includes(e))||(n=!0,!1)}));n&&this._alertService.alert("Include date and Exclude date cannot be overlapped"),this.upsertForm.get("ratePeriod").get("excludeDates").setValue(o)}else this.upsertForm.get("ratePeriod").get("excludeDates").setValue([])}},{key:"_v_isDateConditionFilled",value:function(){var e,t=this.upsertForm.controls.ratePeriod.controls.includeDates,n=this._v_isPeriodArrayFilled(),o=(null===(e=t.value)||void 0===e?void 0:e.length)>0&&t.valid;return n||o}},{key:"_v_isPeriodArrayFilled",value:function(){var e=this.periodArray.value;return!!((null==e?void 0:e.length)>0&&this.periodArray.valid)&&(!(1!==(null==e?void 0:e.length)||!e[0].appliedFromDate||!e[0].appliedToDate)||Te.every(e,(function(e){return e.appliedFromDate&&e.appliedToDate})))}}]),e}()).\u0275fac=function(e){return new(e||jo)(Ee.Qb(Xn),Ee.Qb(Qe.a))},jo.\u0275cmp=Ee.Kb({type:jo,selectors:[["app-rate-detail"]],viewQuery:function(e,t){var n;1&e&&(Ee.Xc(ro,!0),Ee.Xc(yo,!0)),2&e&&(Ee.Dc(n=Ee.gc())&&(t.ratePlanNetComponent=n.first),Ee.Dc(n=Ee.gc())&&(t.ratePlanGrossComponent=n.first))},inputs:{isUpdateModal:"isUpdateModal",isImmutableIncludeDays:"isImmutableIncludeDays",hotelProfile:"hotelProfile",planList:"planList",checkedDateInfo:"checkedDateInfo",promotionCheckedDateInfo:"promotionCheckedDateInfo",includeDays:"includeDays",excludeDays:"excludeDays"},outputs:{openCalendarEvent:"openCalendarEvent",submitEvent:"submitEvent",closeEvent:"closeEvent"},decls:50,vars:14,consts:[[1,"main-contents-summary-inner","mb20"],[1,"font-size-lg","font-weight-bold"],[1,"promotion-rate"],[3,"formGroup","connectForm"],[1,"page-item"],[1,"page-item-header"],[1,"table","table-bordered"],["width","130px"],["formGroupName","ratePeriod"],[4,"ngIf"],["scope","row",1,"th-bg"],["type","button","class","btn btn-light sm mt10 full",3,"click",4,"ngIf"],["type","button","class","btn btn-secondary sm mt5 mb5 full",3,"click",4,"ngIf"],[1,"textarea"],["formControlName","includeDates","cols","30","rows","3","readonly",""],[1,"item-box"],[1,"mb20"],[4,"ngFor","ngForOf"],[2,"border","solid #e0e0e0","border-width","1px 0 0 0"],[1,"mt15"],[1,"button-area","align-r","mt10"],[1,"btn","btn-secondary","sm",3,"click"],[1,"btn","btn-light","sm",3,"click"],["formArrayName","periods"],["class","form-group",4,"ngFor","ngForOf"],[1,"form-group"],[3,"formGroupName"],[1,"input","calendar"],[3,"for"],["type","text","placeholder","YYYY-MM-DD","formControlName","appliedFromDate",3,"matDatepicker"],["myPickerFrom",""],[1,"dash"],[1,"input","calendar","mr20"],["type","text","placeholder","YYYY-MM-DD","formControlName","appliedToDate",3,"matDatepicker"],["myPickerTo",""],["binary","true","label","All",3,"ngModel","ngModelOptions","onChange"],["formControlName","appliedMonYn","binary","true","label","Mon"],["formControlName","appliedTueYn","binary","true","label","Tue"],["formControlName","appliedWedYn","binary","true","label","Wed"],["formControlName","appliedThuYn","binary","true","label","Thu"],["formControlName","appliedFriYn","binary","true","label","Fri"],["formControlName","appliedSatYn","binary","true","label","Sat"],["formControlName","appliedSunYn","binary","true","label","Sun"],["type","button",1,"btn","btn-outline-secondary","btn-icon-only","xs","ml10",3,"click"],[1,"fas",3,"ngClass"],["type","button",1,"btn","btn-light","sm","mt10","full",3,"click"],["type","button",1,"btn","btn-secondary","sm","mt5","mb5","full",3,"click"],["type","button",1,"btn","btn","btn-secondary","sm","mt5","mb5","full",3,"click"],["formControlName","excludeDates","cols","30","rows","3","readonly",""],["label","All Room Plan",3,"onChange",4,"ngIf"],["label","All Room Plan",3,"onChange"],[3,"ngModel","value","label","ngModelOptions","disabled","ngModelChange","onChange"],["label","All Promotion Plan",3,"onChange",4,"ngIf"],["label","All Promotion Plan",3,"onChange"],[3,"isUpdateModal","hotelContractInfo","checkedDateInfo","checkedRoomPlanList","checkedPromotionPlanList"]],template:function(e,t){1&e&&(Ee.Wb(0,"div",0),Ee.Wb(1,"p",1),Ee.Pc(2),Ee.Vb(),Ee.Vb(),Ee.Wb(3,"div",2),Ee.Wb(4,"form",3),Ee.Wb(5,"div",4),Ee.Wb(6,"div",5),Ee.Wb(7,"strong"),Ee.Wb(8,"sup"),Ee.Pc(9,"Date Condition"),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Wb(10,"div",6),Ee.Wb(11,"table"),Ee.Wb(12,"caption"),Ee.Pc(13," Date Condition "),Ee.Vb(),Ee.Wb(14,"colgroup"),Ee.Rb(15,"col",7),Ee.Rb(16,"col"),Ee.Vb(),Ee.Wb(17,"tbody",8),Ee.Nc(18,Oo,6,1,"tr",9),Ee.Wb(19,"tr"),Ee.Wb(20,"th",10),Ee.Pc(21," Include Days "),Ee.Nc(22,Ro,2,0,"button",11),Ee.Nc(23,To,2,0,"button",12),Ee.Vb(),Ee.Wb(24,"td"),Ee.Wb(25,"div",13),Ee.Rb(26,"textarea",14),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Nc(27,Vo,10,0,"tr",9),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Wb(28,"div",4),Ee.Wb(29,"div",5),Ee.Wb(30,"strong"),Ee.Wb(31,"sup"),Ee.Pc(32,"Select Room Type & Plan"),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Wb(33,"div",15),Ee.Wb(34,"ul",16),Ee.Nc(35,No,2,1,"li",9),Ee.Nc(36,Fo,2,6,"li",17),Ee.Vb(),Ee.Rb(37,"hr",18),Ee.Wb(38,"ul",19),Ee.Nc(39,Eo,2,1,"li",9),Ee.Nc(40,Lo,2,6,"li",17),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Wb(41,"div",4),Ee.Nc(42,Wo,2,5,"ng-container",9),Ee.Vb(),Ee.Wb(43,"div",4),Ee.Nc(44,xo,2,5,"ng-container",9),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Wb(45,"div",20),Ee.Wb(46,"button",21),Ee.fc("click",(function(){return t.onSubmit()})),Ee.Pc(47,"Save"),Ee.Vb(),Ee.Wb(48,"button",22),Ee.fc("click",(function(){return t.onClose()})),Ee.Pc(49,"Close"),Ee.Vb(),Ee.Vb()),2&e&&(Ee.Cb(2),Ee.Sc(" [",null==t.hotelProfile?null:t.hotelProfile.hotelCode,"] ",null==t.hotelProfile?null:t.hotelProfile.hotelNameEn," "),Ee.Cb(2),Ee.pc("formGroup",t.upsertForm)("connectForm",t.upsertFormData),Ee.Cb(14),Ee.pc("ngIf",!t.isUpdateModal||t.isModifyPromotion),Ee.Cb(4),Ee.pc("ngIf",!t.isImmutableIncludeDays),Ee.Cb(1),Ee.pc("ngIf",!t.isImmutableIncludeDays),Ee.Cb(4),Ee.pc("ngIf",!t.isImmutableIncludeDays),Ee.Cb(8),Ee.pc("ngIf",0!==t.roomPlanListLength),Ee.Cb(1),Ee.pc("ngForOf",t.roomPlanList),Ee.Cb(3),Ee.pc("ngIf",0!==t.promotionPlanListLength),Ee.Cb(1),Ee.pc("ngForOf",t.promotionPlanList),Ee.Cb(2),Ee.pc("ngIf",t.isGrossContract),Ee.Cb(2),Ee.pc("ngIf",t.isNetContract))},directives:[i.B,i.s,i.k,$e.a,i.l,a.o,i.c,i.r,i.i,a.n,i.e,Po.a,Co.a,go.a,He.a,i.u,a.l,yo,ro],styles:['.page-item-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.ul-rate-detail[_ngcontent-%COMP%]{display:flex;color:#ff682c;font-size:12px}.ul-rate-detail[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:not(:last-child):after{content:"|";color:#262626;margin:0 12px}.title[_ngcontent-%COMP%]{white-space:break-spaces}textarea[_ngcontent-%COMP%]:-moz-read-only{background-color:#f5f5f5}textarea[_ngcontent-%COMP%]:read-only{background-color:#f5f5f5}'],changeDetection:0}),jo),$o=n("pybq"),qo={ROOM_TYPE:0,RATE_PLAN:1,PROMOTION_PLAN:2},wo=((Yo=_createClass((function e(t){var n=this;_classCallCheck(this,e),this.fb=t,this.generateStopOrStartSellingPutForm=function(){return n.fb.group({hotelContractSeq:[null,[i.z.required]],stopPeriod:n.fb.group({periods:n.fb.array([]),includeDates:[],excludeDates:[]}),roomTypePlans:n.fb.array([]),__planTypeSelectControl:[qo.ROOM_TYPE]})},this.initStopOrStartSellingPutFormData=function(){return{hotelContractSeq:null,roomTypePlans:null,stopPeriod:null}},this.generatePlanTypeGroup=function(){return n.fb.group({vendorRoomTypeSeq:[null,[i.z.required]],vendorRoomPlanSeq:[null],salesStopYn:[null,[i.z.required]],roomTypeNameEn:[null],roomPlanNameEn:[null],planPromotionName:[null]})},this.initPlanTypeGroup=function(){return{vendorRoomTypeSeq:null,vendorRoomPlanSeq:null,salesStopYn:null}},this.generatePeriodGroup=function(){return n.fb.group({appliedFromDate:[null],appliedToDate:[null],appliedMonYn:[!0],appliedTueYn:[!0],appliedWedYn:[!0],appliedThuYn:[!0],appliedFriYn:[!0],appliedSatYn:[!0],appliedSunYn:[!0]})}}))).\u0275fac=function(e){return new(e||Yo)(Ee.bc(i.f))},Yo.\u0275prov=Ee.Mb({token:Yo,factory:Yo.\u0275fac,providedIn:"root"}),Yo),Ho=n("Onn4"),Uo=function(e){return["stopPeriod","periods",e]},Go=function(){return{standalone:!0}},Bo=function(e,t){return{"fa-plus":e,"fa-minus":t}};function Xo(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"div",35),Ee.Ub(1,36),Ee.Wb(2,"div",37),Ee.Rb(3,"mat-datepicker-toggle",38),Ee.Rb(4,"input",39),Ee.Rb(5,"mat-datepicker",null,40),Ee.Vb(),Ee.Wb(7,"div",41),Ee.Pc(8,"~"),Ee.Vb(),Ee.Wb(9,"div",42),Ee.Rb(10,"mat-datepicker-toggle",38),Ee.Rb(11,"input",43),Ee.Rb(12,"mat-datepicker",null,44),Ee.Vb(),Ee.Wb(14,"app-checkbox",45),Ee.fc("onChange",(function(e){Ee.Fc(n);var o=t.index;return Ee.hc(2).onDayCheckAll(e,o)})),Ee.Vb(),Ee.Rb(15,"app-checkbox",46),Ee.Rb(16,"app-checkbox",47),Ee.Rb(17,"app-checkbox",48),Ee.Rb(18,"app-checkbox",49),Ee.Rb(19,"app-checkbox",50),Ee.Rb(20,"app-checkbox",51),Ee.Rb(21,"app-checkbox",52),Ee.Wb(22,"button",53),Ee.fc("click",(function(){Ee.Fc(n);var e=t.index;return Ee.hc(2).addRemovePeriod(e)})),Ee.Rb(23,"i",54),Ee.Vb(),Ee.Tb(),Ee.Vb()}if(2&e){var o=t.index,a=Ee.Ec(6),i=Ee.Ec(13),r=Ee.hc(2);Ee.Cb(1),Ee.qc("formGroupName",o),Ee.Cb(1),Ee.Gb("valid-error",r.checkIsInvalid(Ee.uc(12,Uo,o))),Ee.Cb(1),Ee.pc("for",a),Ee.Cb(1),Ee.pc("matDatepicker",a),Ee.Cb(5),Ee.Gb("valid-error",r.checkIsInvalid(Ee.uc(14,Uo,o))),Ee.Cb(1),Ee.pc("for",i),Ee.Cb(1),Ee.pc("matDatepicker",i),Ee.Cb(3),Ee.pc("ngModel",r.isAllDayCheckedByItem(o))("ngModelOptions",Ee.tc(16,Go)),Ee.Cb(9),Ee.pc("ngClass",Ee.vc(17,Bo,0==o,o>0))}}function zo(e,t){if(1&e&&(Ee.Wb(0,"tr"),Ee.Wb(1,"th",10),Ee.Pc(2,"Period"),Ee.Vb(),Ee.Wb(3,"td"),Ee.Ub(4,33),Ee.Nc(5,Xo,24,20,"div",34),Ee.Tb(),Ee.Vb(),Ee.Vb()),2&e){var n=Ee.hc();Ee.Cb(5),Ee.pc("ngForOf",null==n.periodArray?null:n.periodArray.controls)}}function Qo(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"button",55),Ee.fc("click",(function(){return Ee.Fc(n),Ee.hc().showCalendar("include")})),Ee.Pc(1," Select Date "),Ee.Vb()}}function Ko(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"button",56),Ee.fc("click",(function(){return Ee.Fc(n),Ee.hc().resetIncludeDates()})),Ee.Pc(1," Reset Date "),Ee.Vb()}}function Jo(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"tr"),Ee.Wb(1,"th",10),Ee.Pc(2," Exclude Days "),Ee.Wb(3,"button",55),Ee.fc("click",(function(){return Ee.Fc(n),Ee.hc().showCalendar("exclude")})),Ee.Pc(4," Select Date "),Ee.Vb(),Ee.Wb(5,"button",57),Ee.fc("click",(function(){return Ee.Fc(n),Ee.hc().resetExcludeDates()})),Ee.Pc(6," Reset Date "),Ee.Vb(),Ee.Vb(),Ee.Wb(7,"td"),Ee.Wb(8,"div",13),Ee.Rb(9,"textarea",58),Ee.Vb(),Ee.Vb(),Ee.Vb()}}function Zo(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"app-checkbox",59),Ee.fc("onChange",(function(e){return Ee.Fc(n),Ee.hc().checkAllPlanEventHandler(e)})),Ee.Vb()}if(2&e){var o=Ee.hc();Ee.pc("value",o.isAllPlanChecked)("disabled",o.isImmutableIncludeDays)}}function ea(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"li"),Ee.Wb(1,"app-checkbox",60),Ee.fc("ngModelChange",(function(e){return Ee.Fc(n),Ee.hc(2).checkedPlanList=e}))("onChange",(function(e){Ee.Fc(n);var o=t.$implicit;return Ee.hc(2).checkPlanItemEventHandler(e,o)})),Ee.Vb(),Ee.Vb()}if(2&e){var o=t.$implicit,a=Ee.hc(2);Ee.Cb(1),Ee.pc("ngModel",a.checkedPlanList)("value",o.vendorRoomTypeSeq)("label",a.showCheckBoxLabel(o))("ngModelOptions",Ee.tc(5,Go))("disabled",a.isImmutableIncludeDays)}}function ta(e,t){if(1&e&&(Ee.Ub(0),Ee.Nc(1,ea,2,6,"li",28),Ee.Tb()),2&e){var n=Ee.hc();Ee.Cb(1),Ee.pc("ngForOf",n.roomTypeList)}}function na(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"li"),Ee.Wb(1,"app-checkbox",60),Ee.fc("ngModelChange",(function(e){return Ee.Fc(n),Ee.hc(2).checkedPlanList=e}))("onChange",(function(e){Ee.Fc(n);var o=t.$implicit;return Ee.hc(2).checkPlanItemEventHandler(e,o)})),Ee.Vb(),Ee.Vb()}if(2&e){var o=t.$implicit,a=Ee.hc(2);Ee.Cb(1),Ee.pc("ngModel",a.checkedPlanList)("value",o.vendorRoomPlanSeq)("label",a.showCheckBoxLabel(o))("ngModelOptions",Ee.tc(5,Go))("disabled",a.isImmutableIncludeDays)}}function oa(e,t){if(1&e&&(Ee.Ub(0),Ee.Nc(1,na,2,6,"li",28),Ee.Tb()),2&e){var n=Ee.hc();Ee.Cb(1),Ee.pc("ngForOf",n.ratePlanList)}}function aa(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"li"),Ee.Wb(1,"app-checkbox",60),Ee.fc("ngModelChange",(function(e){return Ee.Fc(n),Ee.hc(2).checkedPlanList=e}))("onChange",(function(e){Ee.Fc(n);var o=t.$implicit;return Ee.hc(2).checkPlanItemEventHandler(e,o)})),Ee.Vb(),Ee.Vb()}if(2&e){var o=t.$implicit,a=Ee.hc(2);Ee.Cb(1),Ee.pc("ngModel",a.checkedPlanList)("value",o.vendorRoomPlanSeq)("label",a.showCheckBoxLabel(o))("ngModelOptions",Ee.tc(5,Go))("disabled",a.isImmutableIncludeDays)}}function ia(e,t){if(1&e&&(Ee.Ub(0),Ee.Nc(1,aa,2,6,"li",28),Ee.Tb()),2&e){var n=Ee.hc();Ee.Cb(1),Ee.pc("ngForOf",n.promotionPlanList)}}function ra(e,t){if(1&e&&(Ee.Wb(0,"tr"),Ee.Ub(1,36),Ee.Wb(2,"td"),Ee.Wb(3,"div",35),Ee.Pc(4),Ee.Vb(),Ee.Vb(),Ee.Wb(5,"td"),Ee.Wb(6,"div",35),Ee.Rb(7,"app-radio",61),Ee.Rb(8,"app-radio",62),Ee.Vb(),Ee.Vb(),Ee.Tb(),Ee.Vb()),2&e){var n=t.$implicit,o=t.index,a=Ee.hc();Ee.Cb(1),Ee.qc("formGroupName",o),Ee.Cb(3),Ee.Rc(" ",a.showCheckBoxLabel(n.value)," "),Ee.Cb(3),Ee.pc("name","salesStopYn"+o)("value",!0)("checked",n.value.salesStopYn),Ee.Cb(1),Ee.pc("name","salesStopYn"+o)("value",!1)("checked",!n.value.salesStopYn)}}function la(e,t){1&e&&(Ee.Wb(0,"p",63),Ee.Pc(1," No selected item. "),Ee.Vb())}var ca,sa=((ca=function(){function e(t,n,o){_classCallCheck(this,e),this._dataService=t,this.alertService=n,this.formService=o,this.isImmutableIncludeDays=!1,this.openCalendarEvent=new Ee.n,this.submitEvent=new Ee.n,this.closeEvent=new Ee.n,this.planTypeSelectOptionList=[{label:"Room Type",value:qo.ROOM_TYPE},{label:"Rate Plan",value:qo.RATE_PLAN}],this.roomTypeList=[],this.ratePlanList=[],this.promotionPlanList=[],this.checkedPlanList=[],this.isDisableTreeListControl=!1,this._PLAN_TYPE=qo,this._checkValid=!1,this._unsubscribe$=new Se.a,this.upsertForm=this._dataService.generateStopOrStartSellingPutForm()}return _createClass(e,[{key:"includeDays",set:function(e){this.upsertForm.get("stopPeriod").get("includeDates").setValue(e||[])}},{key:"excludeDays",set:function(e){var t=this;if(e){var n=this.upsertForm.get("stopPeriod").get("includeDates").value,o=e.filter((function(e){return!(null==n?void 0:n.includes(e))||(t.alertService.alert("Include date and Exclude date cannot be overlapped"),!1)}));this.upsertForm.get("stopPeriod").get("excludeDates").setValue(o)}else this.upsertForm.get("stopPeriod").get("excludeDates").setValue([])}},{key:"planListByTypeForStopSaleDetail",set:function(e){this.roomTypeList=(null==e?void 0:e.roomTypeList)||[],this.ratePlanList=(null==e?void 0:e.ratePlanList)||[],this.promotionPlanList=(null==e?void 0:e.promotionPlanList)||[]}},{key:"isAllPlanChecked",get:function(){switch(this.selectedPlanType){case qo.ROOM_TYPE:return this.checkedPlanList.length===this.roomTypeList.length;case qo.RATE_PLAN:return this.checkedPlanList.length===this.ratePlanList.length;case qo.PROMOTION_PLAN:return this.checkedPlanList.length===this.promotionPlanList.length;default:console.error("Invalid Plan Type")}return!1}},{key:"selectedPlanType",get:function(){return this.upsertForm.get("__planTypeSelectControl").value}},{key:"periodArray",get:function(){return this.upsertForm.get("stopPeriod").get("periods")}},{key:"planTypeArray",get:function(){return this.upsertForm.get("roomTypePlans")}},{key:"periodGroup",value:function(e){return this.periodArray.at(e)}},{key:"planTypeGroup",value:function(e){return this.planTypeArray.at(e)}},{key:"isAllDayCheckedByItem",value:function(e){return!0===this.periodArray.at(e).get("appliedMonYn").value&&!0===this.periodArray.at(e).get("appliedTueYn").value&&!0===this.periodArray.at(e).get("appliedWedYn").value&&!0===this.periodArray.at(e).get("appliedThuYn").value&&!0===this.periodArray.at(e).get("appliedFriYn").value&&!0===this.periodArray.at(e).get("appliedSatYn").value&&!0===this.periodArray.at(e).get("appliedSunYn").value}},{key:"ngOnInit",value:function(){var e,t,n,o,a,i;if(this._initSubscription(),this.upsertForm.get("hotelContractSeq").patchValue(this.hotelContractSeq),this.isImmutableIncludeDays){var r,l,c=this._dataService.generatePlanTypeGroup();if(null===(e=this.roomTypeList)||void 0===e?void 0:e[0])r=this.roomTypeList[0],l=this._PLAN_TYPE.ROOM_TYPE,this.roomTypeList=[r];else if(null===(t=this.ratePlanList)||void 0===t?void 0:t[0])r=this.ratePlanList[0],l=this._PLAN_TYPE.RATE_PLAN,this.ratePlanList=[r];else{if(!(null===(n=this.promotionPlanList)||void 0===n?void 0:n[0]))return console.error("planListByTypeForStopSaleDetail is empty"),r=null,void(l=null);r=this.promotionPlanList[0],l=this._PLAN_TYPE.PROMOTION_PLAN,this.promotionPlanList=[r]}this.upsertForm.get("__planTypeSelectControl").patchValue(l),this.upsertForm.get("__planTypeSelectControl").disable();var s=null===(o=this.checkedDateInfo[0])||void 0===o?void 0:o.rooms[0],u=null===(a=this.checkedDateInfo[0])||void 0===a?void 0:a.plans[0];this.upsertForm.get("stopPeriod").get("includeDates").setValue((null==u?void 0:u.dates)||(null==s?void 0:s.dates)),c.patchValue(r),this.planTypeArray.push(c),this.checkedPlanList.push(null!==(i=null==u?void 0:u.planId)&&void 0!==i?i:null==s?void 0:s.roomId)}else{var p=this._dataService.generatePeriodGroup();this.periodArray.push(p)}}},{key:"ngOnDestroy",value:function(){this._unsubscribe$.next(),this._unsubscribe$.complete()}},{key:"onSubmit",value:function(){var e=this;if(this._v_isDateConditionFilled()||this.alertService.alert("Please fill the date condition."),this.upsertForm.invalid||!this._v_isDateConditionFilled())return this._checkValid=!0,void Object.keys(this.upsertForm.controls).forEach((function(t){e.upsertForm.get(t).invalid&&console.error(t+" is invalid.")}));var t=this.upsertForm.getRawValue(),n=this._dataService.initStopOrStartSellingPutFormData();t=Te.pick(t,Object.keys(n));var o=this._dataService.initPlanTypeGroup();t.roomTypePlans=t.roomTypePlans.map((function(e){return Te.pick(e,Object.keys(o))}));var a=t;this.formService.cleanUp(a),this.submitEvent.emit(a)}},{key:"onClose",value:function(){this.closeEvent.emit()}},{key:"checkIsInvalid",value:function(e){return this._checkValid&&this.upsertForm.get(e)&&this.upsertForm.get(e).invalid}},{key:"addRemovePeriod",value:function(e){e?this.removePeriod(e):this.periodArray.push(this._dataService.generatePeriodGroup())}},{key:"removePeriod",value:function(e){this.periodArray.removeAt(e)}},{key:"checkPlanItemEventHandler",value:function(e,t){e?this._addPlanItemToPlanTypeArray(t):this._removePlanItemFromPlanTypeArray(t)}},{key:"checkAllPlanEventHandler",value:function(e){var t=this,n=this.selectedPlanType;switch(n){case this._PLAN_TYPE.ROOM_TYPE:this.checkedPlanList=!0===e?Te.map(this.roomTypeList,"vendorRoomTypeSeq"):[];break;case this._PLAN_TYPE.RATE_PLAN:this.checkedPlanList=!0===e?Te.map(this.ratePlanList,"vendorRoomPlanSeq"):[];break;case this._PLAN_TYPE.PROMOTION_PLAN:this.checkedPlanList=!0===e?Te.map(this.promotionPlanList,"vendorRoomPlanSeq"):[];break;default:console.error("Invalid plan type")}if(!0===e)switch(n){case this._PLAN_TYPE.ROOM_TYPE:this.roomTypeList.forEach((function(e){return t._addPlanItemToPlanTypeArray(e)}));break;case this._PLAN_TYPE.RATE_PLAN:this.ratePlanList.forEach((function(e){return t._addPlanItemToPlanTypeArray(e)}));break;case this._PLAN_TYPE.PROMOTION_PLAN:this.promotionPlanList.forEach((function(e){return t._addPlanItemToPlanTypeArray(e)}));break;default:console.error("Invalid plan type")}else this.planTypeArray.clear()}},{key:"onDayCheckAll",value:function(e,t){var n=this.periodGroup(t);n.get("appliedMonYn").patchValue(e),n.get("appliedTueYn").patchValue(e),n.get("appliedWedYn").patchValue(e),n.get("appliedThuYn").patchValue(e),n.get("appliedFriYn").patchValue(e),n.get("appliedSatYn").patchValue(e),n.get("appliedSunYn").patchValue(e)}},{key:"showCalendar",value:function(e){if("exclude"===e){if(!this.periodDateCheck())return void this.alertService.alert("Input period date first.");var t=this.getPeriodMinDate(),n=We(t,"YYYY-MM-DD").year(),o=We(t,"YYYY-MM-DD").month()+1,a=[];this.periodArray.value.forEach((function(e){a.push({firstDate:e.appliedFromDate,lastDate:e.appliedToDate})})),this.openCalendarEvent.emit({type:e,isPreview:!1,minDate:{year:n,month:o},validDateRange:a})}else this.openCalendarEvent.emit({type:e,isPreview:!1,validDateRange:null})}},{key:"getPeriodMinDate",value:function(){var e=this.periodArray.getRawValue();return Te.min(Te.map(e,"appliedFromDate"))}},{key:"periodDateCheck",value:function(){var e=this.periodArray.value,t=Te.map(e,"appliedFromDate"),n=Te.map(e,"appliedToDate");return Te.every(t,Boolean)&&Te.every(n,Boolean)}},{key:"showCheckBoxLabel",value:function(e){switch(this.selectedPlanType){case this._PLAN_TYPE.ROOM_TYPE:return"[".concat(e.vendorRoomTypeSeq,"] ").concat(e.roomTypeNameEn);case this._PLAN_TYPE.RATE_PLAN:return"[".concat(e.vendorRoomPlanSeq,"] ").concat(e.roomTypeNameEn," - ").concat(e.roomPlanNameEn);case this._PLAN_TYPE.PROMOTION_PLAN:return"".concat(e.planPromotionName);default:return console.error("Invalid plan type"),"PLAN TYPE ERROR"}}},{key:"resetIncludeDates",value:function(){this.upsertForm.get("stopPeriod").get("includeDates").setValue([])}},{key:"resetExcludeDates",value:function(){this.upsertForm.get("stopPeriod").get("excludeDates").setValue([])}},{key:"_initSubscription",value:function(){var e=this;this.upsertForm.get("__planTypeSelectControl").valueChanges.pipe(Object(Oe.a)(this._unsubscribe$),Object(Bn.a)()).subscribe((function(t){e.checkedPlanList=[],e.planTypeArray.clear()}))}},{key:"_addPlanItemToPlanTypeArray",value:function(e){var t=this._dataService.generatePlanTypeGroup();t.patchValue(e),this.planTypeArray.push(t)}},{key:"_removePlanItemFromPlanTypeArray",value:function(e){var t=this._findIndexInPlanTypeArray(e);-1!==t?this.planTypeArray.removeAt(t):console.error("Cannot find plan item in plan type array",this.planTypeArray.value,e)}},{key:"_findIndexInPlanTypeArray",value:function(e){var t=this.planTypeArray.value;switch(this.selectedPlanType){case this._PLAN_TYPE.ROOM_TYPE:return Te.findIndex(t,{vendorRoomTypeSeq:e.vendorRoomTypeSeq});case this._PLAN_TYPE.RATE_PLAN:case this._PLAN_TYPE.PROMOTION_PLAN:return Te.findIndex(t,{vendorRoomPlanSeq:e.vendorRoomPlanSeq});default:return console.error("Invalid plan type"),-1}}},{key:"_v_isDateConditionFilled",value:function(){var e,t=this.upsertForm.controls.stopPeriod.controls.includeDates,n=this._v_isPeriodArrayFilled(),o=(null===(e=t.value)||void 0===e?void 0:e.length)>0&&t.valid;return n||o}},{key:"_v_isPeriodArrayFilled",value:function(){var e=this.periodArray.value;return!!((null==e?void 0:e.length)>0&&this.periodArray.valid)&&(!(1!==(null==e?void 0:e.length)||!e[0].appliedFromDate||!e[0].appliedToDate)||Te.every(e,(function(e){return e.appliedFromDate&&e.appliedToDate})))}}]),e}()).\u0275fac=function(e){return new(e||ca)(Ee.Qb(wo),Ee.Qb(Qe.a),Ee.Qb(Ye.a))},ca.\u0275cmp=Ee.Kb({type:ca,selectors:[["app-stop-or-start-selling-detail"]],inputs:{checkedDateInfo:"checkedDateInfo",isImmutableIncludeDays:"isImmutableIncludeDays",hotelSimpleInfo:"hotelSimpleInfo",hotelContractSeq:"hotelContractSeq",includeDays:"includeDays",excludeDays:"excludeDays",planListByTypeForStopSaleDetail:"planListByTypeForStopSaleDetail"},outputs:{openCalendarEvent:"openCalendarEvent",submitEvent:"submitEvent",closeEvent:"closeEvent"},decls:71,vars:17,consts:[[1,"main-contents-summary-inner","mb20"],[1,"font-size-lg","font-weight-bold"],[3,"formGroup","connectForm"],[1,"promotion-rate"],[1,"page-item"],[1,"page-item-header"],[1,"table","table-bordered"],["width","130px"],["formGroupName","stopPeriod"],[4,"ngIf"],["scope","row",1,"th-bg"],["type","button","class","btn btn-light sm mt10 full",3,"click",4,"ngIf"],["type","button","class","btn btn-secondary sm mt5 mb5 full",3,"click",4,"ngIf"],[1,"textarea"],["formControlName","includeDates","cols","30","rows","3","readonly",""],[1,"page-item-header",2,"display","flex","justify-content","space-between","align-items","center"],[1,"sm","line","select-box"],["formControlName","__planTypeSelectControl",3,"options","useAllOptionYn"],[1,"item-box"],["label","All","binary","true",3,"value","disabled","onChange",4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"fitContent","table","table-bordered"],[1,"width100"],["width","60%"],["width","20%"],["scope","col",1,"align-c"],["formArrayName","roomTypePlans"],[4,"ngFor","ngForOf"],["style","text-align: center; font-size: 13px",4,"ngIf"],[1,"button-area","align-r","mt10"],[1,"btn","btn-secondary","sm",3,"click"],[1,"btn","btn-light","sm",3,"click"],["formArrayName","periods"],["class","form-group",4,"ngFor","ngForOf"],[1,"form-group"],[3,"formGroupName"],[1,"input","calendar","d-inline-flex","flex-fill"],[3,"for"],["type","text","placeholder","YYYY-MM-DD","formControlName","appliedFromDate",3,"matDatepicker"],["myPickerFrom",""],[1,"dash"],[1,"input","calendar","d-inline-flex","flex-fill","mr20"],["type","text","placeholder","YYYY-MM-DD","formControlName","appliedToDate",3,"matDatepicker"],["myPickerTo",""],["binary","true","label","All",3,"ngModel","ngModelOptions","onChange"],["formControlName","appliedMonYn","binary","true","label","Mon"],["formControlName","appliedTueYn","binary","true","label","Tue"],["formControlName","appliedWedYn","binary","true","label","Wed"],["formControlName","appliedThuYn","binary","true","label","Thu"],["formControlName","appliedFriYn","binary","true","label","Fri"],["formControlName","appliedSatYn","binary","true","label","Sat"],["formControlName","appliedSunYn","binary","true","label","Sun"],["type","button",1,"btn","btn-outline-secondary","btn-icon-only","xs","ml10",3,"click"],[1,"fas",3,"ngClass"],["type","button",1,"btn","btn-light","sm","mt10","full",3,"click"],["type","button",1,"btn","btn-secondary","sm","mt5","mb5","full",3,"click"],["type","button",1,"btn","btn","btn-secondary","sm","mt5","mb5","full",3,"click"],["formControlName","excludeDates","cols","30","rows","3","readonly",""],["label","All","binary","true",3,"value","disabled","onChange"],[3,"ngModel","value","label","ngModelOptions","disabled","ngModelChange","onChange"],["formControlName","salesStopYn","label","Stop",3,"name","value","checked"],["formControlName","salesStopYn","label","Sell",3,"name","value","checked"],[2,"text-align","center","font-size","13px"]],template:function(e,t){1&e&&(Ee.Wb(0,"div",0),Ee.Wb(1,"p",1),Ee.Pc(2),Ee.Vb(),Ee.Vb(),Ee.Wb(3,"form",2),Ee.Wb(4,"div",3),Ee.Wb(5,"div",4),Ee.Wb(6,"div",5),Ee.Wb(7,"strong"),Ee.Wb(8,"sup"),Ee.Pc(9,"Date Condition"),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Wb(10,"div",6),Ee.Wb(11,"table"),Ee.Wb(12,"caption"),Ee.Pc(13," Date Condition "),Ee.Vb(),Ee.Wb(14,"colgroup"),Ee.Rb(15,"col",7),Ee.Rb(16,"col"),Ee.Vb(),Ee.Wb(17,"tbody",8),Ee.Nc(18,zo,6,1,"tr",9),Ee.Wb(19,"tr"),Ee.Wb(20,"th",10),Ee.Pc(21," Include Days "),Ee.Nc(22,Qo,2,0,"button",11),Ee.Nc(23,Ko,2,0,"button",12),Ee.Vb(),Ee.Wb(24,"td"),Ee.Wb(25,"div",13),Ee.Rb(26,"textarea",14),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Nc(27,Jo,10,0,"tr",9),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Wb(28,"div",4),Ee.Wb(29,"div",15),Ee.Wb(30,"strong"),Ee.Wb(31,"sup"),Ee.Pc(32,"Select Room Type & Plan"),Ee.Vb(),Ee.Vb(),Ee.Wb(33,"div",16),Ee.Rb(34,"app-selectbox",17),Ee.Vb(),Ee.Vb(),Ee.Wb(35,"div",18),Ee.Wb(36,"ul"),Ee.Wb(37,"li"),Ee.Nc(38,Zo,1,2,"app-checkbox",19),Ee.Vb(),Ee.Ub(39,20),Ee.Nc(40,ta,2,1,"ng-container",21),Ee.Nc(41,oa,2,1,"ng-container",21),Ee.Nc(42,ia,2,1,"ng-container",21),Ee.Tb(),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Wb(43,"div",4),Ee.Wb(44,"div",5),Ee.Wb(45,"strong"),Ee.Wb(46,"sup"),Ee.Pc(47,"Setting for Stop or Sell"),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Wb(48,"div",22),Ee.Wb(49,"table",23),Ee.Wb(50,"caption"),Ee.Pc(51," Detail option "),Ee.Vb(),Ee.Wb(52,"colgroup"),Ee.Rb(53,"col",24),Ee.Rb(54,"col",25),Ee.Vb(),Ee.Wb(55,"thead"),Ee.Wb(56,"tr"),Ee.Wb(57,"th",26),Ee.Pc(58,"Room & Plan Type"),Ee.Vb(),Ee.Wb(59,"th",26),Ee.Wb(60,"sup"),Ee.Pc(61,"Sales Stop Y/N"),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Wb(62,"tbody"),Ee.Ub(63,27),Ee.Nc(64,ra,9,8,"tr",28),Ee.Tb(),Ee.Vb(),Ee.Vb(),Ee.Nc(65,la,2,0,"p",29),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Wb(66,"div",30),Ee.Wb(67,"button",31),Ee.fc("click",(function(){return t.onSubmit()})),Ee.Pc(68,"Save"),Ee.Vb(),Ee.Wb(69,"button",32),Ee.fc("click",(function(){return t.onClose()})),Ee.Pc(70,"Close"),Ee.Vb(),Ee.Vb(),Ee.Vb()),2&e&&(Ee.Cb(2),Ee.Sc(" [",null==t.hotelSimpleInfo?null:t.hotelSimpleInfo.hotelCode,"] ",null==t.hotelSimpleInfo?null:t.hotelSimpleInfo.hotelNameEn," "),Ee.Cb(1),Ee.pc("formGroup",t.upsertForm)("connectForm",t.upsertFormData),Ee.Cb(15),Ee.pc("ngIf",!t.isImmutableIncludeDays),Ee.Cb(4),Ee.pc("ngIf",!t.isImmutableIncludeDays),Ee.Cb(1),Ee.pc("ngIf",!t.isImmutableIncludeDays),Ee.Cb(4),Ee.pc("ngIf",!t.isImmutableIncludeDays),Ee.Cb(7),Ee.pc("options",t.planTypeSelectOptionList)("useAllOptionYn",!1),Ee.Cb(4),Ee.pc("ngIf",!t.isImmutableIncludeDays),Ee.Cb(1),Ee.pc("ngSwitch",t.selectedPlanType),Ee.Cb(1),Ee.pc("ngSwitchCase",t._PLAN_TYPE.ROOM_TYPE),Ee.Cb(1),Ee.pc("ngSwitchCase",t._PLAN_TYPE.RATE_PLAN),Ee.Cb(1),Ee.pc("ngSwitchCase",t._PLAN_TYPE.PROMOTION_PLAN),Ee.Cb(22),Ee.pc("ngForOf",null==t.planTypeArray?null:t.planTypeArray.controls),Ee.Cb(1),Ee.pc("ngIf",t.planTypeArray.value.length<1))},directives:[i.B,i.s,i.k,$e.a,i.l,a.o,i.c,i.r,i.i,we.a,a.q,a.r,i.e,a.n,Po.a,Co.a,go.a,He.a,i.u,a.l,Ho.a],styles:["textarea[_ngcontent-%COMP%]:-moz-read-only{background-color:#f5f5f5}textarea[_ngcontent-%COMP%]:read-only{background-color:#f5f5f5}.planCheckbox[_ngcontent-%COMP%]{margin-left:30px}"],changeDetection:0}),ca),ua=n("asRa"),pa=n("EfGc");function da(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"app-plan-detail",15),Ee.fc("closeEvent",(function(){return Ee.Fc(n),Ee.hc().closePlanDetailPopupHandler()})),Ee.Vb()}if(2&e){var o=Ee.hc();Ee.pc("selectedHotelSimple",o.selectedHotelSimple)("vendorRoomPlanSeq",o.clickedPlanSeq)}}function ma(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"app-room-detail",16),Ee.fc("closeEvent",(function(){return Ee.Fc(n),Ee.hc().closeRoomDetailPopupHandler()})),Ee.Vb()}if(2&e){var o=Ee.hc();Ee.pc("selectedHotelSimple",o.selectedHotelSimple)("vendorRoomTypeSeq",o.clickedVendorRoomTypeSeq)}}function ba(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"app-rate-detail",17),Ee.fc("openCalendarEvent",(function(e){return Ee.Fc(n),Ee.hc().openCalendarDetailPopupHandler(e)}))("submitEvent",(function(e){return Ee.Fc(n),Ee.hc().saveRateHandler(e)}))("closeEvent",(function(){return Ee.Fc(n),Ee.hc().closeRateDetailPopupHandler()})),Ee.Vb()}if(2&e){var o=Ee.hc();Ee.pc("hotelProfile",o.selectedHotelSimple)("promotionCheckedDateInfo",o.promotionCheckedDateInfo)("isImmutableIncludeDays",o.isDetail)("isUpdateModal",o.isDetail)("planList",o.planList)("checkedDateInfo",o.checkedDateInfo)("includeDays",o.selectedIncludeDays)("excludeDays",o.selectedExcludeDays)}}function ha(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"app-allotment-detail",18),Ee.fc("openCalendarEvent",(function(e){return Ee.Fc(n),Ee.hc().openCalendarDetailPopupHandler(e)}))("submitEvent",(function(e){return Ee.Fc(n),Ee.hc().saveAllotmentHandler(e)}))("closeEvent",(function(){return Ee.Fc(n),Ee.hc().closeAllotmentDetailPopupHandler()})),Ee.Vb()}if(2&e){var o=Ee.hc();Ee.pc("isImmutableIncludeDays",o.isDetail)("roomList",o.roomList)("includeDays",o.selectedIncludeDays)("excludeDays",o.selectedExcludeDays)("checkedDateInfo",o.checkedDateInfo)("contractData",o.selectedContractData)("hotelSimpleInfo",o.selectedHotelSimple)}}function fa(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"app-stop-or-start-selling-detail",19),Ee.fc("openCalendarEvent",(function(e){return Ee.Fc(n),Ee.hc().openCalendarDetailPopupHandler(e)}))("submitEvent",(function(e){return Ee.Fc(n),Ee.hc().saveStopSaleHandler(e)}))("closeEvent",(function(){return Ee.Fc(n),Ee.hc().closeStopSaleDetailPopupHandler()})),Ee.Vb()}if(2&e){var o=Ee.hc();Ee.pc("isImmutableIncludeDays",o.isDetail)("planListByTypeForStopSaleDetail",o.planListByTypeForStopSaleDetail)("checkedDateInfo",o.checkedDateInfo)("hotelContractSeq",o.hotelContractSeq)("includeDays",o.selectedIncludeDays)("excludeDays",o.selectedExcludeDays)("hotelSimpleInfo",o.selectedHotelSimple)}}function va(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"app-vendor-promotion-detail",20),Ee.fc("closeEvent",(function(){return Ee.Fc(n),Ee.hc().closePromotionDetailPopupHandler()})),Ee.ic(1,"async"),Ee.Vb()}if(2&e){var o=Ee.hc();Ee.pc("planList",o.planList)("addWithOnlyDate",o.addWithOnlyDate)("promotionTypes",Ee.jc(1,5,o.promotionTypeOptions$))("masterInfo",o.selectedPromotionData)("isResetPromotionSeq",o.isNewPromotion)}}function ya(e,t){if(1&e){var n=Ee.Xb();Ee.Wb(0,"app-calendar-view",21),Ee.fc("submitEvent",(function(e){return Ee.Fc(n),Ee.hc().selectedDateHandler(e)}))("closeEvent",(function(){return Ee.Fc(n),Ee.hc().closeCalendarHandler()})),Ee.Vb()}if(2&e){var o=Ee.hc();Ee.pc("minDate",o.minDate)("allotmentParameters",o.allotmentParameters)("isPreview",o.isCalendarPreview)("subTextDatas",o.subTextDatas)("validDateRange",o.validDateRange)}}var Pa,Ca,ga,Da,ka,Sa,Ia,Oa=((Pa=function(){function e(t,n,o,a){_classCallCheck(this,e),this.store=t,this.apiService=n,this.alertService=o,this.allotmentDataService=a,this.isNewPromotion=!1,this.unsubscribe$=new Se.a,this.promotionTypeOptions$=t.pipe(Object(l.u)(se)),this.isOpenPlanDetailPopup$=t.pipe(Object(l.u)(be)),this.isOpenRoomDetailPopup$=t.pipe(Object(l.u)(he)),this.isOpenRateDetailPopup$=t.pipe(Object(l.u)(fe)),this.isOpenAllotmentDetailPopup$=t.pipe(Object(l.u)(ve)),this.isOpenStopSaleDetailPopup$=t.pipe(Object(l.u)(ye)),this.isOpenPromotionDetailPopup$=t.pipe(Object(l.u)(Pe)),this.isOpenCalendarPopup$=t.pipe(Object(l.u)(me)),this.checkedDate$=this.store.pipe(Object(l.u)(pe)),this.searchCondition$=this.store.pipe(Object(l.u)(ce)),this.promotionCheckedDateInfo$=this.store.pipe(Object(l.u)(ke))}return _createClass(e,[{key:"ngOnInit",value:function(){this._initSubscription(),this.store.dispatch(W({condition:{masterCode:"HO022"}}))}},{key:"ngOnDestroy",value:function(){this.unsubscribe$.next(),this.unsubscribe$.complete()}},{key:"openPlanDetailPopupHandler",value:function(e){var t=e.planSeq;this.clickedPlanSeq=t,this.store.dispatch($())}},{key:"closePlanDetailPopupHandler",value:function(){this.store.dispatch(q())}},{key:"openRoomDetailPopupHandler",value:function(e){this.clickedVendorRoomTypeSeq=e.vendorRoomTypeSeq,this.store.dispatch(w())}},{key:"closeRoomDetailPopupHandler",value:function(){this.store.dispatch(H())}},{key:"openRateDetailPopupHandler",value:function(e){var t,n,o,a,i,r;if(this._checkIfNoneIsSeleceted()||this._checkIfOneContractSelected()&&this._checkIfOnlyOnePlanTypeSelected())if((null===(n=null===(t=e.roomPlanList)||void 0===t?void 0:t[0])||void 0===n?void 0:n.vendorRoomPlanSeq)||(null===(a=null===(o=e.promotionPlanList)||void 0===o?void 0:o[0])||void 0===a?void 0:a.planPromotionSeq)){var l=null===(r=null===(i=this.checkedDateInfo[0])||void 0===i?void 0:i.plans[0])||void 0===r?void 0:r.dates;this.planList=e,this.selectedIncludeDays=l,this.store.dispatch(U())}else this.alertService.alert({message:"There is no rate plan code"});else this.alertService.alert({message:"Please select dates for the rate plan code."})}},{key:"closeRateDetailPopupHandler",value:function(){this.store.dispatch(V()),this.store.dispatch(G())}},{key:"saveRateHandler",value:function(e){var t=this;this.apiService.upsertRate(e).subscribe((function(e){t.searchComponent.onSubmit(),t.alertService.alert({message:"Your data has been saved."}),t.store.dispatch(G())}))}},{key:"openAllotmentDetailPopupHandler",value:function(e){var t,n;if(this._checkIfNoneIsSeleceted()||this._checkIfOneContractSelected()&&this._checkIfOnlyOneRoomTypeSelected()){this.selectedContractData=e;var o=e.vendorRoomTypes.reduce((function(e,t){return!1===t.salesStopYn&&e.push({roomTypeNameEn:t.vendorRoomTypeNameEn,vendorRoomTypeSeq:t.vendorRoomTypeSeq}),e}),[]);this.roomList=o,this.selectedIncludeDays=null===(n=null===(t=this.checkedDateInfo[0])||void 0===t?void 0:t.rooms[0])||void 0===n?void 0:n.dates,this.store.dispatch(B())}else this.alertService.alert({message:"Please select dates for the room type code."})}},{key:"closeAllotmentDetailPopupHandler",value:function(){this.selectedContractData=null,this.store.dispatch(X())}},{key:"saveAllotmentHandler",value:function(e){var t=this;this.apiService.upsertAllotment(e).subscribe((function(e){t.searchComponent.onSubmit(),t.alertService.alert({message:"Your data has been saved."}),t.store.dispatch(X())}))}},{key:"openStopSaleDetailPopupHandler",value:function(e){this._checkIfNoneIsSeleceted()||this._checkIfOneContractSelected()&&this._checkIfOnlyOneRoomTypeSelected()||this._checkIfOneContractSelected()&&this._checkIfOnlyOnePlanTypeSelected()?(this.hotelContractSeq=e.hotelContractSeq,this.planListByTypeForStopSaleDetail=this.allotmentDataService.getPlanListByTypeData(e,this.checkedDateInfo),this.store.dispatch(z())):this.alertService.alert({message:"Please select only one room type code or plan type code."})}},{key:"closeStopSaleDetailPopupHandler",value:function(){this.store.dispatch(Q())}},{key:"saveStopSaleHandler",value:function(e){var t=this;this.apiService.upsertStopSales(e).subscribe((function(e){t.searchComponent.onSubmit(),t.alertService.alert({message:"Your data has been saved."}),t.store.dispatch(Q())}))}},{key:"openPromotionDetailPopupHandler",value:function(e){var t=this;this.planList=e.list,e.planPromotionSeq&&(this.isNewPromotion=e.isNewPromotion||!1,this.addWithOnlyDate=e.addWithOnlyDate||!1,this.apiService.getPromotion({hotelCode:this.selectedHotelSimple.hotelCode,planPromotionSeq:e.planPromotionSeq,limits:[0,1]}).subscribe((function(e){var n;1===(null===(n=null==e?void 0:e.list)||void 0===n?void 0:n.length)&&(t.selectedPromotionData=e.list[0],t.store.dispatch(K()))})))}},{key:"closePromotionDetailPopupHandler",value:function(){this.isNewPromotion=!1,this.addWithOnlyDate=!1,this.selectedPromotionData=null,this.planList=[],this.store.dispatch(J())}},{key:"savePromotionHandler",value:function(e){var t=this;this.apiService.upsertStopSales(e).subscribe((function(e){t.searchComponent.onSubmit(),t.alertService.alert({message:"Your data has been saved.",accept:function(){t.store.dispatch(J())}})}))}},{key:"openCalendarDetailPopupHandler",value:function(e){var t=e.type,n=e.isPreview,o=e.minDate,a=e.subTextDatas,i=e.validDateRange,r=e.allotmentParameters;this.selectedDateType=t,this.validDateRange=i,this.minDate=o,this.subTextDatas=a,this.allotmentParameters=r,this.isCalendarPreview=n,this.store.dispatch(Y())}},{key:"closeCalendarHandler",value:function(){this.store.dispatch(M())}},{key:"selectedDateHandler",value:function(e){"include"===this.selectedDateType?this.selectedIncludeDays=e:"exclude"===this.selectedDateType&&(this.selectedExcludeDays=e)}},{key:"rateDetailTitle",value:function(){return this.promotionCheckedDateInfo?"Promotion Rate Update":this.isDetail?"Rate Update":"Rate Create"}},{key:"_initSubscription",value:function(){var e=this;this.searchCondition$.pipe(Object(Oe.a)(this.unsubscribe$)).subscribe((function(t){e.selectedHotelSimple=t&&{hotelCode:t.hotelCode,hotelNameEn:t.hotelNameEn}})),this.checkedDate$.pipe(Object(Oe.a)(this.unsubscribe$)).subscribe((function(t){var n;e.checkedDateInfo=t,e.isDetail=(null!==(n=null==t?void 0:t.length)&&void 0!==n?n:0)>0})),this.promotionCheckedDateInfo$.pipe(Object(Oe.a)(this.unsubscribe$)).subscribe((function(t){e.promotionCheckedDateInfo=t,e.isDetail=!1===Te.isEmpty(t)})),Object(Ie.a)(this.isOpenRateDetailPopup$,this.isOpenAllotmentDetailPopup$,this.isOpenStopSaleDetailPopup$).pipe(Object(Oe.a)(this.unsubscribe$),Object(Re.a)((function(e){return!1===e}))).subscribe((function(){e.selectedIncludeDays=[],e.selectedExcludeDays=[]}))}},{key:"_checkIfNoneIsSeleceted",value:function(){return!this.checkedDateInfo.length}},{key:"_checkIfOneContractSelected",value:function(){return 1===this.checkedDateInfo.length}},{key:"_checkIfOnlyOneRoomTypeSelected",value:function(){var e,t,n,o,a=this,i=!(null===(t=null===(e=this.checkedDateInfo[0])||void 0===e?void 0:e.rooms)||void 0===t?void 0:t.find((function(e){var t;return e.roomId!==(null===(t=a.checkedDateInfo[0])||void 0===t?void 0:t.rooms[0].roomId)}))),r=null===(o=null===(n=this.checkedDateInfo[0])||void 0===n?void 0:n.plans)||void 0===o?void 0:o.length;return!0===i&&0===r}},{key:"_checkIfOnlyOnePlanTypeSelected",value:function(){var e,t,n,o,a=this,i=null===(t=null===(e=this.checkedDateInfo[0])||void 0===e?void 0:e.rooms)||void 0===t?void 0:t.length,r=!(null===(o=null===(n=this.checkedDateInfo[0])||void 0===n?void 0:n.plans)||void 0===o?void 0:o.find((function(e){var t;return e.planId!==(null===(t=a.checkedDateInfo[0])||void 0===t?void 0:t.plans[0].planId)})));return 0===i&&!0===r}}]),e}()).\u0275fac=function(e){return new(e||Pa)(Ee.Qb(l.h),Ee.Qb(Le.a),Ee.Qb(Qe.a),Ee.Qb(Ke))},Pa.\u0275cmp=Ee.Kb({type:Pa,selectors:[["app-rate-allotment"]],viewQuery:function(e,t){var n;1&e&&Ee.Xc(ze,!0),2&e&&Ee.Dc(n=Ee.gc())&&(t.searchComponent=n.first)},decls:32,vars:55,consts:[[1,"tabs-contents","tabs-main-contents"],[1,"active"],[3,"openRoomDetailEvent","openAllotmentDetailEvent","openStopSaleDetailEvent","openRateDetailEvent","openPlanDetailEvent","openPromotionDetailEvent","openCalendarDetailEvent"],["header","Hotel Plan Master","modalSize","lg",3,"visible","modal","hasScroll","visibleChange"],[3,"selectedHotelSimple","vendorRoomPlanSeq","closeEvent",4,"ngIf"],["header","Hotel Room Master","modalSize","lg",3,"visible","modal","hasScroll","visibleChange"],[3,"selectedHotelSimple","vendorRoomTypeSeq","closeEvent",4,"ngIf"],["modalContentClass","pd-all","modalSize","lg",3,"header","visible","modal","visibleChange"],[3,"hotelProfile","promotionCheckedDateInfo","isImmutableIncludeDays","isUpdateModal","planList","checkedDateInfo","includeDays","excludeDays","openCalendarEvent","submitEvent","closeEvent",4,"ngIf"],[3,"isImmutableIncludeDays","roomList","includeDays","excludeDays","checkedDateInfo","contractData","hotelSimpleInfo","openCalendarEvent","submitEvent","closeEvent",4,"ngIf"],[3,"isImmutableIncludeDays","planListByTypeForStopSaleDetail","checkedDateInfo","hotelContractSeq","includeDays","excludeDays","hotelSimpleInfo","openCalendarEvent","submitEvent","closeEvent",4,"ngIf"],["header","Vendor Promotion Detail","modalSize","lg",3,"visible","modal","hasScroll","visibleChange"],[3,"planList","addWithOnlyDate","promotionTypes","masterInfo","isResetPromotionSeq","closeEvent",4,"ngIf"],["header","Calendar","modalContentClass","pd-all","modalSize","md",3,"visible","modal","visibleChange"],[3,"minDate","allotmentParameters","isPreview","subTextDatas","validDateRange","submitEvent","closeEvent",4,"ngIf"],[3,"selectedHotelSimple","vendorRoomPlanSeq","closeEvent"],[3,"selectedHotelSimple","vendorRoomTypeSeq","closeEvent"],[3,"hotelProfile","promotionCheckedDateInfo","isImmutableIncludeDays","isUpdateModal","planList","checkedDateInfo","includeDays","excludeDays","openCalendarEvent","submitEvent","closeEvent"],[3,"isImmutableIncludeDays","roomList","includeDays","excludeDays","checkedDateInfo","contractData","hotelSimpleInfo","openCalendarEvent","submitEvent","closeEvent"],[3,"isImmutableIncludeDays","planListByTypeForStopSaleDetail","checkedDateInfo","hotelContractSeq","includeDays","excludeDays","hotelSimpleInfo","openCalendarEvent","submitEvent","closeEvent"],[3,"planList","addWithOnlyDate","promotionTypes","masterInfo","isResetPromotionSeq","closeEvent"],[3,"minDate","allotmentParameters","isPreview","subTextDatas","validDateRange","submitEvent","closeEvent"]],template:function(e,t){1&e&&(Ee.Wb(0,"div",0),Ee.Wb(1,"div",1),Ee.Rb(2,"app-search"),Ee.Wb(3,"app-calendar",2),Ee.fc("openRoomDetailEvent",(function(e){return t.openRoomDetailPopupHandler(e)}))("openAllotmentDetailEvent",(function(e){return t.openAllotmentDetailPopupHandler(e)}))("openStopSaleDetailEvent",(function(e){return t.openStopSaleDetailPopupHandler(e)}))("openRateDetailEvent",(function(e){return t.openRateDetailPopupHandler(e)}))("openPlanDetailEvent",(function(e){return t.openPlanDetailPopupHandler(e)}))("openPromotionDetailEvent",(function(e){return t.openPromotionDetailPopupHandler(e)}))("openCalendarDetailEvent",(function(e){return t.openCalendarDetailPopupHandler(e)})),Ee.Vb(),Ee.Vb(),Ee.Vb(),Ee.Wb(4,"app-dialog",3),Ee.fc("visibleChange",(function(){return t.closePlanDetailPopupHandler()})),Ee.ic(5,"async"),Ee.Nc(6,da,1,2,"app-plan-detail",4),Ee.ic(7,"async"),Ee.Vb(),Ee.Wb(8,"app-dialog",5),Ee.fc("visibleChange",(function(){return t.closeRoomDetailPopupHandler()})),Ee.ic(9,"async"),Ee.Nc(10,ma,1,2,"app-room-detail",6),Ee.ic(11,"async"),Ee.Vb(),Ee.Wb(12,"app-dialog",7),Ee.fc("visibleChange",(function(){return t.closeRateDetailPopupHandler()})),Ee.ic(13,"async"),Ee.Nc(14,ba,1,8,"app-rate-detail",8),Ee.ic(15,"async"),Ee.Vb(),Ee.Wb(16,"app-dialog",7),Ee.fc("visibleChange",(function(){return t.closeAllotmentDetailPopupHandler()})),Ee.ic(17,"async"),Ee.Nc(18,ha,1,7,"app-allotment-detail",9),Ee.ic(19,"async"),Ee.Vb(),Ee.Wb(20,"app-dialog",7),Ee.fc("visibleChange",(function(){return t.closeStopSaleDetailPopupHandler()})),Ee.ic(21,"async"),Ee.Nc(22,fa,1,7,"app-stop-or-start-selling-detail",10),Ee.ic(23,"async"),Ee.Vb(),Ee.Wb(24,"app-dialog",11),Ee.fc("visibleChange",(function(){return t.closePromotionDetailPopupHandler()})),Ee.ic(25,"async"),Ee.Nc(26,va,2,7,"app-vendor-promotion-detail",12),Ee.ic(27,"async"),Ee.Vb(),Ee.Wb(28,"app-dialog",13),Ee.fc("visibleChange",(function(){return t.closeCalendarHandler()})),Ee.ic(29,"async"),Ee.Nc(30,ya,1,5,"app-calendar-view",14),Ee.ic(31,"async"),Ee.Vb()),2&e&&(Ee.Cb(4),Ee.pc("visible",Ee.jc(5,27,t.isOpenPlanDetailPopup$))("modal",!0)("hasScroll",!1),Ee.Cb(2),Ee.pc("ngIf",Ee.jc(7,29,t.isOpenPlanDetailPopup$)),Ee.Cb(2),Ee.pc("visible",Ee.jc(9,31,t.isOpenRoomDetailPopup$))("modal",!0)("hasScroll",!1),Ee.Cb(2),Ee.pc("ngIf",Ee.jc(11,33,t.isOpenRoomDetailPopup$)),Ee.Cb(2),Ee.pc("header",t.rateDetailTitle())("visible",Ee.jc(13,35,t.isOpenRateDetailPopup$))("modal",!0),Ee.Cb(2),Ee.pc("ngIf",Ee.jc(15,37,t.isOpenRateDetailPopup$)),Ee.Cb(2),Ee.rc("header","Allotment ",t.isDetail?"Update":"Create",""),Ee.pc("visible",Ee.jc(17,39,t.isOpenAllotmentDetailPopup$))("modal",!0),Ee.Cb(2),Ee.pc("ngIf",Ee.jc(19,41,t.isOpenAllotmentDetailPopup$)),Ee.Cb(2),Ee.rc("header","Stop/Start Selling ",t.isDetail?"Update":"Create",""),Ee.pc("visible",Ee.jc(21,43,t.isOpenStopSaleDetailPopup$))("modal",!0),Ee.Cb(2),Ee.pc("ngIf",Ee.jc(23,45,t.isOpenStopSaleDetailPopup$)),Ee.Cb(2),Ee.pc("visible",Ee.jc(25,47,t.isOpenPromotionDetailPopup$))("modal",!0)("hasScroll",!1),Ee.Cb(2),Ee.pc("ngIf",Ee.jc(27,49,t.isOpenPromotionDetailPopup$)),Ee.Cb(2),Ee.pc("visible",Ee.jc(29,51,t.isOpenCalendarPopup$))("modal",!0),Ee.Cb(2),Ee.pc("ngIf",Ee.jc(31,53,t.isOpenCalendarPopup$)))},directives:[ze,$n,qn.a,a.o,wn.a,Hn.a,Mo,$o.a,sa,ua.a,pa.a],pipes:[a.b],styles:[".rateAllotmentContainer[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:relative}"],changeDetection:0}),Pa),Ra=[{path:"",component:Oa,data:{title:"Plan Master"}}],Ta=((Ca=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=Ee.Ob({type:Ca}),Ca.\u0275inj=Ee.Nb({factory:function(e){return new(e||Ca)},imports:[[D.f.forChild(Ra)],D.f]}),Ca),Va=n("vu/V"),Aa=n("VIhy"),Na=n("/0iE"),Fa=n("5fwj"),_a=n("px/L"),Ea=((ga=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=Ee.Ob({type:ga}),ga.\u0275inj=Ee.Nb({factory:function(e){return new(e||ga)},imports:[[a.c,i.m,i.w,o.a,c.m,u.a,g.a,b.a,d.a,y.a,f.a,P.a,p.a,m.a,Va.a,_a.a,C.a]]}),ga),La=n("s7Dg"),Wa=[],xa=((ka=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=Ee.Ob({type:ka}),ka.\u0275inj=Ee.Nb({factory:function(e){return new(e||ka)},imports:[[D.f.forChild(Wa)],D.f]}),ka),ja=((Da=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=Ee.Ob({type:Da}),Da.\u0275inj=Ee.Nb({factory:function(e){return new(e||Da)},imports:[[a.c,i.m,i.w,o.a,c.m,u.a,g.a,b.a,d.a,y.a,f.a,P.a,p.a,m.a,Va.a,_a.a,C.a,xa,C.a]]}),Da),Ya=n("TEiF"),Ma=n("eIep"),$a=n("lJxs"),qa=n("JIr8"),wa=n("vkgz"),Ha=n("LRne"),Ua=n("Xb6A"),Ga=((Sa=function(){function e(t,n,o,a,i){var l=this;_classCallCheck(this,e),this.actions$=t,this.service=n,this.alertService=o,this._errorService=a,this.store=i,this.loadRateAllotment$=Object(r.c)((function(){return l.actions$.pipe(Object(r.d)(k),Object(Fe.a)(500),Object(Ma.a)((function(e){var t=e.condition;return l.service.loadRateAllotment(t).pipe(Object($a.a)((function(e){return{succeedYn:!0,list:e.list}})),Object(qa.a)((function(e){return Object(Ha.a)({succeedYn:!1,error:e})})))})),Object(wa.a)((function(e){var t=e.succeedYn,n=e.list,o=e.error;if(t)l.store.dispatch(S({dataList:n}));else{var a="Data status list lookup failed. Please try again in a momentarily.",i=[I({error:a})];l._catchErr(o,a,i)}})))}),{dispatch:!1}),this.loadPromotionTypeList$=Object(r.c)((function(){return l.actions$.pipe(Object(r.d)(W),Object(Ma.a)((function(){return l.service.getPromotionType().pipe(Object($a.a)((function(e){return{succeedYn:!0,datas:e}})),Object(qa.a)((function(e){return Object(Ha.a)({succeedYn:!1,error:e})})))})),Object(wa.a)((function(e){var t=e.succeedYn,n=e.datas,o=e.error;if(t)l.store.dispatch(x({dataList:n}));else{var a="Promotion type list lookup failed. Please try again in a momentarily.",i=[j({error:a})];l._catchErr(o,a,i)}})))}),{dispatch:!1}),this.loadContractTypeCodeList$=Object(r.c)((function(){return l.actions$.pipe(Object(r.d)(_),Object(Ma.a)((function(e){var t=e.condition;return l.service.getDetailCodeList(t).pipe(Object($a.a)((function(e){return{succeedYn:!0,datas:e}})),Object(qa.a)((function(e){return Object(Ha.a)({succeedYn:!1,error:e})})))})),Object(wa.a)((function(e){var t=e.succeedYn,n=e.datas,o=e.error;if(t)l.store.dispatch(E({dataList:n}));else{var a="Contract type list lookup failed. Please try again in a momentarily.",i=[L({error:a})];l._catchErr(o,a,i)}})))}),{dispatch:!1})}return _createClass(e,[{key:"_catchErr",value:function(e,t,n){var o=this,a=this._errorService.errorHandler(e,t);Te.isNil(a)||(Te.isNil(a.accept)&&(a.accept=(null==n?void 0:n.length)>0?function(){n.forEach((function(e){o.store.dispatch(e)}))}:function(){}),this.alertService.alert(a))}}]),e}()).\u0275fac=function(e){return new(e||Sa)(Ee.bc(r.a),Ee.bc(Le.a),Ee.bc(Qe.a),Ee.bc(Ua.a),Ee.bc(l.h))},Sa.\u0275prov=Ee.Mb({token:Sa,factory:Sa.\u0275fac}),Sa),Ba=n("FGZR"),Xa=n("YH7L"),za=[Oa],Qa=[ze,$n,Fn,Dn,ln],Ka=((Ia=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=Ee.Ob({type:Ia}),Ia.\u0275inj=Ee.Nb({factory:function(e){return new(e||Ia)},imports:[[a.c,i.m,i.w,o.a,c.m,s.a,u.a,g.a,b.a,h.a,d.a,y.a,f.a,P.a,p.a,m.a,v.a,Va.a,Fa.a,La.a,C.a,Aa.a,Ea,ja,Na.a,Ta,Ba.a,Xa.a,Ya.a,l.j.forFeature("rateAllotmentShared",ee),r.b.forFeature([Ga])]]}),Ia)},pb6r:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n("fXoL"),a=n("3Pt+"),i=n("ofXK"),r=function(){return{checkbox:!0}},l={provide:a.p,useExisting:Object(o.U)((function(){return c})),multi:!0},c=function(){var e=function(){function e(t){_classCallCheck(this,e),this._changeDetectorRef=t,this.checkboxIcon="pi pi-check",this.onChange=new o.n,this.focused=!1,this.checked=!1,this.onModelChange=function(){},this.onModelTouched=function(){}}return _createClass(e,[{key:"value",get:function(){return this._value},set:function(e){this._value=e,this.binary&&(this.model=this._value),this.writeValue(this.model)}},{key:"onClick",value:function(e,t,n){e.preventDefault(),this.disabled||this.readonly||(this.checked=!this.checked,this.updateModel(),n&&t.focus())}},{key:"updateModel",value:function(){this.binary?(this.onModelChange(this.checked),this.formControl&&this.formControl.setValue(this.checked)):(this.checked?this.addValue():this.removeValue(),this.onModelChange(this.model),this.formControl&&this.formControl.setValue(this.model)),this.onChange.emit(this.checked)}},{key:"handleChange",value:function(e){this.readonly||(this.checked=e.target.checked,this.updateModel())}},{key:"isChecked",value:function(){return this.binary?this.model:this.model&&this.model.indexOf(this.value)>-1}},{key:"removeValue",value:function(){var e=this;this.model=this.model.filter((function(t){return t!==e.value}))}},{key:"addValue",value:function(){this.model=this.model?[].concat(_toConsumableArray(this.model),[this.value]):[this.value]}},{key:"onFocus",value:function(e){this.focused=!0}},{key:"onBlur",value:function(e){this.focused=!1,this.onModelTouched()}},{key:"writeValue",value:function(e){this.model=e,this.checked=this.isChecked(),this._changeDetectorRef.markForCheck()}},{key:"registerOnChange",value:function(e){this.onModelChange=e}},{key:"registerOnTouched",value:function(e){this.onModelTouched=e}},{key:"setDisabledState",value:function(e){this.disabled=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o.Qb(o.h))},e.\u0275cmp=o.Kb({type:e,selectors:[["app-checkbox"]],inputs:{name:"name",disabled:"disabled",binary:"binary",label:"label",tabindex:"tabindex",inputId:"inputId",style:"style",styleClass:"styleClass",labelStyleClass:"labelStyleClass",formControl:"formControl",checkboxIcon:"checkboxIcon",readonly:"readonly",value:"value"},outputs:{onChange:"onChange"},features:[o.Bb([l])],decls:5,vars:12,consts:[[3,"ngClass","click"],["type","checkbox",1,"checkbox-control-input",3,"name","checked","readonly","disabled","value","focus","blur","change"],["cb",""],[1,"checkbox-control-text"]],template:function(e,t){if(1&e){var n=o.Xb();o.Wb(0,"label",0),o.fc("click",(function(e){o.Fc(n);var a=o.Ec(2);return t.onClick(e,a,!0)})),o.Wb(1,"input",1,2),o.fc("focus",(function(e){return t.onFocus(e)}))("blur",(function(e){return t.onBlur(e)}))("change",(function(e){return t.handleChange(e)})),o.Vb(),o.Wb(3,"span",3),o.Pc(4),o.Vb(),o.Vb()}2&e&&(o.Eb(t.styleClass),o.pc("ngClass",o.tc(11,r)),o.Cb(1),o.pc("name",t.name)("checked",t.checked)("readonly",t.readonly)("disabled",t.disabled)("value",t.value),o.Db("id",t.inputId)("tabindex",t.tabindex),o.Cb(3),o.Qc(t.label))},directives:[i.l],encapsulation:2}),e}()},w8np:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var o=n("ofXK"),a=n("3Pt+"),i=n("WG3B"),r=n("wPo9"),l=n("7rOj"),c=n("l1P7"),s=n("v7zA"),u=n("fXoL"),p=function(){var e=_createClass((function e(){_classCallCheck(this,e)}));return e.\u0275mod=u.Ob({type:e}),e.\u0275inj=u.Nb({factory:function(t){return new(t||e)},imports:[[o.c,a.m,a.w,i.m,r.a,l.a,c.a,s.a]]}),e}()},wPo9:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n("ofXK"),a=n("3Pt+"),i=n("WG3B"),r=n("qXPF"),l=n("fXoL"),c=function(){var e=_createClass((function e(){_classCallCheck(this,e)}));return e.\u0275mod=l.Ob({type:e}),e.\u0275inj=l.Nb({factory:function(t){return new(t||e)},imports:[[o.c,a.m,a.w,i.m,r.a]]}),e}()}}]);