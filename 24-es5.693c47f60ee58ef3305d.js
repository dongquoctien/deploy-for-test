function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{EfGc:function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var a=n("fXoL"),o=n("LvDl"),i=n("wd/R"),l=n("XNiG"),r=n("2Vo4"),c=n("5To1"),u=n("kt0X"),s=n("0qeV"),b=n("ofXK"),d=n("Onn4");function h(e,t){if(1&e){var n=a.Xb();a.Wb(0,"div",14),a.Wb(1,"app-radio",15),a.fc("onClick",(function(){return a.Fc(n),a.hc().changeLocalAllotmentYn(!0)})),a.Vb(),a.Wb(2,"app-radio",16),a.fc("onClick",(function(){return a.Fc(n),a.hc().changeLocalAllotmentYn(!1)})),a.Vb(),a.Vb()}2&e&&(a.Cb(1),a.pc("checked",!0)("value",!0),a.Cb(1),a.pc("value",!1))}function p(e,t){if(1&e&&(a.Wb(0,"div",20),a.Pc(1),a.Vb()),2&e){var n=a.hc().$implicit;a.Cb(1),a.Qc(n.day)}}function m(e,t){if(1&e&&a.Sb(0,22),2&e){var n=a.hc().$implicit;a.pc("ngComponentOutlet",null==n?null:n.component)("ngComponentOutletInjector",null==n?null:n.injector)}}function f(e,t){if(1&e&&(a.Ub(0),a.Nc(1,m,1,2,"ng-container",21),a.Tb()),2&e){var n=t.$implicit,o=a.hc().$implicit;a.Cb(1),a.pc("ngIf",(null==n?null:n.date)===(null==o?null:o.date))}}function v(e,t){if(1&e&&(a.Wb(0,"div",23),a.Pc(1),a.Vb()),2&e){var n=a.hc().$implicit,o=a.hc(2);a.Cb(1),a.Rc("",o.getText(o.subTextDatas,o.leftMonth.year,o.leftMonth.month,n.day)," ")}}function y(e,t){if(1&e&&(a.Wb(0,"div",23),a.Pc(1),a.Vb()),2&e){var n=t.ngIf,o=a.hc().$implicit,i=a.hc(2);a.Cb(1),a.Rc(" ",i.getDateContents(n,i.leftMonth.year,i.leftMonth.month,o.day)," ")}}var g=function(e,t,n){return{sun:e,sat:t,on:n}};function C(e,t){if(1&e){var n=a.Xb();a.Ub(0),a.Wb(1,"td",17),a.fc("click",(function(){a.Fc(n);var e=t.$implicit;return a.hc(2).selectDay(e)})),a.Nc(2,p,2,1,"div",18),a.Nc(3,f,2,1,"ng-container",10),a.ic(4,"async"),a.Nc(5,v,2,1,"div",19),a.Nc(6,y,2,1,"div",19),a.ic(7,"async"),a.Vb(),a.Tb()}if(2&e){var o=t.$implicit,i=a.hc(2);a.Cb(1),a.Gb("unavailable",!i.selectableDay(o)),a.pc("ngClass",a.wc(11,g,1===(null==o?null:o.weekdayNo),7===(null==o?null:o.weekdayNo),null==o?null:o.selected)),a.Cb(1),a.pc("ngIf",o.day),a.Cb(1),a.pc("ngForOf",a.jc(4,7,i.dateContents$)),a.Cb(2),a.pc("ngIf",i.subTextDatas),a.Cb(1),a.pc("ngIf",a.jc(7,9,i.dateContents$))}}function V(e,t){if(1&e&&(a.Wb(0,"tr"),a.Nc(1,C,8,15,"ng-container",10),a.Vb()),2&e){var n=t.$implicit;a.Cb(1),a.pc("ngForOf",n)}}function D(e,t){if(1&e&&(a.Wb(0,"div",20),a.Pc(1),a.Vb()),2&e){var n=a.hc().$implicit;a.Cb(1),a.Qc(n.day)}}function W(e,t){if(1&e&&(a.Wb(0,"div",23),a.Pc(1),a.Vb()),2&e){var n=a.hc().$implicit,o=a.hc(2);a.Cb(1),a.Rc("",o.getText(o.subTextDatas,o.centerMonth.year,o.centerMonth.month,n.day)," ")}}function k(e,t){if(1&e&&(a.Wb(0,"div",23),a.Pc(1),a.Vb()),2&e){var n=t.ngIf,o=a.hc().$implicit,i=a.hc(2);a.Cb(1),a.Rc(" ",i.getDateContents(n,i.centerMonth.year,i.centerMonth.month,o.day)," ")}}function P(e,t){if(1&e){var n=a.Xb();a.Ub(0),a.Wb(1,"td",17),a.fc("click",(function(){a.Fc(n);var e=t.$implicit;return a.hc(2).selectDay(e)})),a.Nc(2,D,2,1,"div",18),a.Nc(3,W,2,1,"div",19),a.Nc(4,k,2,1,"div",19),a.ic(5,"async"),a.Vb(),a.Tb()}if(2&e){var o=t.$implicit,i=a.hc(2);a.Cb(1),a.Gb("unavailable",!i.selectableDay(o)),a.pc("ngClass",a.wc(8,g,1===(null==o?null:o.weekdayNo),7===(null==o?null:o.weekdayNo),null==o?null:o.selected)),a.Cb(1),a.pc("ngIf",o.day),a.Cb(1),a.pc("ngIf",i.subTextDatas),a.Cb(1),a.pc("ngIf",a.jc(5,6,i.dateContents$))}}function Y(e,t){if(1&e&&(a.Wb(0,"tr"),a.Nc(1,P,6,12,"ng-container",10),a.Vb()),2&e){var n=t.$implicit;a.Cb(1),a.pc("ngForOf",n)}}function S(e,t){if(1&e&&(a.Wb(0,"div",20),a.Pc(1),a.Vb()),2&e){var n=a.hc().$implicit;a.Cb(1),a.Qc(n.day)}}function I(e,t){if(1&e&&(a.Wb(0,"div",23),a.Pc(1),a.Vb()),2&e){var n=a.hc().$implicit,o=a.hc(2);a.Cb(1),a.Rc("",o.getText(o.subTextDatas,o.rightMonth.year,o.rightMonth.month,n.day)," ")}}function R(e,t){if(1&e&&(a.Wb(0,"div",23),a.Pc(1),a.Vb()),2&e){var n=t.ngIf,o=a.hc().$implicit,i=a.hc(2);a.Cb(1),a.Rc(" ",i.getDateContents(n,i.rightMonth.year,i.rightMonth.month,o.day)," ")}}function M(e,t){if(1&e){var n=a.Xb();a.Ub(0),a.Wb(1,"td",17),a.fc("click",(function(){a.Fc(n);var e=t.$implicit;return a.hc(2).selectDay(e)})),a.Nc(2,S,2,1,"div",18),a.Nc(3,I,2,1,"div",19),a.Nc(4,R,2,1,"div",19),a.ic(5,"async"),a.Vb(),a.Tb()}if(2&e){var o=t.$implicit,i=a.hc(2);a.Cb(1),a.Gb("unavailable",!i.selectableDay(o)),a.pc("ngClass",a.wc(8,g,1===(null==o?null:o.weekdayNo),7===(null==o?null:o.weekdayNo),null==o?null:o.selected)),a.Cb(1),a.pc("ngIf",o.day),a.Cb(1),a.pc("ngIf",i.subTextDatas),a.Cb(1),a.pc("ngIf",a.jc(5,6,i.dateContents$))}}function T(e,t){if(1&e&&(a.Wb(0,"tr"),a.Nc(1,M,6,12,"ng-container",10),a.Vb()),2&e){var n=t.$implicit;a.Cb(1),a.pc("ngForOf",n)}}function F(e,t){if(1&e){var n=a.Xb();a.Wb(0,"button",24),a.fc("click",(function(){return a.Fc(n),a.hc().onSubmit()})),a.Pc(1," Select "),a.Vb()}if(2&e){var o=a.hc();a.pc("disabled",0===o.selectedDays.length)}}var N=function(){var e=function(){function e(t,n,o){_classCallCheck(this,e),this.calendarService=t,this.store=n,this.service=o,this.submitEvent=new a.n,this.closeEvent=new a.n,this.monthName=["","January","February","March","April","May","June","July","August","September","October","November","December"],this.selectedDays=[],this.currentLeftMonth=0,this.localAllotmentYn=!0,this.unsubscribe$=new l.a,this.dateContents$=new r.a([]),this.currentLeftMonth=i().month()+1,this.currentYear=i().year()}return _createClass(e,[{key:"ngOnInit",value:function(){this.setCalendar(),this.minDate&&(this.currentYear=this.minDate.year,this.currentLeftMonth=this.minDate.month,this.setCalendar())}},{key:"ngOnChanges",value:function(e){var t,n;e.validDateRange&&(null===(t=e.validDateRange)||void 0===t?void 0:t.currentValue)&&(this.validDateRange=null===(n=e.validDateRange)||void 0===n?void 0:n.currentValue)}},{key:"ngOnDestroy",value:function(){this.unsubscribe$.next(),this.unsubscribe$.complete()}},{key:"getAllotment3Month",value:function(){var e=this,t="".concat(this.leftMonth.year).concat(String(this.leftMonth.month).padStart(2,"0"));this.service.loadAllotment3month(Object.assign({fromYearMonth:t},this.allotmentParameters)).subscribe((function(t){e.dateContents$.next(t.list)}))}},{key:"setCalendar",value:function(){var e=i([this.currentYear,this.currentLeftMonth-1]).add(1,"M"),t=i([this.currentYear,this.currentLeftMonth-1]).add(2,"M");this.leftMonth=this.calendarService.getMonth(this.currentLeftMonth,this.currentYear),this.centerMonth=this.calendarService.getMonth(e.month()+1,e.year()),this.rightMonth=this.calendarService.getMonth(t.month()+1,t.year()),this.isPreview&&!o.isNil(this.allotmentParameters)&&this.getAllotment3Month()}},{key:"onSubmit",value:function(){this.selectedDays.sort(),this.submitEvent.emit(this.selectedDays),this.closeEvent.emit()}},{key:"onClose",value:function(){this.closeEvent.emit()}},{key:"getPrev",value:function(){this.currentLeftMonth-=3,this.currentLeftMonth<=0&&(this.currentLeftMonth=12+this.currentLeftMonth,this.currentYear-=1),this.setCalendar()}},{key:"getNext",value:function(){this.currentLeftMonth+=3,this.currentLeftMonth>12&&(this.currentLeftMonth-=12,this.currentYear+=1),this.setCalendar()}},{key:"selectDay",value:function(e){if(e.selectableYn&&!this.isPreview&&this.selectableDay(e)){e.selected=!e.selected;var t="".concat(e.year,"-").concat(("0"+e.month).slice(-2),"-").concat(("0"+e.day).slice(-2));e.selected?this.selectedDays.push(t):o.remove(this.selectedDays,(function(e){return e===t}))}}},{key:"getDateContents",value:function(e,t,n,a){var o=this,i=[];1===e.length?i=e[0].allotments:2===e.length&&(i=e.find((function(e){return e.localAllotmentYn===o.localAllotmentYn})).allotments);var l=null==i?void 0:i.find((function(e){return e.appliedYear===t&&e.appliedMonth===n&&e.appliedDay===a}));return l&&"".concat(l.leftCountSum,"/").concat(l.allotmentCountSum)}},{key:"changeLocalAllotmentYn",value:function(e){this.localAllotmentYn=e}},{key:"getText",value:function(e,t,n,a){var i=o.find(e,{year:t,month:n,day:a});return null==i?void 0:i.text}},{key:"selectableDay",value:function(e){if(null==this.validDateRange)return!0;if(!e.selectableYn)return!1;var t=!1;return this.validDateRange.forEach((function(n){var a=i("".concat(e.year,"-").concat(e.month,"-").concat(e.day),"YYYY-M-D");0==t&&(t=a.isBetween(n.firstDate,n.lastDate,void 0,"[]"))})),t}}]),e}();return e.\u0275fac=function(t){return new(t||e)(a.Qb(c.a),a.Qb(u.h),a.Qb(s.a))},e.\u0275cmp=a.Kb({type:e,selectors:[["app-calendar-view"]],inputs:{isPreview:"isPreview",allotmentParameters:"allotmentParameters",minDate:"minDate",subTextDatas:"subTextDatas",validDateRange:"validDateRange"},outputs:{submitEvent:"submitEvent",closeEvent:"closeEvent"},features:[a.Ab],decls:113,vars:13,consts:[["class","form-group",4,"ngIf"],[1,"preview-calendar-wrap"],["title","\uc774\uc804\ub2ec",1,"btn-prev-month",3,"click"],["title","\ub2e4\uc74c\ub2ec",1,"btn-next-month",3,"click"],[1,"preview-calendar"],[1,"calendar-header"],[1,"calendar-body"],["scope","col",1,"sun"],["scope","col"],["scope","col",1,"sat"],[4,"ngFor","ngForOf"],[1,"button-area","align-r","mt10"],["class","btn btn-secondary sm",3,"disabled","click",4,"ngIf"],[1,"btn","btn-light","sm",3,"click"],[1,"form-group"],["name","localAllotmentYn","label","OMH",3,"checked","value","onClick"],["name","localAllotmentYn","label","CMS",3,"value","onClick"],[3,"ngClass","click"],["class","day",4,"ngIf"],["class","preview-day",4,"ngIf"],[1,"day"],[3,"ngComponentOutlet","ngComponentOutletInjector",4,"ngIf"],[3,"ngComponentOutlet","ngComponentOutletInjector"],[1,"preview-day"],[1,"btn","btn-secondary","sm",3,"disabled","click"]],template:function(e,t){1&e&&(a.Nc(0,h,3,3,"div",0),a.ic(1,"async"),a.Wb(2,"div",1),a.Wb(3,"a",2),a.fc("click",(function(){return t.getPrev()})),a.Pc(4,"\uc774\uc804\ub2ec"),a.Vb(),a.Wb(5,"a",3),a.fc("click",(function(){return t.getNext()})),a.Pc(6,"\ub2e4\uc74c\ub2ec"),a.Vb(),a.Wb(7,"div",4),a.Wb(8,"h1",5),a.Wb(9,"strong"),a.Pc(10),a.Vb(),a.Vb(),a.Wb(11,"div",6),a.Wb(12,"table"),a.Wb(13,"caption"),a.Pc(14," Calendar "),a.Vb(),a.Wb(15,"colgroup"),a.Rb(16,"col"),a.Rb(17,"col"),a.Rb(18,"col"),a.Rb(19,"col"),a.Rb(20,"col"),a.Rb(21,"col"),a.Rb(22,"col"),a.Vb(),a.Wb(23,"thead"),a.Wb(24,"tr"),a.Wb(25,"th",7),a.Pc(26,"Sun"),a.Vb(),a.Wb(27,"th",8),a.Pc(28,"Mon"),a.Vb(),a.Wb(29,"th",8),a.Pc(30,"Tue"),a.Vb(),a.Wb(31,"th",8),a.Pc(32,"Wed"),a.Vb(),a.Wb(33,"th",8),a.Pc(34,"Thu"),a.Vb(),a.Wb(35,"th",8),a.Pc(36,"Fri"),a.Vb(),a.Wb(37,"th",9),a.Pc(38,"Sat"),a.Vb(),a.Vb(),a.Vb(),a.Wb(39,"tbody"),a.Nc(40,V,2,1,"tr",10),a.Vb(),a.Vb(),a.Vb(),a.Vb(),a.Wb(41,"div",4),a.Wb(42,"h1",5),a.Wb(43,"strong"),a.Pc(44),a.Vb(),a.Vb(),a.Wb(45,"div",6),a.Wb(46,"table"),a.Wb(47,"caption"),a.Pc(48," Calendar "),a.Vb(),a.Wb(49,"colgroup"),a.Rb(50,"col"),a.Rb(51,"col"),a.Rb(52,"col"),a.Rb(53,"col"),a.Rb(54,"col"),a.Rb(55,"col"),a.Rb(56,"col"),a.Vb(),a.Wb(57,"thead"),a.Wb(58,"tr"),a.Wb(59,"th",7),a.Pc(60,"Sun"),a.Vb(),a.Wb(61,"th",8),a.Pc(62,"Mon"),a.Vb(),a.Wb(63,"th",8),a.Pc(64,"Tue"),a.Vb(),a.Wb(65,"th",8),a.Pc(66,"Wed"),a.Vb(),a.Wb(67,"th",8),a.Pc(68,"Thu"),a.Vb(),a.Wb(69,"th",8),a.Pc(70,"Fri"),a.Vb(),a.Wb(71,"th",9),a.Pc(72,"Sat"),a.Vb(),a.Vb(),a.Vb(),a.Wb(73,"tbody"),a.Nc(74,Y,2,1,"tr",10),a.Vb(),a.Vb(),a.Vb(),a.Vb(),a.Wb(75,"div",4),a.Wb(76,"h1",5),a.Wb(77,"strong"),a.Pc(78),a.Vb(),a.Vb(),a.Wb(79,"div",6),a.Wb(80,"table"),a.Wb(81,"caption"),a.Pc(82," Calendar "),a.Vb(),a.Wb(83,"colgroup"),a.Rb(84,"col"),a.Rb(85,"col"),a.Rb(86,"col"),a.Rb(87,"col"),a.Rb(88,"col"),a.Rb(89,"col"),a.Rb(90,"col"),a.Vb(),a.Wb(91,"thead"),a.Wb(92,"tr"),a.Wb(93,"th",7),a.Pc(94,"Sun"),a.Vb(),a.Wb(95,"th",8),a.Pc(96,"Mon"),a.Vb(),a.Wb(97,"th",8),a.Pc(98,"Tue"),a.Vb(),a.Wb(99,"th",8),a.Pc(100,"Wed"),a.Vb(),a.Wb(101,"th",8),a.Pc(102,"Thu"),a.Vb(),a.Wb(103,"th",8),a.Pc(104,"Fri"),a.Vb(),a.Wb(105,"th",9),a.Pc(106,"Sat"),a.Vb(),a.Vb(),a.Vb(),a.Wb(107,"tbody"),a.Nc(108,T,2,1,"tr",10),a.Vb(),a.Vb(),a.Vb(),a.Vb(),a.Vb(),a.Wb(109,"div",11),a.Nc(110,F,2,1,"button",12),a.Wb(111,"button",13),a.fc("click",(function(){return t.onClose()})),a.Pc(112,"Close"),a.Vb(),a.Vb()),2&e&&(a.pc("ngIf",a.jc(1,11,t.dateContents$).length>1),a.Cb(10),a.Sc("",t.monthName[null==t.leftMonth?null:t.leftMonth.month]," ",null==t.leftMonth?null:t.leftMonth.year,""),a.Cb(30),a.pc("ngForOf",null==t.leftMonth?null:t.leftMonth.days),a.Cb(4),a.Sc("",t.monthName[null==t.centerMonth?null:t.centerMonth.month]," ",null==t.centerMonth?null:t.centerMonth.year,""),a.Cb(30),a.pc("ngForOf",null==t.centerMonth?null:t.centerMonth.days),a.Cb(4),a.Sc("",t.monthName[null==t.rightMonth?null:t.rightMonth.month]," ",null==t.rightMonth?null:t.rightMonth.year,""),a.Cb(30),a.pc("ngForOf",null==t.rightMonth?null:t.rightMonth.days),a.Cb(2),a.pc("ngIf",!t.isPreview))},directives:[b.o,b.n,d.a,b.l,b.m],pipes:[b.b],encapsulation:2,changeDetection:0}),e}()},VIhy:function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var a,o,i=n("ofXK"),l=n("3Pt+"),r=n("pxUr"),c=n("WG3B"),u=n("wPo9"),s=n("7rOj"),b=n("l1P7"),d=n("v7zA"),h=n("7UZF"),p=n("hHe4"),m=n("1OXJ"),f=n("5hwk"),v=n("px/L"),y=n("6LsY"),g=n("kKjH"),C=n("vu/V"),V=n("tyNb"),D=n("fXoL"),W=[],k=((o=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=D.Ob({type:o}),o.\u0275inj=D.Nb({factory:function(e){return new(e||o)},imports:[[V.f.forChild(W)],V.f]}),o),P=((a=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=D.Ob({type:a}),a.\u0275inj=D.Nb({factory:function(e){return new(e||a)},imports:[[i.c,l.m,l.w,r.a,c.m,u.a,s.a,f.a,b.a,d.a,h.a,p.a,m.a,g.a,C.a,v.a,y.a,k]]}),a)},pybq:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var a,o=n("fXoL"),i=n("LvDl"),l=n("XNiG"),r=n("wd/R"),c=n.n(r),u=n("3Pt+"),s=((a=function(){function e(t){var n=this;_classCallCheck(this,e),this.fb=t,this.generateAllotmentPutForm=function(){return n.fb.group({hotelContractSeq:[null,[u.z.required]],localAllotmentYn:[!1,[u.z.required]],sellerCompCode:[0,[u.z.required]],allotmentCmsPmsCompCode:[null],allotmentPeriod:n.fb.group({periods:n.fb.array([n.generatePeriodGroups()]),includeDates:[],excludeDates:[]}),roomTypes:n.fb.array([]),dailySalesStopYn:[!1]})},this.generateRoomTypeGroups=function(){return n.fb.group({addQuantity:[null,[u.z.required]],minNights:[1,[u.z.required]],vendorRoomTypeSeq:[null,[u.z.required]],salesStopYn:[!1,[u.z.required]],roomTypeNameEn:null})},this.generatePeriodGroups=function(){return n.fb.group({appliedFromDate:[null],appliedToDate:[null],appliedMonYn:[!0],appliedTueYn:[!0],appliedWedYn:[!0],appliedThuYn:[!0],appliedFriYn:[!0],appliedSatYn:[!0],appliedSunYn:[!0]},{validators:n.compareDatesValidators("dateRangeCompare",["appliedFromDate","appliedToDate"])})}}return _createClass(e,[{key:"compareDatesValidators",value:function(e,t){return function(n){if(!n)return null;var a=n,o=t.length,l=t.map((function(e){return a.get(e).value})),r=!1;return l.forEach((function(e,t){if(!r&&t+1<o){var n=l[t+1];r=i.isNil(e)||i.isNil(n)?!i.isNil(e)||!i.isNil(n):c()(n).isBefore(c()(e))}})),r?_defineProperty({},e,!0):null}}}]),e}()).\u0275fac=function(e){return new(e||a)(o.bc(u.f))},a.\u0275prov=o.Mb({token:a,factory:a.\u0275fac,providedIn:"root"}),a),b=n("EsKh"),d=n("xDUJ"),h=n("ofXK"),p=n("Onn4"),m=n("rbKv"),f=n("kd+X"),v=n("LVFn"),y=n("pb6r"),g=n("gbCm"),C=function(e){return["allotmentPeriod","periods",e]},V=function(e,t){return{"fa-plus":e,"fa-minus":t}};function D(e,t){if(1&e){var n=o.Xb();o.Wb(0,"div",29),o.Ub(1,30),o.Wb(2,"div",31),o.Rb(3,"mat-datepicker-toggle",32),o.Rb(4,"input",33),o.Rb(5,"mat-datepicker",null,34),o.Vb(),o.Wb(7,"div",35),o.Pc(8,"~"),o.Vb(),o.Wb(9,"div",36),o.Rb(10,"mat-datepicker-toggle",32),o.Rb(11,"input",37),o.Rb(12,"mat-datepicker",null,38),o.Vb(),o.Wb(14,"app-checkbox",39),o.fc("onChange",(function(e){o.Fc(n);var a=t.index;return o.hc(2).onDayCheckAll(e,a)})),o.Vb(),o.Wb(15,"app-checkbox",40),o.fc("onChange",(function(e){return o.Fc(n),o.hc(2).onDayCheck(e)})),o.Vb(),o.Wb(16,"app-checkbox",41),o.fc("onChange",(function(e){return o.Fc(n),o.hc(2).onDayCheck(e)})),o.Vb(),o.Wb(17,"app-checkbox",42),o.fc("onChange",(function(e){return o.Fc(n),o.hc(2).onDayCheck(e)})),o.Vb(),o.Wb(18,"app-checkbox",43),o.fc("onChange",(function(e){return o.Fc(n),o.hc(2).onDayCheck(e)})),o.Vb(),o.Wb(19,"app-checkbox",44),o.fc("onChange",(function(e){return o.Fc(n),o.hc(2).onDayCheck(e)})),o.Vb(),o.Wb(20,"app-checkbox",45),o.fc("onChange",(function(e){return o.Fc(n),o.hc(2).onDayCheck(e)})),o.Vb(),o.Wb(21,"app-checkbox",46),o.fc("onChange",(function(e){return o.Fc(n),o.hc(2).onDayCheck(e)})),o.Vb(),o.Wb(22,"button",47),o.fc("click",(function(){o.Fc(n);var e=t.index;return o.hc(2).addRemovePeriod(e)})),o.Rb(23,"i",48),o.Vb(),o.Tb(),o.Vb()}if(2&e){var a=t.index,i=o.Ec(6),l=o.Ec(13),r=o.hc(2);o.Cb(1),o.qc("formGroupName",a),o.Cb(1),o.Gb("valid-error",r.checkIsInvalid(o.uc(11,C,a))),o.Cb(1),o.pc("for",i),o.Cb(1),o.pc("matDatepicker",i),o.Cb(5),o.Gb("valid-error",r.checkIsInvalid(o.uc(13,C,a))),o.Cb(1),o.pc("for",l),o.Cb(1),o.pc("matDatepicker",l),o.Cb(3),o.pc("value",r.isAllDayChecked),o.Cb(9),o.pc("ngClass",o.vc(15,V,0==a,a>0))}}function W(e,t){if(1&e&&(o.Wb(0,"tr"),o.Wb(1,"th",9),o.Pc(2,"Period"),o.Vb(),o.Wb(3,"td"),o.Ub(4,27),o.Nc(5,D,24,18,"div",28),o.Tb(),o.Vb(),o.Vb()),2&e){var n=o.hc();o.Cb(5),o.pc("ngForOf",n.periodArray.controls)}}function k(e,t){if(1&e){var n=o.Xb();o.Wb(0,"button",49),o.fc("click",(function(){return o.Fc(n),o.hc().showCalendar("include")})),o.Pc(1," Select Date "),o.Vb()}}function P(e,t){if(1&e){var n=o.Xb();o.Wb(0,"button",50),o.fc("click",(function(){return o.Fc(n),o.hc().resetIncludeDates()})),o.Pc(1," Reset Date "),o.Vb()}}function Y(e,t){if(1&e){var n=o.Xb();o.Wb(0,"tr"),o.Wb(1,"th",9),o.Pc(2," Exclude Days "),o.Wb(3,"button",49),o.fc("click",(function(){return o.Fc(n),o.hc().showCalendar("exclude")})),o.Pc(4," Select Date "),o.Vb(),o.Wb(5,"button",50),o.fc("click",(function(){return o.Fc(n),o.hc().resetExcludeDates()})),o.Pc(6," Reset Date "),o.Vb(),o.Vb(),o.Wb(7,"td"),o.Wb(8,"div",12),o.Rb(9,"textarea",51),o.Vb(),o.Vb(),o.Vb()}}function S(e,t){if(1&e){var n=o.Xb();o.Wb(0,"app-checkbox",52),o.fc("onChange",(function(e){return o.Fc(n),o.hc().onRoomCheckAll(e)})),o.Vb()}2&e&&o.pc("label","All")}var I=function(){return{standalone:!0}};function R(e,t){if(1&e){var n=o.Xb();o.Wb(0,"li"),o.Wb(1,"app-checkbox",53),o.fc("ngModelChange",(function(e){return o.Fc(n),o.hc().checkedRoomList=e}))("onChange",(function(e){o.Fc(n);var a=t.$implicit;return o.hc().onRoomCheck(e,a)})),o.Vb(),o.Vb()}if(2&e){var a=t.$implicit,i=o.hc();o.Cb(1),o.pc("ngModel",i.checkedRoomList)("value",a.vendorRoomTypeSeq)("label",i.roomTypeLabel(a))("ngModelOptions",o.tc(5,I))("disabled",i.isImmutableIncludeDays)}}var M=function(e){return["roomTypes",e,"addQuantity"]};function T(e,t){if(1&e){var n=o.Xb();o.Wb(0,"tr"),o.Ub(1,30),o.Wb(2,"td"),o.Pc(3),o.Vb(),o.Wb(4,"td"),o.Rb(5,"app-input-text",54),o.Vb(),o.Wb(6,"td"),o.Wb(7,"button",55),o.fc("click",(function(){o.Fc(n);var e=t.index;return o.hc().showCalendarPreview(e)})),o.Pc(8," Preview "),o.Vb(),o.Vb(),o.Tb(),o.Vb()}if(2&e){var a=t.$implicit,i=t.index,l=o.hc();o.Cb(1),o.qc("formGroupName",i),o.Cb(2),o.Qc(a.value.roomTypeNameEn),o.Cb(2),o.pc("isInvalid",l.checkIsInvalid(o.uc(3,M,i)))}}function F(e,t){1&e&&(o.Wb(0,"p",56),o.Pc(1," No selected item. "),o.Vb())}var N,x=((N=function(){function e(t,n,a){_classCallCheck(this,e),this._dataService=t,this.alertService=n,this.formService=a,this.isImmutableIncludeDays=!1,this.openCalendarEvent=new o.n,this.submitEvent=new o.n,this.closeEvent=new o.n,this._leftCountSum=0,this.unsubscribe$=new l.a,this.isAllDayChecked=!0,this.checkedRoomList=[],this.upsertForm=this._dataService.generateAllotmentPutForm()}return _createClass(e,[{key:"periodArray",get:function(){return this.upsertForm.get("allotmentPeriod").get("periods")}},{key:"roomTypeArray",get:function(){return this.upsertForm.get("roomTypes")}},{key:"periodGroup",value:function(e){return this.periodArray.at(e)}},{key:"roomTypeGroup",value:function(e){return this.roomTypeArray.at(e)}},{key:"ngOnInit",value:function(){var e,t,n=null===(e=this.checkedDateInfo[0])||void 0===e?void 0:e.rooms[0],a=!!(null==n?void 0:n.params.salesStopYn)&&(null==n?void 0:n.params.salesStopYn);if(this.upsertForm.get("dailySalesStopYn").patchValue(a),this.isImmutableIncludeDays){var o=this._dataService.generateRoomTypeGroups();o.get("vendorRoomTypeSeq").patchValue(null==n?void 0:n.roomId);var i=this.roomList.find((function(e){return e.vendorRoomTypeSeq===(null==n?void 0:n.roomId)})),l=null==i?void 0:i.roomTypeNameEn;this._leftCountSum=null===(t=null==n?void 0:n.params)||void 0===t?void 0:t.leftCountSum,o.get("roomTypeNameEn").patchValue(l),o.get("addQuantity").patchValue(0),o.get("minNights").patchValue(1),this.roomTypeArray.push(o),this.checkedRoomList.push(null==n?void 0:n.roomId),this.roomList=[i]}}},{key:"ngOnChanges",value:function(e){var t,n,a,o,i,l,r,c,u,s=this;if(!e.includeDays||!this.isImmutableIncludeDays&&(null===(t=e.includeDays)||void 0===t?void 0:t.firstChange)){if(e.excludeDays&&!(null===(a=e.excludeDays)||void 0===a?void 0:a.firstChange)){var b=null===(o=e.excludeDays)||void 0===o?void 0:o.currentValue;if(b){var d=b.filter((function(e){return!s.includeDays.includes(e)||(s.alertService.alert("Include date and Exclude date cannot be overlapped"),!1)}));this.upsertForm.get("allotmentPeriod").get("excludeDates").setValue(d)}else this.upsertForm.get("allotmentPeriod").get("excludeDates").setValue([])}}else this.upsertForm.get("allotmentPeriod").get("includeDates").setValue(null===(n=e.includeDays)||void 0===n?void 0:n.currentValue);e.checkedDateInfo&&(this.contractData?(this.upsertForm.get("hotelContractSeq").patchValue(this.contractData.hotelContractSeq),this.upsertForm.get("localAllotmentYn").patchValue(null!==(i=this.contractData.localAllotmentYn)&&void 0!==i&&i)):(this.upsertForm.get("hotelContractSeq").patchValue(null===(l=this.checkedDateInfo[0])||void 0===l?void 0:l.hotelContractSeq),this.upsertForm.get("localAllotmentYn").patchValue(null!==(u=null===(c=null===(r=this.checkedDateInfo[0])||void 0===r?void 0:r.rooms[0])||void 0===c?void 0:c.params.localAllotmentYn)&&void 0!==u&&u)))}},{key:"ngOnDestroy",value:function(){this.unsubscribe$.next(),this.unsubscribe$.complete()}},{key:"onSubmit",value:function(){if(this._v_isDateConditionFilled()||this.alertService.alert("Please fill the date condition."),this.upsertForm.invalid&&!this.isImmutableIncludeDays||!this._v_isDateConditionFilled())this.checkValid=!0;else{var e=i.cloneDeep(this.upsertForm.getRawValue());e.roomTypes.forEach((function(t){t.salesStopYn=e.dailySalesStopYn,delete t.roomTypeNameEn})),this.isImmutableIncludeDays&&delete e.allotmentPeriod.periods,this.formService.cleanUpWithArray(e,["dailySalesStopYn"]),this.submitEvent.emit(e)}}},{key:"onClose",value:function(){this.closeEvent.emit()}},{key:"checkIsInvalid",value:function(e){return this.checkValid&&this.upsertForm.get(e)&&this.upsertForm.get(e).invalid}},{key:"addRemovePeriod",value:function(e){e?this.removePeriod(e):this.periodArray.push(this._dataService.generatePeriodGroups())}},{key:"removePeriod",value:function(e){this.periodArray.removeAt(e)}},{key:"onRoomCheck",value:function(e,t){if(e){var n=this._dataService.generateRoomTypeGroups();n.get("vendorRoomTypeSeq").patchValue(t.vendorRoomTypeSeq),n.get("roomTypeNameEn").patchValue(t.roomTypeNameEn),this.roomTypeArray.push(n)}else this.removeRoomType(t)}},{key:"onRoomCheckAll",value:function(e){var t=this,n=this.roomTypeArray;if(e)this.checkedRoomList=i.map(this.roomList,"vendorRoomTypeSeq"),this.roomList.forEach((function(e){-1==n.value.findIndex((function(t){return t.vendorRoomTypeSeq===e.vendorRoomTypeSeq}))&&t.onRoomCheck(!0,e)}));else for(this.checkedRoomList=[];0!==n.length;)n.removeAt(0)}},{key:"removeRoomType",value:function(e){var t=this.roomTypeArray;t.removeAt(t.value.findIndex((function(t){return t.vendorRoomTypeSeq===e.vendorRoomTypeSeq})))}},{key:"onDayCheckAll",value:function(e,t){var n=this.periodGroup(t);n.get("appliedMonYn").patchValue(e),n.get("appliedTueYn").patchValue(e),n.get("appliedWedYn").patchValue(e),n.get("appliedThuYn").patchValue(e),n.get("appliedFriYn").patchValue(e),n.get("appliedSatYn").patchValue(e),n.get("appliedSunYn").patchValue(e)}},{key:"onDayCheck",value:function(e){this.isAllDayChecked=i.every([this.periodArray.controls[0].value.appliedMonYn,this.periodArray.controls[0].value.appliedTueYn,this.periodArray.controls[0].value.appliedWedYn,this.periodArray.controls[0].value.appliedThuYn,this.periodArray.controls[0].value.appliedFriYn,this.periodArray.controls[0].value.appliedSatYn,this.periodArray.controls[0].value.appliedSunYn],Boolean)}},{key:"showCalendar",value:function(e){if("exclude"===e){if(!this.periodDateCheck())return void this.alertService.alert("Input period date first.");var t=this._getPeriodMinDate(),n=r(t,"YYYY-MM-DD").year(),a=r(t,"YYYY-MM-DD").month()+1,o=[];this.periodArray.value.forEach((function(e){o.push({firstDate:e.appliedFromDate,lastDate:e.appliedToDate})})),this.openCalendarEvent.emit({type:e,isPreview:!1,minDate:{year:n,month:a},validDateRange:o})}else this.openCalendarEvent.emit({type:e,isPreview:!1,validDateRange:null})}},{key:"showCalendarPreview",value:function(e){var t,n=this._getPeriodMinDate(),a=i.min(i.concat(null===(t=this.upsertForm.get("allotmentPeriod").get("includeDates"))||void 0===t?void 0:t.value,n));if(null!=a){var o=r(a,"YYYY-MM-DD").year(),l=r(a,"YYYY-MM-DD").month()+1,c=this._getResultDate(e);c&&this.openCalendarEvent.emit({type:"preview",isPreview:!0,minDate:{year:o,month:l},subTextDatas:c})}else this.openCalendarEvent.emit({type:"preview",isPreview:!0})}},{key:"resetIncludeDates",value:function(){this.upsertForm.get("allotmentPeriod").get("includeDates").setValue([])}},{key:"resetExcludeDates",value:function(){this.upsertForm.get("allotmentPeriod").get("excludeDates").setValue([])}},{key:"_getPeriodMinDate",value:function(){var e=this.periodArray.getRawValue();return i.min(i.map(e,"appliedFromDate"))}},{key:"_getResultDate",value:function(e){var t,n,a=this,o=!1,l=[],c=[];this.periodArray.getRawValue().forEach((function(e){var t=e.appliedFromDate,n=e.appliedToDate;null!=t&&null!=n||(o=!0);var a=r(t);c.push(a.format("YYYY-MM-DD"));for(var i=r(n),l=r.duration(i.diff(a)).asDays(),u=0;u<l;u++)c.push(a.add(1,"days").format("YYYY-MM-DD"))}));var u=null===(t=this.upsertForm.get("allotmentPeriod").get("includeDates"))||void 0===t?void 0:t.value,s=null===(n=this.upsertForm.get("allotmentPeriod").get("excludeDates"))||void 0===n?void 0:n.value;c=i.differenceWith(c,s,i.isEqual),u&&(c=i.concat(c,u));var b=this.roomTypeArray.getRawValue();return 0==b.length||null==b[e].addQuantity?(this.alertService.alert("Input quantity first."),null):(c.forEach((function(t){var n=r(t);if(n.isValid()){var o={day:n.date(),month:n.month()+1,year:n.year(),text:"".concat(a._leftCountSum+b[e].addQuantity),pastMonthYn:!1,selectableYn:!1};l.push(o)}})),o&&!this.isImmutableIncludeDays?(this.alertService.alert("Input period date first."),null):l)}},{key:"periodDateCheck",value:function(){var e=this.periodArray.value,t=i.map(e,"appliedFromDate"),n=i.map(e,"appliedToDate");return i.every(t,Boolean)&&i.every(n,Boolean)}},{key:"roomTypeLabel",value:function(e){return"[".concat(e.vendorRoomTypeSeq,"] ").concat(e.roomTypeNameEn)}},{key:"_v_isDateConditionFilled",value:function(){var e,t=this.upsertForm.controls.allotmentPeriod.controls.includeDates,n=this._v_isPeriodArrayFilled(),a=(null===(e=t.value)||void 0===e?void 0:e.length)>0&&t.valid;return n||a}},{key:"_v_isPeriodArrayFilled",value:function(){var e=this.periodArray.value;return!!((null==e?void 0:e.length)>0&&this.periodArray.valid)&&(!(1!==(null==e?void 0:e.length)||!e[0].appliedFromDate||!e[0].appliedToDate)||i.every(e,(function(e){return e.appliedFromDate&&e.appliedToDate})))}}]),e}()).\u0275fac=function(e){return new(e||N)(o.Qb(s),o.Qb(b.a),o.Qb(d.a))},N.\u0275cmp=o.Kb({type:N,selectors:[["app-allotment-detail"]],inputs:{roomList:"roomList",checkedDateInfo:"checkedDateInfo",roomInfo:"roomInfo",includeDays:"includeDays",isImmutableIncludeDays:"isImmutableIncludeDays",excludeDays:"excludeDays",hotelSimpleInfo:"hotelSimpleInfo",contractData:"contractData"},outputs:{openCalendarEvent:"openCalendarEvent",submitEvent:"submitEvent",closeEvent:"closeEvent"},features:[o.Ab],decls:71,vars:13,consts:[[1,"main-contents-summary-inner","mb20"],[1,"font-size-lg","font-weight-bold"],[1,"promotion-rate",3,"formGroup"],[1,"page-item"],[1,"page-item-header"],[1,"table","table-bordered","table-responsive-all"],["width","130px"],["formGroupName","allotmentPeriod"],[4,"ngIf"],["scope","row",1,"th-bg"],["type","button","class","btn btn-light sm mt10 full",3,"click",4,"ngIf"],["type","button","class","btn btn btn-secondary sm mt5 mb5 full",3,"click",4,"ngIf"],[1,"textarea"],["formControlName","includeDates","cols","30","rows","3","readonly",""],[1,"item-box"],[3,"label","onChange",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"form-group","ml-auto"],["formControlName","dailySalesStopYn","name","salesStopYn","label","Daily Sales Stop Y",3,"value"],["formControlName","dailySalesStopYn","name","salesStopYn","label","Daily Sales Stop N",1,"ml10",3,"value"],["width","60%"],["scope","col",1,"align-c"],["formArrayName","roomTypes"],["style","text-align: center; font-size: 13px",4,"ngIf"],[1,"button-area","align-r","mt10"],[1,"btn","btn-secondary","sm",3,"click"],[1,"btn","btn-light","sm",3,"click"],["formArrayName","periods"],["class","form-group",4,"ngFor","ngForOf"],[1,"form-group"],[3,"formGroupName"],[1,"input","calendar","d-inline-flex","flex-fill"],[3,"for"],["type","text","placeholder","YYYY-MM-DD","formControlName","appliedFromDate",3,"matDatepicker"],["myPickerFrom",""],[1,"dash"],[1,"input","calendar","d-inline-flex","flex-fill","mr20"],["type","text","placeholder","YYYY-MM-DD","formControlName","appliedToDate",3,"matDatepicker"],["myPickerTo",""],["binary","true","label","All",3,"value","onChange"],["formControlName","appliedMonYn","binary","true","label","Mon",3,"onChange"],["formControlName","appliedTueYn","binary","true","label","Tue",3,"onChange"],["formControlName","appliedWedYn","binary","true","label","Wed",3,"onChange"],["formControlName","appliedThuYn","binary","true","label","Thu",3,"onChange"],["formControlName","appliedFriYn","binary","true","label","Fri",3,"onChange"],["formControlName","appliedSatYn","binary","true","label","Sat",3,"onChange"],["formControlName","appliedSunYn","binary","true","label","Sun",3,"onChange"],["type","button",1,"btn","btn-outline-secondary","btn-icon-only","xs","ml10",3,"click"],[1,"fas",3,"ngClass"],["type","button",1,"btn","btn-light","sm","mt10","full",3,"click"],["type","button",1,"btn","btn","btn-secondary","sm","mt5","mb5","full",3,"click"],["formControlName","excludeDates","cols","30","rows","3","readonly",""],[3,"label","onChange"],[3,"ngModel","value","label","ngModelOptions","disabled","ngModelChange","onChange"],["formControlName","addQuantity","valueType","number","placeholder","0",3,"isInvalid"],["type","button",1,"btn","btn-light","sm","w-100",3,"click"],[2,"text-align","center","font-size","13px"]],template:function(e,t){1&e&&(o.Wb(0,"div",0),o.Wb(1,"p",1),o.Pc(2),o.Vb(),o.Vb(),o.Wb(3,"div",2),o.Wb(4,"div",3),o.Wb(5,"div",4),o.Wb(6,"strong"),o.Wb(7,"sup"),o.Pc(8,"Date Condition"),o.Vb(),o.Vb(),o.Vb(),o.Wb(9,"div",5),o.Wb(10,"table"),o.Wb(11,"caption"),o.Pc(12," Date Condition "),o.Vb(),o.Wb(13,"colgroup"),o.Rb(14,"col",6),o.Rb(15,"col"),o.Vb(),o.Wb(16,"tbody",7),o.Nc(17,W,6,1,"tr",8),o.Wb(18,"tr"),o.Wb(19,"th",9),o.Pc(20," Include Days "),o.Nc(21,k,2,0,"button",10),o.Nc(22,P,2,0,"button",11),o.Vb(),o.Wb(23,"td"),o.Wb(24,"div",12),o.Rb(25,"textarea",13),o.Vb(),o.Vb(),o.Vb(),o.Nc(26,Y,10,0,"tr",8),o.Vb(),o.Vb(),o.Vb(),o.Vb(),o.Wb(27,"div",3),o.Wb(28,"div",4),o.Wb(29,"strong"),o.Wb(30,"sup"),o.Pc(31,"Select Room Type"),o.Vb(),o.Vb(),o.Vb(),o.Wb(32,"div",14),o.Wb(33,"ul"),o.Wb(34,"li"),o.Nc(35,S,1,1,"app-checkbox",15),o.Vb(),o.Nc(36,R,2,6,"li",16),o.Vb(),o.Vb(),o.Vb(),o.Wb(37,"div",3),o.Wb(38,"div",4),o.Wb(39,"strong"),o.Wb(40,"sup"),o.Pc(41,"Select Room Type"),o.Vb(),o.Vb(),o.Wb(42,"div",17),o.Rb(43,"app-radio",18),o.Rb(44,"app-radio",19),o.Vb(),o.Vb(),o.Wb(45,"div",5),o.Wb(46,"table"),o.Wb(47,"caption"),o.Pc(48," Detail option "),o.Vb(),o.Wb(49,"colgroup"),o.Rb(50,"col",20),o.Rb(51,"col"),o.Rb(52,"col"),o.Vb(),o.Wb(53,"thead"),o.Wb(54,"tr"),o.Wb(55,"th",21),o.Pc(56,"Room Type"),o.Vb(),o.Wb(57,"th",21),o.Wb(58,"sup"),o.Pc(59,"Quantity"),o.Vb(),o.Vb(),o.Wb(60,"th",21),o.Pc(61,"Preview"),o.Vb(),o.Vb(),o.Vb(),o.Wb(62,"tbody"),o.Ub(63,22),o.Nc(64,T,9,5,"tr",16),o.Tb(),o.Vb(),o.Vb(),o.Nc(65,F,2,0,"p",23),o.Vb(),o.Vb(),o.Wb(66,"div",24),o.Wb(67,"button",25),o.fc("click",(function(){return t.onSubmit()})),o.Pc(68,"Save"),o.Vb(),o.Wb(69,"button",26),o.fc("click",(function(){return t.onClose()})),o.Pc(70,"Close"),o.Vb(),o.Vb(),o.Vb()),2&e&&(o.Cb(2),o.Sc(" [",null==t.hotelSimpleInfo?null:t.hotelSimpleInfo.hotelCode,"] ",null==t.hotelSimpleInfo?null:t.hotelSimpleInfo.hotelNameEn," "),o.Cb(1),o.pc("formGroup",t.upsertForm),o.Cb(14),o.pc("ngIf",!t.isImmutableIncludeDays),o.Cb(4),o.pc("ngIf",!t.isImmutableIncludeDays),o.Cb(1),o.pc("ngIf",!t.isImmutableIncludeDays),o.Cb(4),o.pc("ngIf",!t.isImmutableIncludeDays),o.Cb(9),o.pc("ngIf",!t.isImmutableIncludeDays),o.Cb(1),o.pc("ngForOf",t.roomList),o.Cb(7),o.pc("value",!0),o.Cb(1),o.pc("value",!1),o.Cb(20),o.pc("ngForOf",null==t.roomTypeArray?null:t.roomTypeArray.controls),o.Cb(1),o.pc("ngIf",null==t.checkedRoomList||t.checkedRoomList.length<1))},directives:[u.s,u.k,u.l,h.o,u.c,u.r,u.i,h.n,p.a,u.e,m.a,f.a,v.a,y.a,h.l,u.u,g.a],styles:["textarea[_ngcontent-%COMP%]:read-only {\n        background-color: #f5f5f5;\n      }"],changeDetection:0}),N)}}]);