(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{FVAC:function(e,t,n){"use strict";n.r(t),n.d(t,"CONTAINERS",(function(){return Ti})),n.d(t,"COMPONENTS",(function(){return Vi})),n.d(t,"RateAllotmentModule",(function(){return Ni}));var o=n("pxUr"),i=n("ofXK"),a=n("3Pt+"),r=n("snw9"),l=n("kt0X"),c=n("WG3B"),s=n("xoAz"),p=n("wPo9"),d=n("1OXJ"),u=n("l1P7"),m=n("kKjH"),b=n("5hwk"),h=n("+NQf"),f=n("7UZF"),v=n("w8np"),P=n("v7zA"),C=n("hHe4"),g=n("6LsY"),y=n("7rOj"),D=n("tyNb");const S=Object(l.o)("[rateAllotmentAction] getRateAllotment",Object(l.t)()),I=Object(l.o)("[rateAllotmentAction] getRateAllotment \uc131\uacf5",Object(l.t)()),O=Object(l.o)("[rateAllotmentAction] getRateAllotment \uc2e4\ud328",Object(l.t)()),R=Object(l.o)("[rateAllotmentAction] addCheckedDateInfo",Object(l.t)()),k=Object(l.o)("[rateAllotmentAction] promotionCheckedDateInfo",Object(l.t)()),T=Object(l.o)("[rateAllotmentAction] setCheckedDateInfo"),V=Object(l.o)("[rateAllotmentAction] resetPromotionCheckedDateInfo"),N=Object(l.o)("[rateAllotmentAction] change search condition",Object(l.t)()),F=Object(l.o)("[rateAllotmentAction] change search year",Object(l.t)()),A=Object(l.o)("[rateAllotmentAction] change search month",Object(l.t)()),L=Object(l.o)("[rateAllotmentAction] call contract type list",Object(l.t)()),E=Object(l.o)("[rateAllotmentAction] contract type list success",Object(l.t)()),W=Object(l.o)("[rateAllotmentAction] contract type list failed",Object(l.t)()),_=Object(l.o)("[rateAllotmentAction] call promotion type list",Object(l.t)()),x=Object(l.o)("[rateAllotmentAction] promotion type list success",Object(l.t)()),j=Object(l.o)("[rateAllotmentAction] promotion type list failed",Object(l.t)()),Y=Object(l.o)("[rateAllotmentAction] open calendar popup"),M=Object(l.o)("[rateAllotmentAction] close calendar popup"),$=Object(l.o)("[rateAllotmentAction] open plan popup"),q=Object(l.o)("[rateAllotmentAction] close plan popup"),w=Object(l.o)("[rateAllotmentAction] open room popup"),H=Object(l.o)("[rateAllotmentAction] close room popup"),U=Object(l.o)("[rateAllotmentAction] open rate popup"),G=Object(l.o)("[rateAllotmentAction] close rate popup"),B=Object(l.o)("[rateAllotmentAction] open allotment popup"),X=Object(l.o)("[rateAllotmentAction] close allotment popup"),z=Object(l.o)("[rateAllotmentAction] open stop sale popup"),Q=Object(l.o)("[rateAllotmentAction] close stop sale popup"),K=Object(l.o)("[rateAllotmentAction] open promotion popup"),J=Object(l.o)("[rateAllotmentAction] close promotion popup"),Z=Object(l.q)({rateAllotmentList:null,rateAllotmentListSearchCondition:null,promotionTypeList:null,otherSearchInfo:null,mainLoading:null,checkedDateInfo:[],isOpenCalendarPopup:!1,isOpenPlanDetailPopup:!1,isOpenRoomDetailPopup:!1,isOpenAllotmentDetailPopup:!1,isOpenStopSaleDetailPopup:!1,isOpenPromotionDetailPopup:!1,isOpenRateDetailPopup:!1,expandedTreeData:{contract:[],room:[],plan:[],promotion:[]},currentYear:null,currentMonth:null,contractTypeCodeList:null,promotionCheckedDateInfo:null},Object(l.s)(S,e=>Object.assign(Object.assign({},e),{mainLoading:!0})),Object(l.s)(I,(e,{dataList:t})=>Object.assign(Object.assign({},e),{rateAllotmentList:t,mainLoading:!1})),Object(l.s)(E,(e,{dataList:t})=>Object.assign(Object.assign({},e),{contractTypeCodeList:t})),Object(l.s)(O,(e,{})=>Object.assign(Object.assign({},e),{mainLoading:!1})),Object(l.s)(x,(e,{dataList:t})=>Object.assign(Object.assign({},e),{promotionTypeList:t})),Object(l.s)(R,(e,{data:{checked:t,hotelContractSeq:n,date:o,roomId:i,planId:a,type:r,params:l}})=>{var c;let s=e.checkedDateInfo,p=null!==(c=null==s?void 0:s.find(e=>e.hotelContractSeq===n))&&void 0!==c?c:{hotelContractSeq:n,rooms:[],plans:[]};switch(r){case"room":if(t){let e;const t=p.rooms.find(e=>e.roomId===i);if(t){e=Object.assign(Object.assign({},t),{dates:[...t.dates,o]});let n=p.rooms.filter(e=>e.roomId!==i);n=[...n,e],p=Object.assign(Object.assign({},p),{rooms:n})}else e={roomId:i,type:r,dates:[o],params:l},p=Object.assign(Object.assign({},p),{rooms:[...p.rooms,e]})}else{let e;const t=p.rooms.find(e=>e.roomId===i);if((null==t?void 0:t.dates.length)>1){e=Object.assign(Object.assign({},t),{dates:t.dates.filter(e=>e!==o)});let n=p.rooms.filter(e=>e.roomId!==i);n=[...n,e],p=Object.assign(Object.assign({},p),{rooms:n})}else p=Object.assign(Object.assign({},p),{rooms:p.rooms.filter(e=>e.roomId!==i)})}break;case"plan":if(t){let e;const t=p.plans.find(e=>e.planId===a);if(t){e=t.dates.includes(o)?Object.assign(Object.assign({},t),{params:l}):Object.assign(Object.assign({},t),{dates:[...t.dates,o]});let n=p.plans.filter(e=>e.planId!==a);n=[...n,e],p=Object.assign(Object.assign({},p),{plans:n})}else e={roomId:i,planId:a,type:r,dates:[o],params:l},p=Object.assign(Object.assign({},p),{plans:[...p.plans,e]})}else{let e;const t=p.plans.find(e=>e.planId===a);if((null==t?void 0:t.dates.length)>1){e=Object.assign(Object.assign({},t),{dates:t.dates.filter(e=>e!==o)});let n=p.plans.filter(e=>e.planId!==a);n=[...n,e],p=Object.assign(Object.assign({},p),{plans:n})}else p=Object.assign(Object.assign({},p),{plans:p.plans.filter(e=>e.planId!==a)})}}return s=0===p.rooms.length&&0===p.plans.length?s.filter(e=>!(e.hotelContractSeq===n)):s.find(e=>e.hotelContractSeq===n)?s.map(e=>e.hotelContractSeq===n?p:e):[...s,p],Object.assign(Object.assign({},e),{checkedDateInfo:s})}),Object(l.s)(k,(e,{data:t})=>Object.assign(Object.assign({},e),{promotionCheckedDateInfo:t})),Object(l.s)(V,e=>Object.assign(Object.assign({},e),{promotionCheckedDateInfo:null})),Object(l.s)(N,(e,{condition:t,otherSearchInfo:n})=>Object.assign(Object.assign({},e),{rateAllotmentListSearchCondition:t,otherSearchInfo:n})),Object(l.s)(F,(e,{year:t})=>Object.assign(Object.assign({},e),{currentYear:t})),Object(l.s)(A,(e,{month:t})=>Object.assign(Object.assign({},e),{currentMonth:t})),Object(l.s)(T,e=>Object.assign(Object.assign({},e),{checkedDateInfo:[]})),Object(l.s)(Y,e=>Object.assign(Object.assign({},e),{isOpenCalendarPopup:!0})),Object(l.s)(M,e=>Object.assign(Object.assign({},e),{isOpenCalendarPopup:!1})),Object(l.s)($,e=>Object.assign(Object.assign({},e),{isOpenPlanDetailPopup:!0})),Object(l.s)(q,e=>Object.assign(Object.assign({},e),{isOpenPlanDetailPopup:!1})),Object(l.s)(w,e=>Object.assign(Object.assign({},e),{isOpenRoomDetailPopup:!0})),Object(l.s)(H,e=>Object.assign(Object.assign({},e),{isOpenRoomDetailPopup:!1})),Object(l.s)(U,e=>Object.assign(Object.assign({},e),{isOpenRateDetailPopup:!0})),Object(l.s)(G,e=>Object.assign(Object.assign({},e),{isOpenRateDetailPopup:!1})),Object(l.s)(B,e=>Object.assign(Object.assign({},e),{isOpenAllotmentDetailPopup:!0})),Object(l.s)(X,e=>Object.assign(Object.assign({},e),{isOpenAllotmentDetailPopup:!1})),Object(l.s)(z,e=>Object.assign(Object.assign({},e),{isOpenStopSaleDetailPopup:!0})),Object(l.s)(Q,e=>Object.assign(Object.assign({},e),{isOpenStopSaleDetailPopup:!1})),Object(l.s)(K,e=>Object.assign(Object.assign({},e),{isOpenPromotionDetailPopup:!0})),Object(l.s)(J,e=>Object.assign(Object.assign({},e),{isOpenPromotionDetailPopup:!1})));function ee(e,t){return Object(l.m)({planDetailSharedMaster:Z})(e,t)}const te=Object(l.p)("rateAllotmentShared"),ne=Object(l.r)(te,e=>e.planDetailSharedMaster),oe=Object(l.r)(ne,e=>e.rateAllotmentList),ie=Object(l.r)(ne,e=>e.rateAllotmentListSearchCondition),ae=Object(l.r)(ne,e=>e.promotionTypeList),re=Object(l.r)(ne,e=>e.otherSearchInfo),le=Object(l.r)(ne,e=>e.checkedDateInfo),ce=Object(l.r)(ne,e=>e.mainLoading),se=Object(l.r)(ne,e=>e.isOpenCalendarPopup),pe=Object(l.r)(ne,e=>e.isOpenPlanDetailPopup),de=Object(l.r)(ne,e=>e.isOpenRoomDetailPopup),ue=Object(l.r)(ne,e=>e.isOpenRateDetailPopup),me=Object(l.r)(ne,e=>e.isOpenAllotmentDetailPopup),be=Object(l.r)(ne,e=>e.isOpenStopSaleDetailPopup),he=Object(l.r)(ne,e=>e.isOpenPromotionDetailPopup),fe=(Object(l.r)(ne,e=>e.expandedTreeData),Object(l.r)(ne,e=>e.currentYear)),ve=Object(l.r)(ne,e=>e.currentMonth),Pe=Object(l.r)(ne,e=>e.contractTypeCodeList),Ce=Object(l.r)(ne,e=>e.promotionCheckedDateInfo);var ge=n("XNiG"),ye=n("VRyK"),De=n("1G5W"),Se=n("pLZG"),Ie=n("LvDl"),Oe=n("pfiq"),Re=n("itXk"),ke=n("IzEk"),Te=n("Kj3r"),Ve=n("zP0r"),Ne=n("fXoL"),Fe=n("0qeV"),Ae=n("wd/R"),Le=n.n(Ae);let Ee=(()=>{class e{constructor(e){this.fb=e,this.generateSearchForm=()=>this.fb.group({hotelCode:[null,a.z.required],hotelNameEn:[null],ownerCompCode:[11e4],sellerCompCode:[0],contractTypes:[null],vendorRoomTypeSeq:[null],onSalesOnly:[!0],hasPriceOnly:[!0],hasAllotmentOnly:[!0],yearMonth:[Ae().format("YYYYMM")],year:[Ae().format("YYYY")],month:[Ae().format("MM")]}),this.initSearchFormData=()=>({hotelCode:null,hotelNameEn:null,ownerCompCode:11e4,sellerCompCode:0,contractTypes:[],vendorRoomTypeSeq:null,onSalesOnly:!0,hasPriceOnly:!0,hasAllotmentOnly:!0,yearMonth:Ae().format("YYYYMM")})}}return e.\u0275fac=function(t){return new(t||e)(Ne.bc(a.f))},e.\u0275prov=Ne.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var We=n("xDUJ"),_e=n("bMKz"),xe=n("+Sob"),je=n("0xcq"),Ye=n("U6NN"),Me=n("pb6r");const $e=function(){return["hotelCode","hotelNameEn"]},qe=function(){return["CMP02"]},we=function(e){return{compTypeCodes:e}},He=function(){return["compCode","compName"]};let Ue=(()=>{class e{constructor(e,t,n,o,i,a,r){this.service=e,this.formBuilder=t,this._dataService=n,this.cd=o,this.formService=i,this.UserConditionService=a,this.store=r,this.roomTypeOptions=[],this.unsubscribe$=new ge.a,this.loading$=r.pipe(Object(l.u)(ce)),this.searchCondition$=r.pipe(Object(l.u)(ie)),this.otherSearchInfo$=r.pipe(Object(l.u)(re)),this.currentYear$=r.pipe(Object(l.u)(fe)),this.currentMonth$=r.pipe(Object(l.u)(ve)),this.contractTypeCodeList$=r.pipe(Object(l.u)(Pe)),this.searchForm=this._dataService.generateSearchForm()}get searchCondition(){return this._searchCondition}set searchCondition(e){this._searchCondition=e,e&&this.searchForm.patchValue(this._setSearchFormData(e))}ngOnInit(){this._loadDetailCode(),this._initSubscription(),this._initSearchCondition()}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}onSelectHotel(e,t=!1){const{hotelCode:n,hotelNameEn:o}=e;this.searchForm.get("hotelNameEn").setValue(o),t||this.searchForm.get("vendorRoomTypeSeq").reset(),this.service.getRoomTypeList({hotelCode:n}).pipe(Object(ke.a)(1)).subscribe(e=>{this.roomTypeOptions=e,this.cd.detectChanges()})}checkIsInvalid(e){return this.checkValid&&this.searchForm.get(e)&&this.searchForm.get(e).invalid}onSubmit(){if(this.searchForm.invalid)return void(this.checkValid=!0);const e=Ie.cloneDeep(this.searchForm.value);this.store.dispatch(T());const t=this._setOtherSearchCondition();this.store.dispatch(N({condition:e,otherSearchInfo:t})),this.UserConditionService.setSearchSettingSessionStorage(e,"rate&allotment",t),this.checkValid=!1}onReset(){this.roomTypeOptions=[],this.searchForm=this._dataService.generateSearchForm()}_setOtherSearchInfo(e){this.sellerInput=(null==e?void 0:e.sellerInput)||null,this.hotelInput=(null==e?void 0:e.hotelInput)||null}_setSearchFormData(e){const t=this._dataService.initSearchFormData();return Ie.isEmpty(e)?t:Object.assign({},t,Ie.pick(e,Object.keys(t)))}_setOtherSearchCondition(){const e={};return this.autoCopmpletes.forEach(t=>{Object.assign(e,t.getInputValue())}),e}_setSearchCondition(e){return Ie.omitBy(e,Ie.isNil)}_initSubscription(){Object(Re.a)([this.searchCondition$]).pipe(Object(Te.a)(200),Object(Se.a)(([e])=>!Ie.isEmpty(e)),Object(De.a)(this.unsubscribe$),Object(Ve.a)(1)).subscribe(([e])=>{const t=Object.assign({},this._setSearchCondition(e));this.store.dispatch(S({condition:t}))}),this.otherSearchInfo$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.otherSearchInfo=e,this._setOtherSearchInfo(e)}),this.currentYear$.pipe(Object(Ve.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.searchForm.get("year").patchValue(e),this.searchForm.get("yearMonth").patchValue(`${e}${this.searchForm.get("month").value}`),this.onSubmit()}),this.currentMonth$.pipe(Object(Ve.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.searchForm.get("month").patchValue(e),this.searchForm.get("yearMonth").patchValue(`${this.searchForm.get("year").value}${e}`),this.onSubmit()}),this.contractTypeCodeList$.pipe(Object(Ve.a)(1),Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.contractTypeCodeList=e}),this.searchForm.get("hotelCode").valueChanges.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.service.getRoomTypeList({hotelCode:e}).pipe(Object(ke.a)(1)).subscribe(e=>{this.roomTypeOptions=e,this.cd.detectChanges()})})}_initSearchCondition(){if(this.searchCondition$.subscribe(e=>{this.searchCondition=e}),0===Ie.size(this.searchCondition)){const e=this._dataService.initSearchFormData(),t=this.UserConditionService.selectSearchSetting(e,"rate&allotment");this.store.dispatch(N({condition:t[0],otherSearchInfo:t[1]}))}}_loadDetailCode(){this.store.dispatch(L({condition:{masterCode:"HO023"}}))}}return e.\u0275fac=function(t){return new(t||e)(Ne.Qb(Fe.a),Ne.Qb(a.f),Ne.Qb(Ee),Ne.Qb(Ne.h),Ne.Qb(We.a),Ne.Qb(_e.a),Ne.Qb(l.h))},e.\u0275cmp=Ne.Kb({type:e,selectors:[["app-search"]],viewQuery:function(e,t){var n;1&e&&Ne.Xc(Oe.a,!0),2&e&&Ne.Dc(n=Ne.gc())&&(t.autoCopmpletes=n)},decls:38,vars:27,consts:[[1,"grid-search-box","multi",3,"formGroup","connectForm"],[1,"form-option-area"],[1,"row"],[1,"col-2"],[1,"form-label"],["formControlName","hotelCode","apiUrl","common/hotel/list","dataKey","hotelCode","inputFieldFormat","{0} - &{1}","placeholder","Code or Name",1,"d-inline-flex","flex-fill",3,"inputFieldValue","inputId","apiSearchTerm","inputFieldFormatKeyList","isInvalid","onSelect"],["inputId","sellerInput","formControlName","sellerCompCode","apiUrl","common/comp","dataKey","compCode","inputFieldFormat","[{0}] {1}","placeholder","Code or Name",1,"d-inline-flex","flex-fill",3,"inputFieldValue","apiCondition","apiSearchTerm","inputFieldFormatKeyList","isInvalid"],[1,"col-1"],["formControlName","contractTypes","dataKey","detailCode","displayWord","detailCodeName",1,"d-inline-flex","flex-fill",3,"options","useAllOptionYn"],["formControlName","vendorRoomTypeSeq",1,"d-inline-flex","flex-fill",3,"options"],["name","onSalesOnly","label","On Sale Only","formControlName","onSalesOnly",3,"binary"],["name","hasPriceOnly","label","Has Price Only","formControlName","hasPriceOnly",3,"binary"],["name","hasAllotmentOnly","label","Has Allotment Only","formControlName","hasAllotmentOnly",3,"binary"],[1,"form-button-area"],[1,"btn","btn-primary","sm",3,"click"],[1,"btn","btn-reset","sm",3,"click"],[1,"loading-mask","pos-fixed"],[1,"content-loading","align-items-center"],[1,"icon-loading","lg"],[1,"loading-title"]],template:function(e,t){1&e&&(Ne.Wb(0,"form",0),Ne.Wb(1,"div",1),Ne.Wb(2,"div",2),Ne.Wb(3,"div",3),Ne.Wb(4,"span",4),Ne.Wb(5,"sup"),Ne.Pc(6,"Hotel"),Ne.Vb(),Ne.Vb(),Ne.Wb(7,"app-auto-complete",5),Ne.fc("onSelect",(function(e){return t.onSelectHotel(e)})),Ne.Vb(),Ne.Vb(),Ne.Wb(8,"div",3),Ne.Wb(9,"span",4),Ne.Pc(10,"Seller"),Ne.Vb(),Ne.Rb(11,"app-auto-complete",6),Ne.Vb(),Ne.Vb(),Ne.Wb(12,"div",2),Ne.Wb(13,"div",7),Ne.Wb(14,"span",4),Ne.Pc(15,"Contract Type"),Ne.Vb(),Ne.Rb(16,"app-multi-select-detailcode",8),Ne.Vb(),Ne.Wb(17,"div",7),Ne.Wb(18,"span",4),Ne.Pc(19,"Room Type"),Ne.Vb(),Ne.Rb(20,"app-selectbox",9),Ne.Vb(),Ne.Wb(21,"div",7),Ne.Rb(22,"app-checkbox",10),Ne.Vb(),Ne.Wb(23,"div",7),Ne.Rb(24,"app-checkbox",11),Ne.Vb(),Ne.Wb(25,"div",7),Ne.Rb(26,"app-checkbox",12),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Wb(27,"div",13),Ne.Wb(28,"button",14),Ne.fc("click",(function(){return t.onSubmit()})),Ne.Pc(29," Search "),Ne.Vb(),Ne.Wb(30,"button",15),Ne.fc("click",(function(){return t.onReset()})),Ne.Pc(31,"Reset"),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Wb(32,"div",16),Ne.ic(33,"async"),Ne.Wb(34,"div",17),Ne.Rb(35,"div",18),Ne.Wb(36,"div",19),Ne.Pc(37,"loading..."),Ne.Vb(),Ne.Vb(),Ne.Vb()),2&e&&(Ne.pc("formGroup",t.searchForm)("connectForm",t.searchForm),Ne.Cb(7),Ne.pc("inputFieldValue",t.hotelInput)("inputId","hotelInput")("apiSearchTerm","keyword")("inputFieldFormatKeyList",Ne.tc(22,$e))("isInvalid",t.checkIsInvalid("hotelCode")),Ne.Cb(4),Ne.pc("inputFieldValue",t.sellerInput)("apiCondition",Ne.uc(24,we,Ne.tc(23,qe)))("apiSearchTerm","compName")("inputFieldFormatKeyList",Ne.tc(26,He))("isInvalid",t.checkIsInvalid("sellerCompCode")),Ne.Cb(5),Ne.pc("options",t.contractTypeCodeList)("useAllOptionYn",!0),Ne.Cb(4),Ne.pc("options",t.roomTypeOptions),Ne.Cb(2),Ne.pc("binary",!0),Ne.Cb(2),Ne.pc("binary",!0),Ne.Cb(2),Ne.pc("binary",!0),Ne.Cb(6),Ne.Gb("active",Ne.jc(33,20,t.loading$)))},directives:[a.B,a.s,a.k,xe.a,Oe.a,a.r,a.i,je.a,Ye.a,Me.a],pipes:[i.b],styles:[".form[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;margin-bottom:0}.orangeButton[_ngcontent-%COMP%]{background-color:#f35c3a;color:#fff}.shortForm[_ngcontent-%COMP%]{max-width:500px;min-width:500px}.calendarWrapper[_ngcontent-%COMP%]{display:flex}.seperatorLine[_ngcontent-%COMP%]{width:1px;background-color:#e0e0e0;height:120px;margin:-16px 12px}"],changeDetection:0}),e})();var Ge=n("EsKh");let Be=(()=>{class e{getPlanListByTypeData(e,t){const n=[],o=[],i=[],a=e.vendorRoomTypes;for(const r of a){const e=this._getRoomType(r);n.push(e);const t=r.vendorRoomPlans;if(t)for(const n of t){const e=this._getRatePlan(r,n);o.push(e);const t=n.planPromotions;if(t)for(const o of t){const e=o.promotionDetails;if(e)for(const t of e){if(Ie.isNil(t.derivedRoomPlanSeq)||!t.manualInsertYn)continue;const e=this._getPromotionPlan(r,n,o,t);i.push(e)}}}}return{roomTypeList:n.filter(e=>Ie.isObject(e)).filter(e=>{var n,o;return!!Ie.isNil(null===(o=null===(n=t[0])||void 0===n?void 0:n.rooms[0])||void 0===o?void 0:o.roomId)||e.vendorRoomTypeSeq===t[0].rooms[0].roomId}).filter(e=>{var n,o;return!!Ie.isNil(null===(o=null===(n=t[0])||void 0===n?void 0:n.plans[0])||void 0===o?void 0:o.planId)||e.vendorRoomPlanSeq===t[0].plans[0].planId}),ratePlanList:o.filter(e=>Ie.isObject(e)).filter(e=>{var n,o;return!!Ie.isNil(null===(o=null===(n=t[0])||void 0===n?void 0:n.rooms[0])||void 0===o?void 0:o.roomId)||e.vendorRoomTypeSeq===t[0].rooms[0].roomId}).filter(e=>{var n,o;return!!Ie.isNil(null===(o=null===(n=t[0])||void 0===n?void 0:n.plans[0])||void 0===o?void 0:o.planId)||e.vendorRoomPlanSeq===t[0].plans[0].planId}),promotionPlanList:i.filter(e=>Ie.isObject(e)).filter(e=>{var n,o;return!!Ie.isNil(null===(o=null===(n=t[0])||void 0===n?void 0:n.rooms[0])||void 0===o?void 0:o.roomId)||e.vendorRoomTypeSeq===t[0].rooms[0].roomId}).filter(e=>{var n,o;return!!Ie.isNil(null===(o=null===(n=t[0])||void 0===n?void 0:n.plans[0])||void 0===o?void 0:o.planId)||e.vendorRoomPlanSeq===t[0].plans[0].planId})}}_getRoomType(e){return{vendorRoomTypeSeq:e.vendorRoomTypeSeq,vendorRoomPlanSeq:null,roomTypeNameEn:e.vendorRoomTypeNameEn,roomPlanNameEn:null,salesStopYn:e.salesStopYn}}_getRatePlan(e,t){return{vendorRoomTypeSeq:e.vendorRoomTypeSeq,vendorRoomPlanSeq:t.vendorRoomPlanSeq,roomTypeNameEn:e.vendorRoomTypeNameEn,roomPlanNameEn:t.roomPlanNameEn,salesStopYn:t.salesStopYn}}_getPromotionPlan(e,t,n,o){return{vendorRoomTypeSeq:e.vendorRoomTypeSeq,vendorRoomPlanSeq:o.derivedRoomPlanSeq,roomTypeNameEn:e.vendorRoomTypeNameEn,roomPlanNameEn:t.roomPlanNameEn,planPromotionSeq:o.planPromotionSeq,planPromotionName:n.planPromotionName,salesStopYn:t.salesStopYn}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Ne.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Xe=n("OMYy");let ze=(()=>{class e{getPlanListByTypeData(e){let t=[],n=[];const o=e.vendorRoomTypes;for(const i of o){const o=i.vendorRoomPlans;if(o)for(const a of o){if(a.salesStopYn)continue;const o=this._getRoomPlan(e,i,a);t.push(o);const r=a.planPromotions;if(r)for(const t of r){const o=t.promotionDetails;if(o)for(const r of o){if(Ie.isNil(r.derivedRoomPlanSeq)||!r.manualInsertYn)continue;const o=this._getPromotionPlan(e,i,a,t,r);n.push(o)}}}}return{roomPlanList:t,promotionPlanList:n}}_getRoomPlan(e,t,n){return{netProvideYn:e.netProvideYn,vendorCommRate:e.vendorCommRate,hotelContractTypeCode:e.hotelContractTypeCode,hotelContractSeq:e.hotelContractSeq,currencyCode:e.currencyCode,sendAmountTypeCode:e.sendAmountTypeCode,extraTaxPaymentYn:e.extraTaxPaymentYn,vendorRoomTypeSeq:null==t?void 0:t.vendorRoomTypeSeq,vendorRoomPlanSeq:null==n?void 0:n.vendorRoomPlanSeq,roomPlanNameEn:`[${null==n?void 0:n.vendorRoomPlanSeq}] ${null==t?void 0:t.vendorRoomTypeNameEn} - ${null==n?void 0:n.roomPlanNameEn}`}}_getPromotionPlan(e,t,n,o,i){return{netProvideYn:e.netProvideYn,vendorCommRate:e.vendorCommRate,hotelContractTypeCode:e.hotelContractTypeCode,hotelContractSeq:e.hotelContractSeq,currencyCode:e.currencyCode,sendAmountTypeCode:e.sendAmountTypeCode,extraTaxPaymentYn:e.extraTaxPaymentYn,planPromotionSeq:i.planPromotionSeq,vendorRoomTypeSeq:t.vendorRoomTypeSeq,vendorRoomPlanSeq:i.derivedRoomPlanSeq,promotionPlanNameEn:`${o.planPromotionName} - ${o.planPromotionTypeName} : ${i.checkInFromDate} ~ ${i.checkInToDate}`}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Ne.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Qe(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"button",7),Ne.fc("click",(function(){Ne.Fc(e);const t=Ne.hc().$implicit;return Ne.hc().openAddPromotion(t.planPromotionName)})),Ne.Rb(1,"i",8),Ne.Vb()}}function Ke(e,t){1&e&&(Ne.Ub(0),Ne.Rb(1,"td"),Ne.Tb())}function Je(e,t){if(1&e&&(Ne.Ub(0),Ne.Nc(1,Ke,2,0,"ng-container",0),Ne.Tb()),2&e){const e=t.$implicit,n=Ne.hc(3);Ne.Cb(1),Ne.pc("ngForOf",n.getFullDate(e.dailyPrices))}}function Ze(e,t){if(1&e&&(Ne.Ub(0),Ne.Nc(1,Je,2,1,"ng-container",0),Ne.Tb()),2&e){const e=t.$implicit;Ne.Cb(1),Ne.pc("ngForOf",e.adultCounts)}}function et(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"button",14),Ne.fc("click",(function(){Ne.Fc(e);const t=Ne.hc(3).$implicit;return Ne.hc(3).openModifyPromotion(t)})),Ne.Pc(1),Ne.ic(2,"date"),Ne.ic(3,"date"),Ne.Vb()}if(2&e){const e=Ne.hc(3).$implicit;Ne.sc("title","",e.planPromotionSeq," : ",e.planPromotionName,""),Ne.Cb(1),Ne.Sc(" ",Ne.kc(2,4,e.checkInFromDate,"MM-dd"),"~",Ne.kc(3,7,e.checkInToDate,"MM-dd")," ")}}function tt(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"span",16),Ne.fc("click",(function(){Ne.Fc(e);const t=Ne.hc(4).$implicit,n=Ne.hc(2).$implicit;return Ne.hc().openRateHandler(n,t)})),Ne.Pc(1," M "),Ne.Vb()}}function nt(e,t){if(1&e&&(Ne.Wb(0,"button"),Ne.Nc(1,tt,2,0,"span",15),Ne.Vb()),2&e){const e=Ne.hc(3).$implicit;Ne.Cb(1),Ne.pc("ngIf",e.manualInsertYn)}}function ot(e,t){if(1&e&&(Ne.Ub(0),Ne.Wb(1,"span",17),Ne.Pc(2),Ne.Vb(),Ne.Tb()),2&e){const e=Ne.hc().$implicit;Ne.Cb(2),Ne.Rc("",e.adultCount," ADT")}}function it(e,t){if(1&e&&(Ne.Ub(0),Ne.Wb(1,"span",21),Ne.Pc(2),Ne.ic(3,"number"),Ne.Vb(),Ne.Tb()),2&e){const e=Ne.hc(4).$implicit;Ne.Cb(2),Ne.Qc(Ne.jc(3,1,e.vendorSellingNetAmount))}}function at(e,t){if(1&e&&(Ne.Ub(0),Ne.Wb(1,"span"),Ne.Pc(2),Ne.ic(3,"number"),Ne.Vb(),Ne.Nc(4,it,4,3,"ng-container",6),Ne.Wb(5,"span"),Ne.Pc(6),Ne.ic(7,"number"),Ne.Vb(),Ne.Tb()),2&e){const e=Ne.hc(3).$implicit,t=Ne.hc(6);Ne.Cb(2),Ne.Rc(" ",Ne.kc(3,3,e.vendorNetAmount+e.vendorTaxAmount,".2"),""),Ne.Cb(2),Ne.pc("ngIf","HOC01"===t.contractData.hotelContractTypeCode),Ne.Cb(2),Ne.Rc("(",Ne.kc(7,6,e.vendorGrossMspAmount,".2"),")")}}function rt(e,t){if(1&e&&(Ne.Ub(0),Ne.Wb(1,"span",21),Ne.Pc(2),Ne.ic(3,"number"),Ne.Vb(),Ne.Tb()),2&e){const e=Ne.hc(4).$implicit;Ne.Cb(2),Ne.Qc(Ne.jc(3,1,e.vendorSellingNetAmount))}}function lt(e,t){if(1&e&&(Ne.Wb(0,"span"),Ne.Pc(1),Ne.ic(2,"number"),Ne.Vb(),Ne.Nc(3,rt,4,3,"ng-container",6),Ne.Wb(4,"span"),Ne.Pc(5),Ne.ic(6,"number"),Ne.Vb()),2&e){const e=Ne.hc(3).$implicit,t=Ne.hc(6);Ne.Cb(1),Ne.Rc(" ",Ne.jc(2,3,e.vendorNetAmount+e.vendorTaxAmount),""),Ne.Cb(2),Ne.pc("ngIf","HOC01"===t.contractData.hotelContractTypeCode),Ne.Cb(2),Ne.Rc("(",Ne.jc(6,5,e.vendorGrossMspAmount),")")}}const ct=function(e,t){return{stop:e,derived:t}};function st(e,t){if(1&e&&(Ne.Wb(0,"p",19),Ne.Nc(1,at,8,9,"ng-container",9),Ne.Nc(2,lt,7,7,"ng-template",null,20,Ne.Oc),Ne.Vb()),2&e){const e=Ne.Ec(3),t=Ne.hc(2).$implicit,n=Ne.hc(3).$implicit,o=Ne.hc(3);Ne.pc("ngClass",Ne.vc(3,ct,n.salesStopYn||t.salesStopYn,o.planData.originRoomPlanSeq)),Ne.Cb(1),Ne.pc("ngIf","USD"==o.contractData.currencyCode)("ngIfElse",e)}}function pt(e,t){if(1&e&&(Ne.Ub(0),Ne.Nc(1,st,4,6,"p",18),Ne.Tb()),2&e){const e=Ne.hc().$implicit;Ne.Cb(1),Ne.pc("ngIf",!!e.appliedDate)}}function dt(e,t){if(1&e&&(Ne.Wb(0,"td"),Ne.Nc(1,pt,2,1,"ng-container",6),Ne.Vb()),2&e){const e=t.$implicit;Ne.Cb(1),Ne.pc("ngIf",e.vendorNetAmount+e.vendorTaxAmount>0)}}function ut(e,t){if(1&e&&(Ne.Wb(0,"tr",12),Ne.Wb(1,"th"),Ne.Nc(2,et,4,10,"button",13),Ne.Nc(3,nt,2,1,"button",6),Ne.Nc(4,ot,3,1,"ng-container",6),Ne.Vb(),Ne.Nc(5,dt,2,1,"td",0),Ne.Vb()),2&e){const e=t.$implicit,n=t.index,o=Ne.hc(5);Ne.Cb(2),Ne.pc("ngIf",0==n),Ne.Cb(1),Ne.pc("ngIf",0==n),Ne.Cb(1),Ne.pc("ngIf",!(0===e.adultCount&&o.roomChargeYn)),Ne.Cb(1),Ne.pc("ngForOf",o.getFullDate(e.dailyPrices))}}function mt(e,t){if(1&e&&(Ne.Ub(0),Ne.Nc(1,ut,6,4,"tr",11),Ne.Tb()),2&e){const e=Ne.hc().$implicit;Ne.Cb(1),Ne.pc("ngForOf",e.adultCounts)}}function bt(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"span",16),Ne.fc("click",(function(){Ne.Fc(e);const t=Ne.hc(2).$implicit,n=Ne.hc(2).$implicit;return Ne.hc().openRateHandler(n,t)})),Ne.Pc(1," M "),Ne.Vb()}}function ht(e,t){1&e&&Ne.Rb(0,"td")}const ft=function(){return[]};function vt(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"tr",12),Ne.Wb(1,"th"),Ne.Wb(2,"button",14),Ne.fc("click",(function(){Ne.Fc(e);const t=Ne.hc().$implicit;return Ne.hc(3).openModifyPromotion(t)})),Ne.Pc(3),Ne.ic(4,"date"),Ne.ic(5,"date"),Ne.Vb(),Ne.Wb(6,"button"),Ne.Nc(7,bt,2,0,"span",15),Ne.Vb(),Ne.Vb(),Ne.Nc(8,ht,1,0,"td",0),Ne.Vb()}if(2&e){const e=Ne.hc().$implicit,t=Ne.hc(3);Ne.Cb(2),Ne.sc("title","",e.planPromotionSeq," : ",e.planPromotionName,""),Ne.Cb(1),Ne.Sc(" ",Ne.kc(4,6,e.checkInFromDate,"MM-dd"),"~",Ne.kc(5,9,e.checkInToDate,"MM-dd")," "),Ne.Cb(4),Ne.pc("ngIf",e.manualInsertYn),Ne.Cb(1),Ne.pc("ngForOf",Ne.tc(12,ft).constructor(t.getDayCount()))}}function Pt(e,t){if(1&e&&(Ne.Ub(0),Ne.Nc(1,mt,2,1,"ng-container",9),Ne.Nc(2,vt,9,13,"ng-template",null,10,Ne.Oc),Ne.Tb()),2&e){const e=t.$implicit,n=Ne.Ec(3);Ne.Cb(1),Ne.pc("ngIf",e.adultCounts)("ngIfElse",n)}}function Ct(e,t){if(1&e&&(Ne.Ub(0),Ne.Nc(1,Pt,4,2,"ng-container",0),Ne.Tb()),2&e){const e=Ne.hc().$implicit;Ne.Cb(1),Ne.pc("ngForOf",e.promotionDetails)}}const gt=function(e,t){return{"fa-minus":e,"fa-plus":t}};function yt(e,t){if(1&e){const e=Ne.Xb();Ne.Ub(0),Ne.Wb(1,"tr",1),Ne.Wb(2,"th"),Ne.Wb(3,"button",2),Ne.Wb(4,"i",3),Ne.fc("click",(function(){Ne.Fc(e);const n=t.$implicit;return Ne.hc().toggleSubContentHandler(n.planPromotionTypeCode)})),Ne.Vb(),Ne.Vb(),Ne.Wb(5,"button",4),Ne.Pc(6),Ne.Vb(),Ne.Nc(7,Qe,2,0,"button",5),Ne.Vb(),Ne.Nc(8,Ze,2,1,"ng-container",0),Ne.Vb(),Ne.Nc(9,Ct,2,1,"ng-container",6),Ne.Tb()}if(2&e){const e=t.$implicit,n=Ne.hc();Ne.Cb(4),Ne.pc("ngClass",Ne.vc(6,gt,n.isOpenSubContent(e.planPromotionTypeCode),!n.isOpenSubContent(e.planPromotionTypeCode))),Ne.Cb(1),Ne.qc("title",e.planPromotionTypeName),Ne.Cb(1),Ne.Rc(" ",e.planPromotionTypeName," "),Ne.Cb(1),Ne.pc("ngIf",n.checkPlusButtonShow(e)),Ne.Cb(1),Ne.pc("ngForOf",e.promotionDetails),Ne.Cb(1),Ne.pc("ngIf",n.isOpenSubContent(e.planPromotionTypeCode))}}let Dt=(()=>{class e{constructor(e){this.store=e,this.openPromotionDetailEvent=new Ne.n,this.openRateDetailEvent=new Ne.n,this.unsubscribe$=new ge.a}ngOnInit(){var e;this.searchCondition$=this.store.pipe(Object(l.u)(ie)),this.searchCondition$.subscribe(e=>{this.condition=e}),this.subscribeToSearchCondition(),this.openPromotionIdList=null===(e=this.promotionData)||void 0===e?void 0:e.map(e=>e.planPromotionTypeCode)}ngOnChanges(e){var t,n;e.promotionData&&(this.openPromotionIdList=null!==(n=null===(t=this.promotionData)||void 0===t?void 0:t.map(e=>e.planPromotionTypeCode))&&void 0!==n?n:[])}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}toggleSubContentHandler(e){if(this.openPromotionIdList.find(t=>t===e))this.openPromotionIdList=this.openPromotionIdList.filter(t=>t!==e);else{const t=Ie.cloneDeep(this.openPromotionIdList);t.push(e),this.openPromotionIdList=t}}isOpenSubContent(e){return this.openPromotionIdList.find(t=>t===e)}subscribeToSearchCondition(){this.searchCondition$=this.store.pipe(Object(l.u)(ie)),this.searchCondition$.subscribe(e=>{this.selectedHotelSimple=e&&{hotelCode:e.hotelCode,hotelNameEn:e.hotelNameEn}})}getFullDate(e){var t,n;if(!e)return[];const o=null!==(n=null===(t=this.condition)||void 0===t?void 0:t.yearMonth)&&void 0!==n?n:Le()().format("YYYYMM");return Object(Xe.b)(o).map(e=>e.yyyymmdd).map(t=>{const n=e.find(e=>e.appliedDate===t);return Object.assign({},n)})}openAddPromotion(e){const t=Ie.find(this.promotionData,{planPromotionName:e});if(t){const e=Ie.take(t.promotionDetails,1);this.openPromotionDetailEvent.emit({isNewPromotion:!0,addWithOnlyDate:!0,planPromotionSeq:e[0].planPromotionSeq,list:[{vendorRoomTypeSeq:this.roomData.vendorRoomTypeSeq,vendorRoomPlanSeq:this.planData.vendorRoomPlanSeq,vendorRoomTypeNameEn:this.roomData.vendorRoomTypeNameEn,roomPlanNameEn:this.planData.roomPlanNameEn}]})}}openModifyPromotion(e){this.openPromotionDetailEvent.emit({planPromotionSeq:e.planPromotionSeq,list:[{vendorRoomTypeSeq:this.roomData.vendorRoomTypeSeq,vendorRoomPlanSeq:this.planData.vendorRoomPlanSeq,vendorRoomTypeNameEn:this.roomData.vendorRoomTypeNameEn,roomPlanNameEn:this.planData.roomPlanNameEn}]})}openRateHandler(e,t){const n={currencyCode:this.contractData.currencyCode,netProvideYn:this.contractData.netProvideYn,vendorCommRate:this.contractData.vendorCommRate,localPriceYn:this.contractData.localPriceYn,priceCmsPmsCompName:this.contractData.priceCmsPmsCompName,localAllotmentYn:this.contractData.localAllotmentYn,allotmentCmsPmsCompName:this.contractData.allotmentCmsPmsCompName,vendorSellingNetAmount:null,planPromotionSeq:t.planPromotionSeq,appliedFromDate:t.checkInFromDate,appliedToDate:t.checkInToDate,appliedMonYn:t.checkInMonYn,appliedTueYn:t.checkInTueYn,appliedWedYn:t.checkInWedYn,appliedThuYn:t.checkInThuYn,appliedFriYn:t.checkInFriYn,appliedSatYn:t.checkInSatYn,appliedSunYn:t.checkInSunYn};this.store.dispatch(k({data:[{hotelContractSeq:this.contractData.hotelContractSeq,rooms:[{roomId:this.roomData.vendorRoomTypeSeq,dates:[],type:"room",params:n}],plans:[{roomId:this.roomData.vendorRoomTypeSeq,planId:t.derivedRoomPlanSeq,dates:[],type:"plan",params:n}]}]})),this.openRateDetailEvent.emit()}checkPlusButtonShow(e){const t=Ie.head(e.promotionDetails);return!0!==(null==t?void 0:t.manualInsertYn)}getDayCount(){return Number(Le()(this.condition.yearMonth).daysInMonth())}}return e.\u0275fac=function(t){return new(t||e)(Ne.Qb(l.h))},e.\u0275cmp=Ne.Kb({type:e,selectors:[["app-promotion"]],inputs:{promotionData:"promotionData",contractData:"contractData",planData:"planData",roomData:"roomData",roomChargeYn:"roomChargeYn"},outputs:{openPromotionDetailEvent:"openPromotionDetailEvent",openRateDetailEvent:"openRateDetailEvent"},features:[Ne.Ab],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[1,"promotion-header"],["type","button",1,"btn-row-toggle"],[1,"fas",3,"ngClass","click"],["type","button",1,"btn-promotion",3,"title"],["type","button","class","btn-add-option",3,"click",4,"ngIf"],[4,"ngIf"],["type","button",1,"btn-add-option",3,"click"],[1,"fas","fa-plus"],[4,"ngIf","ngIfElse"],["onlyDate",""],["class","roomplan-include-option date",4,"ngFor","ngForOf"],[1,"roomplan-include-option","date"],["type","button","class","btn-roomplan-date",3,"title","click",4,"ngIf"],["type","button",1,"btn-roomplan-date",3,"title","click"],["class","manual yes",3,"click",4,"ngIf"],[1,"manual","yes",3,"click"],[1,"person-type"],["class","net",3,"ngClass",4,"ngIf"],[1,"net",3,"ngClass"],["otherCurrency",""],[2,"color","#0000BF"]],template:function(e,t){1&e&&Ne.Nc(0,yt,10,9,"ng-container",0),2&e&&Ne.pc("ngForOf",t.promotionData)},directives:[i.n,i.l,i.o],pipes:[i.e,i.f],styles:["","[_nghost-%COMP%] {\n        display: contents;\n      }"],changeDetection:0}),e})();function St(e,t){1&e&&(Ne.Wb(0,"span",12),Ne.Pc(1,"(H)"),Ne.Vb())}function It(e,t){1&e&&(Ne.Ub(0),Ne.Rb(1,"i",13),Ne.Tb())}function Ot(e,t){1&e&&Ne.Rb(0,"i",14)}const Rt=function(e){return{disabled:e}};function kt(e,t){if(1&e&&Ne.Rb(0,"td",17),2&e){const e=t.$implicit,n=Ne.hc(2).$implicit;Ne.Gb("selling-stop",e.salesStopYn),Ne.pc("ngClass",Ne.uc(3,Rt,n.salesStopYn||e.salesStopYn))}}function Tt(e,t){if(1&e&&(Ne.Ub(0,15),Ne.Nc(1,kt,1,5,"td",16),Ne.Tb()),2&e){const e=t.$implicit,n=Ne.hc(2);Ne.Cb(1),Ne.pc("ngForOf",n.getFullDate(e.dailyPrices))("ngForTrackBy",n.trackByDate)}}function Vt(e,t){if(1&e&&(Ne.Ub(0),Ne.Wb(1,"span",21),Ne.Pc(2),Ne.Vb(),Ne.Tb()),2&e){const e=Ne.hc().$implicit;Ne.Cb(2),Ne.Rc(" ",e.adultCount," ADT ")}}function Nt(e,t){if(1&e&&(Ne.Ub(0),Ne.Wb(1,"span",28),Ne.Pc(2),Ne.ic(3,"number"),Ne.Vb(),Ne.Tb()),2&e){const e=Ne.hc(4).$implicit;Ne.Cb(2),Ne.Qc(Ne.jc(3,1,e.vendorSellingNetAmount))}}function Ft(e,t){if(1&e&&(Ne.Ub(0),Ne.Wb(1,"span"),Ne.Pc(2),Ne.ic(3,"number"),Ne.Vb(),Ne.Nc(4,Nt,4,3,"ng-container",11),Ne.Wb(5,"span"),Ne.Pc(6),Ne.ic(7,"number"),Ne.Vb(),Ne.Tb()),2&e){const e=Ne.hc(3).$implicit,t=Ne.hc(4);Ne.Cb(2),Ne.Rc(" ",Ne.kc(3,3,e.vendorNetAmount+e.vendorTaxAmount,".2"),""),Ne.Cb(2),Ne.pc("ngIf","HOC01"===t.contractData.hotelContractTypeCode),Ne.Cb(2),Ne.Rc("(",Ne.kc(7,6,e.vendorGrossMspAmount,".2"),")")}}function At(e,t){if(1&e&&(Ne.Ub(0),Ne.Wb(1,"span",28),Ne.Pc(2),Ne.ic(3,"number"),Ne.Vb(),Ne.Tb()),2&e){const e=Ne.hc(4).$implicit;Ne.Cb(2),Ne.Qc(Ne.jc(3,1,e.vendorSellingNetAmount))}}function Lt(e,t){if(1&e&&(Ne.Wb(0,"span"),Ne.Pc(1),Ne.ic(2,"number"),Ne.Vb(),Ne.Nc(3,At,4,3,"ng-container",11),Ne.Wb(4,"span"),Ne.Pc(5),Ne.ic(6,"number"),Ne.Vb()),2&e){const e=Ne.hc(3).$implicit,t=Ne.hc(4);Ne.Cb(1),Ne.Rc(" ",Ne.jc(2,3,e.vendorNetAmount+e.vendorTaxAmount),""),Ne.Cb(2),Ne.pc("ngIf","HOC01"===t.contractData.hotelContractTypeCode),Ne.Cb(2),Ne.Rc("(",Ne.jc(6,5,e.vendorGrossMspAmount),")")}}const Et=function(e){return{stop:e}};function Wt(e,t){if(1&e&&(Ne.Wb(0,"p",26),Ne.Nc(1,Ft,8,9,"ng-container",8),Ne.Nc(2,Lt,7,7,"ng-template",null,27,Ne.Oc),Ne.Vb()),2&e){const e=Ne.Ec(3),t=Ne.hc(2).$implicit,n=Ne.hc(3).$implicit,o=Ne.hc();Ne.pc("ngClass",Ne.uc(3,Et,n.salesStopYn||t.salesStopYn)),Ne.Cb(1),Ne.pc("ngIf","USD"===o.contractData.currencyCode)("ngIfElse",e)}}function _t(e,t){if(1&e){const e=Ne.Xb();Ne.Ub(0),Ne.Wb(1,"label",22),Ne.Wb(2,"input",23),Ne.fc("click",(function(t){Ne.Fc(e);const n=Ne.hc().$implicit,o=Ne.hc(3).$implicit;return Ne.hc().changeCheckbox(t,n,o.vendorRoomPlanSeq)})),Ne.Vb(),Ne.Rb(3,"span",24),Ne.Vb(),Ne.Nc(4,Wt,4,5,"p",25),Ne.Tb()}if(2&e){const e=Ne.hc().$implicit;Ne.Cb(4),Ne.pc("ngIf",!!e.appliedDate)}}function xt(e,t){if(1&e&&(Ne.Wb(0,"td"),Ne.Nc(1,_t,5,1,"ng-container",11),Ne.Vb()),2&e){const e=t.$implicit;Ne.Gb("selling-stop",e.salesStopYn),Ne.Cb(1),Ne.pc("ngIf",!!e.appliedDate)}}function jt(e,t){if(1&e&&(Ne.Wb(0,"tr",19),Ne.Wb(1,"th"),Ne.Nc(2,Vt,3,1,"ng-container",11),Ne.Vb(),Ne.Nc(3,xt,2,3,"td",20),Ne.Vb()),2&e){const e=t.$implicit,n=Ne.hc(2).$implicit,o=Ne.hc();Ne.Cb(2),Ne.pc("ngIf",!(0===e.adultCount&&n.roomChargeYn)),Ne.Cb(1),Ne.pc("ngForOf",o.getFullDate(e.dailyPrices))("ngForTrackBy",o.trackByDate)}}function Yt(e,t){if(1&e&&(Ne.Ub(0),Ne.Nc(1,jt,4,3,"tr",18),Ne.Tb()),2&e){const e=Ne.hc().$implicit;Ne.Cb(1),Ne.pc("ngForOf",e.adultCounts)}}function Mt(e,t){if(1&e&&(Ne.Ub(0),Ne.Wb(1,"span",21),Ne.Pc(2),Ne.Vb(),Ne.Tb()),2&e){const e=Ne.hc().$implicit;Ne.Cb(2),Ne.Rc(" ",e.adultCount," ADT ")}}function $t(e,t){if(1&e&&(Ne.Ub(0),Ne.Wb(1,"span",28),Ne.Pc(2),Ne.ic(3,"number"),Ne.Vb(),Ne.Tb()),2&e){const e=Ne.hc(3).$implicit;Ne.Cb(2),Ne.Qc(Ne.jc(3,1,e.vendorSellingNetAmount))}}function qt(e,t){if(1&e&&(Ne.Ub(0),Ne.Wb(1,"span"),Ne.Pc(2),Ne.ic(3,"number"),Ne.Vb(),Ne.Nc(4,$t,4,3,"ng-container",11),Ne.Wb(5,"span"),Ne.Pc(6),Ne.ic(7,"number"),Ne.Vb(),Ne.Tb()),2&e){const e=Ne.hc(2).$implicit,t=Ne.hc(4);Ne.Cb(2),Ne.Rc(" ",Ne.kc(3,3,e.vendorNetAmount+e.vendorTaxAmount,".2"),""),Ne.Cb(2),Ne.pc("ngIf","HOC01"===t.contractData.hotelContractTypeCode),Ne.Cb(2),Ne.Rc("(",Ne.kc(7,6,e.vendorGrossMspAmount,".2"),")")}}function wt(e,t){if(1&e&&(Ne.Ub(0),Ne.Wb(1,"span",28),Ne.Pc(2),Ne.ic(3,"number"),Ne.Vb(),Ne.Tb()),2&e){const e=Ne.hc(3).$implicit;Ne.Cb(2),Ne.Qc(Ne.jc(3,1,e.vendorSellingNetAmount))}}function Ht(e,t){if(1&e&&(Ne.Wb(0,"span"),Ne.Pc(1),Ne.ic(2,"number"),Ne.Vb(),Ne.Nc(3,wt,4,3,"ng-container",11),Ne.Wb(4,"span"),Ne.Pc(5),Ne.ic(6,"number"),Ne.Vb()),2&e){const e=Ne.hc(2).$implicit,t=Ne.hc(4);Ne.Cb(1),Ne.Rc(" ",Ne.jc(2,3,e.vendorNetAmount+e.vendorTaxAmount),""),Ne.Cb(2),Ne.pc("ngIf","HOC01"===t.contractData.hotelContractTypeCode),Ne.Cb(2),Ne.Rc("(",Ne.jc(6,5,e.vendorGrossMspAmount),")")}}function Ut(e,t){if(1&e){const e=Ne.Xb();Ne.Ub(0),Ne.Wb(1,"label",22),Ne.Wb(2,"input",29),Ne.fc("click",(function(t){Ne.Fc(e);const n=Ne.hc().$implicit,o=Ne.hc(3).$implicit;return Ne.hc().changeCheckbox(t,n,o.vendorRoomPlanSeq)})),Ne.Vb(),Ne.Rb(3,"span",24),Ne.Vb(),Ne.Wb(4,"p",26),Ne.Nc(5,qt,8,9,"ng-container",8),Ne.Nc(6,Ht,7,7,"ng-template",null,30,Ne.Oc),Ne.Vb(),Ne.Tb()}if(2&e){const e=Ne.Ec(7),t=Ne.hc().$implicit,n=Ne.hc(3).$implicit,o=Ne.hc();Ne.Cb(4),Ne.pc("ngClass",Ne.uc(3,Et,n.salesStopYn||t.salesStopYn)),Ne.Cb(1),Ne.pc("ngIf","USD"===o.contractData.currencyCode)("ngIfElse",e)}}function Gt(e,t){if(1&e&&(Ne.Wb(0,"td"),Ne.Nc(1,Ut,8,5,"ng-container",11),Ne.Vb()),2&e){const e=t.$implicit;Ne.Gb("selling-stop",e.salesStopYn),Ne.Cb(1),Ne.pc("ngIf",!!e.appliedDate)}}function Bt(e,t){if(1&e&&(Ne.Wb(0,"tr",19),Ne.Wb(1,"th"),Ne.Nc(2,Mt,3,1,"ng-container",11),Ne.Vb(),Ne.Nc(3,Gt,2,3,"td",20),Ne.Vb()),2&e){const e=t.$implicit,n=Ne.hc(2).$implicit,o=Ne.hc();Ne.Cb(2),Ne.pc("ngIf",!(0===e.adultCount&&n.roomChargeYn)),Ne.Cb(1),Ne.pc("ngForOf",o.getFullDate(e.dailyPrices))("ngForTrackBy",o.trackByDate)}}function Xt(e,t){if(1&e&&(Ne.Ub(0),Ne.Nc(1,Bt,4,3,"tr",18),Ne.Tb()),2&e){const e=Ne.hc().$implicit;Ne.Cb(1),Ne.pc("ngForOf",e.adultCounts)}}function zt(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"app-promotion",32),Ne.fc("openPromotionDetailEvent",(function(t){return Ne.Fc(e),Ne.hc(3).openPromotionDetailPopupHandler(t)}))("openRateDetailEvent",(function(){return Ne.Fc(e),Ne.hc(3).openRateDetailPopupHandler()})),Ne.Vb()}if(2&e){const e=Ne.hc(2).$implicit,t=Ne.hc();Ne.pc("promotionData",e.planPromotions)("roomChargeYn",e.roomChargeYn)("planData",e)("roomData",t.roomData)("contractData",t.contractData)}}function Qt(e,t){if(1&e&&(Ne.Ub(0),Ne.Nc(1,zt,1,5,"app-promotion",31),Ne.Tb()),2&e){const e=Ne.hc().$implicit,t=Ne.hc();Ne.Cb(1),Ne.pc("ngIf",t.isOpenSubContent(e.vendorRoomPlanSeq))}}const Kt=function(e,t){return{"fa-minus":e,"fa-plus":t}},Jt=function(e){return{"text-decoration":e}};function Zt(e,t){if(1&e){const e=Ne.Xb();Ne.Ub(0),Ne.Wb(1,"tr",1),Ne.Wb(2,"th"),Ne.Wb(3,"button",2),Ne.Wb(4,"i",3),Ne.fc("click",(function(){Ne.Fc(e);const n=t.$implicit;return Ne.hc().toggleSubContentHandler(n.vendorRoomPlanSeq)})),Ne.Vb(),Ne.Vb(),Ne.Wb(5,"button",4),Ne.fc("click",(function(n){Ne.Fc(e);const o=t.$implicit;return Ne.hc().planPopupHandler(n,o)})),Ne.Wb(6,"span",5),Ne.Pc(7),Ne.Vb(),Ne.Vb(),Ne.Nc(8,St,2,0,"span",6),Ne.Wb(9,"span",7),Ne.Nc(10,It,2,0,"ng-container",8),Ne.Nc(11,Ot,1,0,"ng-template",null,9,Ne.Oc),Ne.Vb(),Ne.Vb(),Ne.Nc(13,Tt,2,2,"ng-container",10),Ne.Vb(),Ne.Nc(14,Yt,2,1,"ng-container",11),Ne.Nc(15,Xt,2,1,"ng-container",11),Ne.Nc(16,Qt,2,1,"ng-container",11),Ne.Tb()}if(2&e){const e=t.$implicit,n=Ne.Ec(12),o=Ne.hc();Ne.Cb(4),Ne.pc("ngClass",Ne.vc(12,Kt,o.isOpenSubContent(e.vendorRoomPlanSeq),!o.isOpenSubContent(e.vendorRoomPlanSeq))),Ne.Cb(1),Ne.sc("title","",e.vendorRoomPlanSeq,"-",e.roomPlanNameEn,""),Ne.Cb(1),Ne.pc("ngStyle",Ne.uc(15,Jt,"D"===e.dataStatusCode?"line-through":"none")),Ne.Cb(1),Ne.Qc(e.roomPlanNameEn),Ne.Cb(1),Ne.pc("ngIf",e.hotelOwnerYn),Ne.Cb(2),Ne.pc("ngIf",e.roomChargeYn)("ngIfElse",n),Ne.Cb(3),Ne.pc("ngForOf",e.adultCounts),Ne.Cb(1),Ne.pc("ngIf",e.roomChargeYn&&o.isOpenSubContent(e.vendorRoomPlanSeq)),Ne.Cb(1),Ne.pc("ngIf",!e.roomChargeYn&&o.isOpenSubContent(e.vendorRoomPlanSeq)),Ne.Cb(1),Ne.pc("ngIf",!1===e.cmsInsertYn)}}let en=(()=>{class e{constructor(e){this.store=e,this.openPlanDetailEvent=new Ne.n,this.openPromotionDetailEvent=new Ne.n,this.openRateDetailEvent=new Ne.n,this.unsubscribe$=new ge.a,this.trackByPlan=e=>e.vendorRoomPlanSeq,this.trackByDate=e=>(null==e?void 0:e.appliedDate)?e.appliedDate.charAt(9)+e.appliedDate.charAt(8):null}ngOnInit(){this.searchCondition$=this.store.pipe(Object(l.u)(ie)),this.searchCondition$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.selectedHotelSimple=e&&{hotelCode:e.hotelCode,hotelNameEn:e.hotelNameEn},this.yearMonth=e&&e.yearMonth}),this.selectedCheckedDate$=this.store.pipe(Object(l.u)(le)),this.selectedCheckedDate$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.checkedDateInfo=e}),this.planData&&(this.openPlanIdList=this.planData.map(e=>e.vendorRoomPlanSeq))}ngOnChanges(e){var t,n;e.planData&&(this.openPlanIdList=null!==(n=null===(t=this.planData)||void 0===t?void 0:t.map(e=>e.vendorRoomPlanSeq))&&void 0!==n?n:[])}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}toggleSubContentHandler(e){if(this.openPlanIdList.find(t=>t===e))this.openPlanIdList=this.openPlanIdList.filter(t=>t!==e);else{const t=Ie.cloneDeep(this.openPlanIdList);t.push(e),this.openPlanIdList=t}}isOpenSubContent(e){return this.openPlanIdList.find(t=>t===e)}planPopupHandler(e,t){this.openPlanDetailEvent.emit({planMasterInfo:t,planSeq:t.vendorRoomPlanSeq})}getFullDate(e){if(!e)return[];const t=this.yearMonth?this.yearMonth:Le()().format("YYYYMM");return Object(Xe.b)(t).map(e=>e.yyyymmdd).map(t=>{const n=e.find(e=>e.appliedDate===t);return Object.assign({},n)})}changeCheckbox(e,t,n){this.store.dispatch(R({data:{checked:e.target.checked,hotelContractSeq:this.contractData.hotelContractSeq,date:t.appliedDate,planId:n,roomId:this.vendorRoomTypeSeq,type:"plan",params:{vendorContractAmount:t.vendorContractAmount,vendorGrossAmount:t.vendorGrossMspAmount,vendorNetAmount:t.vendorNetAmount,vendorMspAmount:t.vendorGrossMspAmount,vendorTaxAmount:t.vendorTaxAmount,vendorSellingNetAmount:t.vendorSellingNetAmount,salesStopYn:t.salesStopYn,currencyCode:this.contractData.currencyCode,netProvideYn:this.contractData.netProvideYn,vendorCommRate:this.contractData.vendorCommRate,localPriceYn:this.contractData.localPriceYn,priceCmsPmsCompName:this.contractData.priceCmsPmsCompName,localAllotmentYn:this.contractData.localAllotmentYn,allotmentCmsPmsCompName:this.contractData.allotmentCmsPmsCompName,extraTaxPaymentYn:this.contractData.extraTaxPaymentYn}}}))}openPromotionDetailPopupHandler(e){this.openPromotionDetailEvent.emit(e)}openRateDetailPopupHandler(){this.openRateDetailEvent.emit()}}return e.\u0275fac=function(t){return new(t||e)(Ne.Qb(l.h))},e.\u0275cmp=Ne.Kb({type:e,selectors:[["app-plan"]],inputs:{planData:"planData",roomData:"roomData",contractData:"contractData",vendorRoomTypeSeq:"vendorRoomTypeSeq"},outputs:{openPlanDetailEvent:"openPlanDetailEvent",openPromotionDetailEvent:"openPromotionDetailEvent",openRateDetailEvent:"openRateDetailEvent"},features:[Ne.Ab],decls:1,vars:2,consts:[[4,"ngFor","ngForOf","ngForTrackBy"],[1,"roomplan-header","roomplan-include-option"],["type","button",1,"btn-row-toggle"],[1,"fas",3,"ngClass","click"],["type","button",1,"btn-roomplan",3,"title","click"],[3,"ngStyle"],["class","owner",4,"ngIf"],[1,"icon-group"],[4,"ngIf","ngIfElse"],["elseBlock",""],["class","dateContainer",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"owner"],[1,"fas","fa-bed"],[1,"fas","fa-male"],[1,"dateContainer"],["class","dateItem",3,"ngClass","selling-stop",4,"ngFor","ngForOf","ngForTrackBy"],[1,"dateItem",3,"ngClass"],["class","roomplan-include-option person",4,"ngFor","ngForOf"],[1,"roomplan-include-option","person"],[3,"selling-stop",4,"ngFor","ngForOf","ngForTrackBy"],[1,"person-type"],[1,"checkbox","only"],["type","checkbox","value","plan",1,"checkbox-control-input",3,"click"],[1,"checkbox-control-text"],["class","net",3,"ngClass",4,"ngIf"],[1,"net",3,"ngClass"],["otherCurrency1",""],[2,"color","#0000BF"],["type","checkbox",1,"checkbox-control-input",3,"click"],["otherCurrency2",""],[3,"promotionData","roomChargeYn","planData","roomData","contractData","openPromotionDetailEvent","openRateDetailEvent",4,"ngIf"],[3,"promotionData","roomChargeYn","planData","roomData","contractData","openPromotionDetailEvent","openRateDetailEvent"]],template:function(e,t){1&e&&Ne.Nc(0,Zt,17,17,"ng-container",0),2&e&&Ne.pc("ngForOf",t.planData)("ngForTrackBy",t.trackByPlan)},directives:[i.n,i.l,i.p,i.o,Dt],pipes:[i.f],styles:["","[_nghost-%COMP%] {\n        display: contents;\n      }"],changeDetection:0}),e})();function tn(e,t){if(1&e&&(Ne.Ub(0),Ne.Pc(1),Ne.Tb()),2&e){const e=Ne.hc(2).$implicit;Ne.Cb(1),Ne.Sc(" ",e.leftCountSum,"/",e.allotmentCountSum," ")}}function nn(e,t){if(1&e&&Ne.Pc(0),2&e){const e=Ne.hc(2).$implicit;Ne.Sc(" ",e.leftCountSum,"/",e.leftCountSum," ")}}const on=function(e,t,n){return{ohmy:e,cms:t,stop:n}};function an(e,t){if(1&e){const e=Ne.Xb();Ne.Ub(0),Ne.Wb(1,"label",14),Ne.Wb(2,"input",15),Ne.fc("click",(function(t){Ne.Fc(e);const n=Ne.hc().$implicit,o=Ne.hc(3).$implicit;return Ne.hc().changeCheckbox(t,n,o.vendorRoomTypeSeq)})),Ne.Vb(),Ne.Rb(3,"span",16),Ne.Vb(),Ne.Wb(4,"p",17),Ne.Nc(5,tn,2,2,"ng-container",8),Ne.Nc(6,nn,1,2,"ng-template",null,18,Ne.Oc),Ne.Vb(),Ne.Tb()}if(2&e){const e=Ne.Ec(7),t=Ne.hc().$implicit,n=Ne.hc().$implicit;Ne.Cb(4),Ne.pc("ngClass",Ne.wc(3,on,n.localAllotmentYn,!n.localAllotmentYn,n.salesStopYn||t.salesStopYn)),Ne.Cb(1),Ne.pc("ngIf",n.localAllotmentYn)("ngIfElse",e)}}function rn(e,t){if(1&e&&(Ne.Wb(0,"td"),Ne.Nc(1,an,8,7,"ng-container",13),Ne.Vb()),2&e){const e=t.$implicit;Ne.Gb("selling",!1===e.salesStopYn)("selling-stop",e.salesStopYn),Ne.Cb(1),Ne.pc("ngIf",null==e?null:e.appliedDay)}}function ln(e,t){if(1&e&&(Ne.Ub(0),Ne.Nc(1,rn,2,5,"td",12),Ne.Tb()),2&e){const e=t.$implicit,n=Ne.hc(3);Ne.Cb(1),Ne.pc("ngForOf",n.getFullDate(e.allotments))("ngForTrackBy",n.trackByDate)}}function cn(e,t){if(1&e&&(Ne.Ub(0),Ne.Nc(1,ln,2,2,"ng-container",11),Ne.Tb()),2&e){const e=Ne.hc().$implicit;Ne.Cb(1),Ne.pc("ngForOf",e.roomAllotments)}}function sn(e,t){1&e&&Ne.Rb(0,"td")}function pn(e,t){if(1&e&&Ne.Nc(0,sn,1,0,"td",11),2&e){const e=Ne.hc(2);Ne.pc("ngForOf",e.monthInfo)}}function dn(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"app-plan",19),Ne.fc("openPlanDetailEvent",(function(t){return Ne.Fc(e),Ne.hc(2).openPlanDetailPopupHandler(t)}))("openPromotionDetailEvent",(function(t){return Ne.Fc(e),Ne.hc(2).openPromotionDetailPopupHandler(t)}))("openRateDetailEvent",(function(){return Ne.Fc(e),Ne.hc(2).openRateDetailPopupHandler()})),Ne.Vb()}if(2&e){const e=Ne.hc().$implicit,t=Ne.hc();Ne.pc("planData",e.vendorRoomPlans)("vendorRoomTypeSeq",e.vendorRoomTypeSeq)("contractData",t.contractData)("roomData",e)}}const un=function(e,t){return{"fa-minus":e,"fa-plus":t}},mn=function(e){return{"text-decoration":e}};function bn(e,t){if(1&e){const e=Ne.Xb();Ne.Ub(0),Ne.Wb(1,"tr",1),Ne.Wb(2,"th"),Ne.Wb(3,"button",2),Ne.Wb(4,"i",3),Ne.fc("click",(function(){Ne.Fc(e);const n=t.$implicit;return Ne.hc().toggleSubContentHandler(n.vendorRoomTypeSeq)})),Ne.Vb(),Ne.Vb(),Ne.Wb(5,"button",4),Ne.fc("click",(function(n){Ne.Fc(e);const o=t.$implicit;return Ne.hc().roomPopupHandler(n,o)})),Ne.Wb(6,"span",5),Ne.Pc(7),Ne.Vb(),Ne.Vb(),Ne.Wb(8,"button",6),Ne.fc("click",(function(n){Ne.Fc(e);const o=t.$implicit;return Ne.hc().calendarPopupHandler(n,o)})),Ne.Rb(9,"i",7),Ne.Vb(),Ne.Vb(),Ne.Nc(10,cn,2,1,"ng-container",8),Ne.Nc(11,pn,1,1,"ng-template",null,9,Ne.Oc),Ne.Vb(),Ne.Nc(13,dn,1,4,"app-plan",10),Ne.Tb()}if(2&e){const e=t.$implicit,n=Ne.Ec(12),o=Ne.hc();Ne.Cb(4),Ne.pc("ngClass",Ne.vc(8,un,o.isOpenSubContent(e.vendorRoomTypeSeq),!o.isOpenSubContent(e.vendorRoomTypeSeq))),Ne.Cb(1),Ne.sc("title","",e.vendorRoomTypeSeq,"-",e.vendorRoomTypeNameEn,""),Ne.Cb(1),Ne.pc("ngStyle",Ne.uc(11,mn,"D"===e.dataStatusCode?"line-through":"none")),Ne.Cb(1),Ne.Qc(e.vendorRoomTypeNameEn),Ne.Cb(3),Ne.pc("ngIf",e.roomAllotments&&e.roomAllotments.length>0)("ngIfElse",n),Ne.Cb(3),Ne.pc("ngIf",o.isOpenSubContent(e.vendorRoomTypeSeq))}}let hn=(()=>{class e{constructor(e,t){this.service=e,this.store=t,this.openPlanDetailEvent=new Ne.n,this.openRoomDetailEvent=new Ne.n,this.openPromotionDetailEvent=new Ne.n,this.openRateDetailEvent=new Ne.n,this.openCalendarDetailEvent=new Ne.n,this.unsubscribe$=new ge.a,this.trackByRoomData=e=>e.vendorRoomTypeSeq,this.trackByAllotment=e=>e.roomAllotmentSeq,this.trackByDate=e=>(null==e?void 0:e.appliedDate)?e.appliedDate.charAt(9)+e.appliedDate.charAt(8):null}ngOnInit(){this.searchCondition$=this.store.pipe(Object(l.u)(ie)),this.searchCondition$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.condition=e,this.selectedHotelSimple=e&&{hotelCode:e.hotelCode,hotelNameEn:e.hotelNameEn},this.yearMonth=e&&e.yearMonth}),this.selectedCheckedDate$=this.store.pipe(Object(l.u)(le)),this.selectedCheckedDate$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.checkedDateInfo=e}),this.openRoomIdList=this.roomData.map(e=>e.vendorRoomTypeSeq)}ngOnChanges(e){var t,n;e.roomData&&(this.openRoomIdList=null!==(n=null===(t=this.roomData)||void 0===t?void 0:t.map(e=>e.vendorRoomTypeSeq))&&void 0!==n?n:[])}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}toggleSubContentHandler(e){if(this.openRoomIdList.find(t=>t===e))this.openRoomIdList=this.openRoomIdList.filter(t=>t!==e);else{const t=Ie.cloneDeep(this.openRoomIdList);t.push(e),this.openRoomIdList=t}}getFullDate(e){if(!e)return[];const t=this.yearMonth?this.yearMonth:Le()().format("YYYYMM");return Object(Xe.b)(t).map(e=>e.yyyymmdd).map(t=>{const n=e.find(e=>e.appliedDate===t);return Object.assign({},n)})}isOpenSubContent(e){return this.openRoomIdList.find(t=>t===e)}changeCheckbox(e,t,n){this.store.dispatch(R({data:{checked:e.target.checked,hotelContractSeq:this.contractData.hotelContractSeq,date:t.appliedDate,roomId:n,planId:null,type:"room",params:{leftCountSum:t.leftCountSum,minNights:t.minNights,salesStopYn:t.salesStopYn,localAllotmentYn:this.contractData.localAllotmentYn}}}))}calendarPopupHandler(e,t){this.openCalendarDetailEvent.emit({isPreview:!0,allotmentParameters:{vendorRoomTypeSeq:t.vendorRoomTypeSeq,vendorCompCode:this.contractData.vendorCompCode,hotelCode:Number(this.contractData.cmsPmsHotelCode),hotelContractNo:this.contractData.hotelContractNo,hotelContractTypeCode:this.contractData.hotelContractTypeCode,ownerCompCode:this.contractData.ownerCompCode,sellerCompCode:0}})}roomPopupHandler(e,t){this.openRoomDetailEvent.emit(t)}openPlanDetailPopupHandler(e){this.openPlanDetailEvent.emit(e)}openPromotionDetailPopupHandler(e){this.openPromotionDetailEvent.emit(e)}openRateDetailPopupHandler(){this.openRateDetailEvent.emit()}}return e.\u0275fac=function(t){return new(t||e)(Ne.Qb(Fe.a),Ne.Qb(l.h))},e.\u0275cmp=Ne.Kb({type:e,selectors:[["app-room"]],inputs:{monthInfo:"monthInfo",roomData:"roomData",contractData:"contractData"},outputs:{openPlanDetailEvent:"openPlanDetailEvent",openRoomDetailEvent:"openRoomDetailEvent",openPromotionDetailEvent:"openPromotionDetailEvent",openRateDetailEvent:"openRateDetailEvent",openCalendarDetailEvent:"openCalendarDetailEvent"},features:[Ne.Ab],decls:1,vars:2,consts:[[4,"ngFor","ngForOf","ngForTrackBy"],[1,"roomtype-header"],["type","button",1,"btn-row-toggle"],[1,"fas",3,"ngClass","click"],["type","button",1,"btn-roomtype",3,"title","click"],[3,"ngStyle"],["type","button",1,"btn-roomtype-calendar",3,"click"],[1,"fas","fa-calendar-alt"],[4,"ngIf","ngIfElse"],["emptyDays",""],[3,"planData","vendorRoomTypeSeq","contractData","roomData","openPlanDetailEvent","openPromotionDetailEvent","openRateDetailEvent",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"selling","selling-stop",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[1,"checkbox","only"],["type","checkbox","value","room",1,"checkbox-control-input",3,"click"],[1,"checkbox-control-text"],[2,"text-align","center","line-height","22px",3,"ngClass"],["localAllotmentNo",""],[3,"planData","vendorRoomTypeSeq","contractData","roomData","openPlanDetailEvent","openPromotionDetailEvent","openRateDetailEvent"]],template:function(e,t){1&e&&Ne.Nc(0,bn,14,13,"ng-container",0),2&e&&Ne.pc("ngForOf",t.roomData)("ngForTrackBy",t.trackByRoomData)},directives:[i.n,i.l,i.p,i.o,en],styles:["","[_nghost-%COMP%] {\n        display: contents;\n      }"],changeDetection:0}),e})();function fn(e,t){1&e&&(Ne.Wb(0,"tbody"),Ne.Wb(1,"tr"),Ne.Wb(2,"td",2),Ne.Pc(3,"No records available."),Ne.Vb(),Ne.Vb(),Ne.Vb())}function vn(e,t){if(1&e&&(Ne.Wb(0,"li"),Ne.Pc(1),Ne.Vb()),2&e){const e=Ne.hc().$implicit;Ne.Cb(1),Ne.Rc("Contract Status: ",e.contractStatusCode,"")}}function Pn(e,t){if(1&e&&(Ne.Wb(0,"li"),Ne.Pc(1),Ne.Vb()),2&e){const e=Ne.hc().$implicit;Ne.Cb(1),Ne.Rc("Comm Rate : ",e.vendorCommRate,"%")}}function Cn(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"li"),Ne.Wb(1,"button",10),Ne.fc("click",(function(){Ne.Fc(e);const t=Ne.hc().$implicit;return Ne.hc().openRateHandler(t)})),Ne.Pc(2," Rate "),Ne.Vb(),Ne.Vb()}}function gn(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"li"),Ne.Wb(1,"button",10),Ne.fc("click",(function(){Ne.Fc(e);const t=Ne.hc().$implicit;return Ne.hc().openAllotmentHandler(t)})),Ne.Pc(2," Allotment "),Ne.Vb(),Ne.Vb()}}function yn(e,t){if(1&e){const e=Ne.Xb();Ne.Ub(0),Ne.Wb(1,"app-room",11),Ne.fc("openPlanDetailEvent",(function(t){return Ne.Fc(e),Ne.hc(2).openPlanDetailPopupHandler(t)}))("openRoomDetailEvent",(function(t){return Ne.Fc(e),Ne.hc(2).openRoomDetailPopupHandler(t)}))("openPromotionDetailEvent",(function(t){return Ne.Fc(e),Ne.hc(2).openPromotionDetailPopupHandler(t)}))("openRateDetailEvent",(function(){Ne.Fc(e);const t=Ne.hc().$implicit;return Ne.hc().openRateDetailPopupHandler(t)}))("openCalendarDetailEvent",(function(t){return Ne.Fc(e),Ne.hc(2).openCalendarDetailPopupHandler(t)})),Ne.Vb(),Ne.Tb()}if(2&e){const e=Ne.hc().$implicit,t=Ne.hc();Ne.Cb(1),Ne.pc("roomData",e.vendorRoomTypes)("contractData",e)("monthInfo",t.monthInfo)}}const Dn=function(e,t){return{"fa-minus":e,"fa-plus":t}};function Sn(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"tbody"),Ne.Wb(1,"tr",3),Ne.Wb(2,"th"),Ne.Wb(3,"button",4),Ne.Wb(4,"i",5),Ne.fc("click",(function(){Ne.Fc(e);const n=t.$implicit;return Ne.hc().toggleSubContentHandler(n.hotelContractSeq)})),Ne.Vb(),Ne.Wb(5,"span",6),Ne.Pc(6),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Wb(7,"th"),Ne.Wb(8,"div",7),Ne.Wb(9,"ul",8),Ne.Nc(10,vn,2,1,"li",0),Ne.Wb(11,"li"),Ne.Pc(12),Ne.Vb(),Ne.Wb(13,"li"),Ne.Pc(14),Ne.Vb(),Ne.Nc(15,Pn,2,1,"li",0),Ne.Wb(16,"li"),Ne.Pc(17),Ne.Vb(),Ne.Wb(18,"li"),Ne.Pc(19),Ne.Vb(),Ne.Vb(),Ne.Wb(20,"ul",9),Ne.Nc(21,Cn,3,0,"li",0),Ne.Nc(22,gn,3,0,"li",0),Ne.Wb(23,"li"),Ne.Wb(24,"button",10),Ne.fc("click",(function(){Ne.Fc(e);const n=t.$implicit;return Ne.hc().openStopSalesHandler(n)})),Ne.Pc(25," Stop or Start Selling "),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Nc(26,yn,2,3,"ng-container",0),Ne.Vb()}if(2&e){const e=t.$implicit,n=Ne.hc();Ne.Cb(4),Ne.pc("ngClass",Ne.vc(14,Dn,n.isOpenSubContent(e.hotelContractSeq),!n.isOpenSubContent(e.hotelContractSeq))),Ne.Cb(1),Ne.pc("title",e.hotelContractTypeName),Ne.Cb(1),Ne.Sc("",e.hotelContractTypeName," : ",e.hotelContractSeq," "),Ne.Cb(1),Ne.Db("colspan",n.monthInfo.length),Ne.Cb(3),Ne.pc("ngIf",e.contractStatusCode),Ne.Cb(2),Ne.Rc("Curr : ",e.currencyCode,""),Ne.Cb(2),Ne.Qc(e.netProvideYn?"NET":"Gross"),Ne.Cb(1),Ne.pc("ngIf",!e.netProvideYn),Ne.Cb(2),Ne.Rc(" Rate : ",e.localPriceYn?"Local":e.priceCmsPmsCompName," "),Ne.Cb(2),Ne.Rc(" Allotment : ",e.localAllotmentYn?"Local":e.allotmentCmsPmsCompName," "),Ne.Cb(2),Ne.pc("ngIf","HOC03"!=e.hotelContractTypeCode),Ne.Cb(1),Ne.pc("ngIf","HOC03"!=e.hotelContractTypeCode),Ne.Cb(4),Ne.pc("ngIf",n.isOpenSubContent(e.hotelContractSeq))}}let In=(()=>{class e{constructor(e,t){this.store=e,this.rateDetailDataService=t,this.openPlanDetailEvent=new Ne.n,this.openRoomDetailEvent=new Ne.n,this.openRateDetailEvent=new Ne.n,this.openAllotmentDetailEvent=new Ne.n,this.openPromotionDetailEvent=new Ne.n,this.openStopSaleDetailEvent=new Ne.n,this.openCalendarDetailEvent=new Ne.n,this.unsubscribe$=new ge.a,this.isDetail=!1,this.trackByContractTypeItem=e=>e.hotelContractSeq}ngOnInit(){this.subscribeToSearchCondition()}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}subscribeToSearchCondition(){this.gridState$=this.store.pipe(Object(l.u)(oe)),this.gridState$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.openContractIdList=null==e?void 0:e.map(e=>e.hotelContractSeq)}),this.searchCondition$=this.store.pipe(Object(l.u)(ie)),this.searchCondition$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.selectedHotelSimple=e&&{hotelCode:e.hotelCode,hotelNameEn:e.hotelNameEn}})}toggleSubContentHandler(e){if(this.openContractIdList.find(t=>t===e))this.openContractIdList=this.openContractIdList.filter(t=>t!==e);else{const t=Ie.cloneDeep(this.openContractIdList);t.push(e),this.openContractIdList=t}}isOpenSubContent(e){return this.openContractIdList.find(t=>t===e)}openAllotmentHandler(e){this.openAllotmentDetailEvent.emit(e)}openStopSalesHandler(e){this.openStopSaleDetailEvent.emit(e)}openRateHandler(e){const t=this.rateDetailDataService.getPlanListByTypeData(e);this.openRateDetailEvent.emit(t)}openPlanDetailPopupHandler(e){this.openPlanDetailEvent.emit(e)}openRoomDetailPopupHandler(e){this.openRoomDetailEvent.emit(e)}openPromotionDetailPopupHandler(e){this.openPromotionDetailEvent.emit(e)}openRateDetailPopupHandler(e){const t=this.rateDetailDataService.getPlanListByTypeData(e);this.openRateDetailEvent.emit(t)}openCalendarDetailPopupHandler(e){this.openCalendarDetailEvent.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(Ne.Qb(l.h),Ne.Qb(ze))},e.\u0275cmp=Ne.Kb({type:e,selectors:[["app-collection"]],inputs:{monthInfo:"monthInfo"},outputs:{openPlanDetailEvent:"openPlanDetailEvent",openRoomDetailEvent:"openRoomDetailEvent",openRateDetailEvent:"openRateDetailEvent",openAllotmentDetailEvent:"openAllotmentDetailEvent",openPromotionDetailEvent:"openPromotionDetailEvent",openStopSaleDetailEvent:"openStopSaleDetailEvent",openCalendarDetailEvent:"openCalendarDetailEvent"},decls:4,vars:7,consts:[[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[2,"font-size","13px"],[1,"rate-header"],["type","button",1,"btn-rate-toggle"],[1,"fas",3,"ngClass","click"],[3,"title"],[1,"control-area"],[1,"ul-rate-detail"],[1,"ul-rate-control"],["type","button",1,"btn-rate-control",3,"click"],[3,"roomData","contractData","monthInfo","openPlanDetailEvent","openRoomDetailEvent","openPromotionDetailEvent","openRateDetailEvent","openCalendarDetailEvent"]],template:function(e,t){1&e&&(Ne.Nc(0,fn,4,0,"tbody",0),Ne.ic(1,"async"),Ne.Nc(2,Sn,27,17,"tbody",1),Ne.ic(3,"async")),2&e&&(Ne.pc("ngIf",!Ne.jc(1,3,t.gridState$)),Ne.Cb(2),Ne.pc("ngForOf",Ne.jc(3,5,t.gridState$))("ngForTrackBy",t.trackByContractTypeItem))},directives:[i.o,i.n,i.l,hn],pipes:[i.b],styles:["","[_nghost-%COMP%] {\n        display: contents;\n      }"],changeDetection:0}),e})();const On=["calendar"],Rn=["dateController"];function kn(e,t){1&e&&Ne.Rb(0,"col",16)}function Tn(e,t){if(1&e&&(Ne.Wb(0,"option",17),Ne.Pc(1),Ne.Vb()),2&e){const e=t.$implicit;Ne.pc("ngValue",e.value),Ne.Cb(1),Ne.Rc(" ",e.label," ")}}function Vn(e,t){if(1&e&&(Ne.Wb(0,"option",17),Ne.Pc(1),Ne.Vb()),2&e){const e=t.$implicit;Ne.pc("ngValue",e.value),Ne.Cb(1),Ne.Rc(" ",e.label," ")}}const Nn=function(e){return{today:e}};function Fn(e,t){if(1&e&&(Ne.Wb(0,"th",18),Ne.Wb(1,"p",19),Ne.Pc(2),Ne.Vb(),Ne.Wb(3,"p",20),Ne.Pc(4),Ne.Vb(),Ne.Vb()),2&e){const e=t.$implicit,n=t.index;Ne.Eb("calendarItem "+e.day.toLowerCase()),Ne.qc("id",n+1),Ne.pc("ngClass",Ne.uc(6,Nn,e.isToday)),Ne.Cb(2),Ne.Qc(e.day),Ne.Cb(2),Ne.Qc(e.date)}}Le.a.locale("en");let An=(()=>{class e{constructor(e){this.store=e,this.openPlanDetailEvent=new Ne.n,this.openRoomDetailEvent=new Ne.n,this.openRateDetailEvent=new Ne.n,this.openAllotmentDetailEvent=new Ne.n,this.openPromotionDetailEvent=new Ne.n,this.openStopSaleDetailEvent=new Ne.n,this.openCalendarDetailEvent=new Ne.n,this.unsubscribe$=new ge.a,this.yearsOptions=[],this.monthsOptions=[1,2,3,4,5,6,7,8,9,10,11,12].map(e=>{const t=Ie.padStart(String(e),2,"0");return{label:t,value:t}}),this.searchCondition$=this.store.pipe(Object(l.u)(ie));for(let t=2023;t<=2032;t++)this.yearsOptions.push({label:String(t),value:String(t)})}get dateList(){const e=this.searchCondition.yearMonth;return Object(Xe.b)(e)}ngOnInit(){setTimeout(()=>{this.moveDateTo(Le()().date().toString())},100),this.searchCondition$.pipe(Object(De.a)(this.unsubscribe$),Object(Se.a)(e=>!Ie.isNil(e))).subscribe(e=>{var t,n;this.searchCondition=Ie.cloneDeep(e),this.currentMonth=null!==(t=this.searchCondition.yearMonth.slice(4,6))&&void 0!==t?t:"",this.currentYear=null!==(n=this.searchCondition.yearMonth.slice(0,4))&&void 0!==n?n:""})}ngOnDestroy(){this.unsubscribe$.next(null),this.unsubscribe$.complete()}openAllotmentDetailPopupHandler(e){this.openAllotmentDetailEvent.emit(e)}openStopSaleDetailPopupHandler(e){this.openStopSaleDetailEvent.emit(e)}openPlanDetailPopupHandler(e){this.openPlanDetailEvent.emit(e)}openRoomDetailPopupHandler(e){this.openRoomDetailEvent.emit(e)}openPromotionDetailPopupHandler(e){this.openPromotionDetailEvent.emit(e)}openRateDetailPopupHandler(e){this.openRateDetailEvent.emit(e)}openCalendarDetailPopupHandler(e){this.openCalendarDetailEvent.emit(e)}prevMonth(){var e,t;const n=Le()(String(this.searchCondition.yearMonth),"YYYYMM").subtract(1,"months").format("YYYYMM"),o=null!==(e=n.slice(4,6))&&void 0!==e?e:"",i=null!==(t=n.slice(0,4))&&void 0!==t?t:"",a=Ie.first(this.yearsOptions);Number(i)<Number(a.value)||(this.currentYear!=i&&(this.currentYear=i,this.changeYear()),this.currentYear=i,this.currentMonth=o,this.searchCondition.yearMonth=`${i}${o}`,this.changeMonth())}nextMonth(){var e,t;const n=Le()(String(this.searchCondition.yearMonth),"YYYYMM").add(1,"months").format("YYYYMM"),o=null!==(e=n.slice(4,6))&&void 0!==e?e:"",i=null!==(t=n.slice(0,4))&&void 0!==t?t:"",a=Ie.last(this.yearsOptions);Number(i)>Number(a.value)||(this.currentYear!=i&&(this.currentYear=i,this.changeYear()),this.currentYear=i,this.currentMonth=o,this.searchCondition.yearMonth=`${i}${o}`,this.changeMonth())}changeYear(){this.store.dispatch(F({year:this.currentYear}))}changeMonth(){this.store.dispatch(A({month:this.currentMonth}))}moveDateTo(e){const t=document.getElementById(e);t&&this.calendar.nativeElement.scrollTo({behavior:"smooth",left:t.offsetLeft-this.dateController.nativeElement.offsetWidth})}}return e.\u0275fac=function(t){return new(t||e)(Ne.Qb(l.h))},e.\u0275cmp=Ne.Kb({type:e,selectors:[["app-calendar"]],viewQuery:function(e,t){var n;1&e&&(Ne.Xc(On,!0),Ne.Xc(Rn,!0)),2&e&&(Ne.Dc(n=Ne.gc())&&(t.calendar=n.first),Ne.Dc(n=Ne.gc())&&(t.dateController=n.first))},outputs:{openPlanDetailEvent:"openPlanDetailEvent",openRoomDetailEvent:"openRoomDetailEvent",openRateDetailEvent:"openRateDetailEvent",openAllotmentDetailEvent:"openAllotmentDetailEvent",openPromotionDetailEvent:"openPromotionDetailEvent",openStopSaleDetailEvent:"openStopSaleDetailEvent",openCalendarDetailEvent:"openCalendarDetailEvent"},decls:25,vars:7,consts:[[1,"rate-allotment"],["calendar",""],[2,"z-index","1"],["width","400px"],["width","90px",4,"ngFor","ngForOf"],["dateController",""],[1,"cal-wrap"],[1,"btn-cal-prev",3,"click"],["src","../../assets/images/common/ico-tabs-prev.png","alt","\uc774\uc804"],[1,"select-box"],[3,"ngModel","ngModelChange","change"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"btn-cal-next",3,"click"],["src","../../assets/images/common/ico-tabs-next.png","alt","\ub2e4\uc74c"],[3,"ngClass","class","id",4,"ngFor","ngForOf"],[3,"monthInfo","openPlanDetailEvent","openRoomDetailEvent","openRateDetailEvent","openAllotmentDetailEvent","openStopSaleDetailEvent","openPromotionDetailEvent","openCalendarDetailEvent"],["width","90px"],[3,"ngValue"],[3,"ngClass","id"],[1,"week-day"],[1,"day"]],template:function(e,t){1&e&&(Ne.Wb(0,"div",0,1),Ne.Wb(2,"table",2),Ne.Wb(3,"caption"),Ne.Pc(4," Rate Allotment Detail "),Ne.Vb(),Ne.Wb(5,"colgroup"),Ne.Rb(6,"col",3),Ne.Nc(7,kn,1,0,"col",4),Ne.Vb(),Ne.Wb(8,"thead"),Ne.Wb(9,"tr"),Ne.Wb(10,"th",null,5),Ne.Wb(12,"div",6),Ne.Wb(13,"a",7),Ne.fc("click",(function(){return t.prevMonth()})),Ne.Rb(14,"img",8),Ne.Vb(),Ne.Wb(15,"div",9),Ne.Wb(16,"select",10),Ne.fc("ngModelChange",(function(e){return t.currentYear=e}))("change",(function(){return t.changeYear()})),Ne.Nc(17,Tn,2,2,"option",11),Ne.Vb(),Ne.Vb(),Ne.Wb(18,"div",9),Ne.Wb(19,"select",10),Ne.fc("ngModelChange",(function(e){return t.currentMonth=e}))("change",(function(){return t.changeMonth()})),Ne.Nc(20,Vn,2,2,"option",11),Ne.Vb(),Ne.Vb(),Ne.Wb(21,"a",12),Ne.fc("click",(function(){return t.nextMonth()})),Ne.Rb(22,"img",13),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Nc(23,Fn,5,8,"th",14),Ne.Vb(),Ne.Vb(),Ne.Wb(24,"app-collection",15),Ne.fc("openPlanDetailEvent",(function(e){return t.openPlanDetailPopupHandler(e)}))("openRoomDetailEvent",(function(e){return t.openRoomDetailPopupHandler(e)}))("openRateDetailEvent",(function(e){return t.openRateDetailPopupHandler(e)}))("openAllotmentDetailEvent",(function(e){return t.openAllotmentDetailPopupHandler(e)}))("openStopSaleDetailEvent",(function(e){return t.openStopSaleDetailPopupHandler(e)}))("openPromotionDetailEvent",(function(e){return t.openPromotionDetailPopupHandler(e)}))("openCalendarDetailEvent",(function(e){return t.openCalendarDetailPopupHandler(e)})),Ne.Vb(),Ne.Vb(),Ne.Vb()),2&e&&(Ne.Cb(7),Ne.pc("ngForOf",t.dateList),Ne.Cb(9),Ne.pc("ngModel",t.currentYear),Ne.Cb(1),Ne.pc("ngForOf",t.yearsOptions),Ne.Cb(2),Ne.pc("ngModel",t.currentMonth),Ne.Cb(1),Ne.pc("ngForOf",t.monthsOptions),Ne.Cb(3),Ne.pc("ngForOf",t.dateList),Ne.Cb(1),Ne.pc("monthInfo",t.dateList))},directives:[i.n,a.y,a.r,a.u,In,a.v,a.A,i.l],styles:[".calendarWrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between}.calendarWrapper[_ngcontent-%COMP%]   .selectContainer[_ngcontent-%COMP%]{display:flex;width:100%;gap:8px;padding-left:300px}.calendarWrapper[_ngcontent-%COMP%]   .selectContainer[_ngcontent-%COMP%]   app-selectbox[_ngcontent-%COMP%]{max-width:200px}.calendarWrapper[_ngcontent-%COMP%]   .selectContainer[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:26px;height:26px;background-color:#fff;border:1px solid #d7d7d7;display:flex;align-items:center;justify-content:center}.calendarWrapper[_ngcontent-%COMP%]   .calendarContainer[_ngcontent-%COMP%]{display:flex;margin-top:12px}.calendarWrapper[_ngcontent-%COMP%]   .calendarContainer[_ngcontent-%COMP%]   .calendarItem[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;gap:4px;max-width:100px;min-width:100px}.calendarWrapper[_ngcontent-%COMP%]   .calendarContainer[_ngcontent-%COMP%]   .calendarItem.sat[_ngcontent-%COMP%]{color:#00f}.calendarWrapper[_ngcontent-%COMP%]   .calendarContainer[_ngcontent-%COMP%]   .calendarItem.sun[_ngcontent-%COMP%]{color:red}.calendarWrapper[_ngcontent-%COMP%]   .calendarContainer[_ngcontent-%COMP%]   .calendarItem.today[_ngcontent-%COMP%]{border:1px solid #888}"],changeDetection:0}),e})();var Ln=n("kDLv"),En=n("bKIL"),Wn=n("RtN6");n("AytR");const _n={ROOM:0,PROMOTION:1},xn={CONTRACT:"CTR",GROSS:"GRS",NET:"NET"};var jn=n("/uUt");let Yn=(()=>{class e{constructor(e){this.fb=e,this.generateRatePutForm=()=>this.fb.group({hotelCode:[null,[a.z.required]],ratePeriod:this.fb.group({periods:this.fb.array([]),includeDates:[],excludeDates:[]}),roomTypePlans:null}),this.generateSubmitPlanFormGroup=()=>this.fb.group({roomPlanFormListFormArray:this.fb.array([]),promotionPlanFormListFormArray:this.fb.array([])}),this.generateRatePlanNetGroup=(e,t)=>{const n=this.fb.group({vendorRoomTypeSeq:[null,[a.z.required]],vendorRoomPlanSeq:[null,[a.z.required]],currencyCode:[null],adultCount:[0,[a.z.required]],vendorNetAmount:[null,[a.z.required]],vendorTaxAmount:[{value:0,disabled:!e},[a.z.required]],vendorGrossAmount:[{value:null,disabled:!0}],vendorMspAmount:null,vendorContractAmount:null,roomPlanNameEn:null,promotionPlanNameEn:null,vendorRoomTypeNameEn:null,vendorSellingNetRate:null,vendorSellingNetAmount:null,salesStopYn:[!1,[a.z.required]]});if(t){const e=n.controls.vendorContractAmount;e.setValidators([a.z.required]),e.updateValueAndValidity()}return n},this.generateRatePlanGrossGroup=(e,t)=>{const n=this.fb.group({vendorRoomTypeSeq:[null,[a.z.required]],vendorRoomPlanSeq:[null,[a.z.required]],currencyCode:[null],adultCount:[0,[a.z.required]],vendorNetAmount:[{value:null,disabled:!0},[a.z.required]],vendorTaxAmount:[{value:0,disabled:!e},[a.z.required]],vendorGrossAmount:null,vendorMspAmount:[{value:null,disabled:!0}],vendorContractAmount:null,roomPlanNameEn:null,promotionPlanNameEn:null,vendorRoomTypeNameEn:null,vendorSellingNetRate:null,vendorSellingNetAmount:null,salesStopYn:[!1,[a.z.required]]});if(t){const e=n.controls.vendorContractAmount;e.setValidators([a.z.required]),e.updateValueAndValidity()}return n},this.initRoomTypePlanKeysDefaultData=()=>({vendorRoomTypeSeq:null,vendorRoomPlanSeq:null,adultCount:null,vendorNetAmount:null,vendorSellingNetAmount:null,vendorTaxAmount:null,vendorGrossAmount:null,vendorMspAmount:null,vendorContractAmount:null,salesStopYn:null}),this.generatePeriodGroups=()=>this.fb.group({appliedFromDate:[null],appliedToDate:[null],appliedMonYn:[!0],appliedTueYn:[!0],appliedWedYn:[!0],appliedThuYn:[!0],appliedFriYn:[!0],appliedSatYn:[!0],appliedSunYn:[!0]},{validators:this.compareDatesValidators("dateRangeCompare",["appliedFromDate","appliedToDate"])}),this.setPeriodGroups=e=>this.fb.group(e)}compareDatesValidators(e,t){return n=>{if(!n)return null;const o=n,i=t.length,a=t.map(e=>o.get(e).value);let r=!1;return a.forEach((e,t)=>{if(!r&&t+1<i){const n=a[t+1];r=Ie.isNil(e)||Ie.isNil(n)?!Ie.isNil(e)||!Ie.isNil(n):Le()(n).isBefore(Le()(e))}}),r?{[e]:!0}:null}}}return e.\u0275fac=function(t){return new(t||e)(Ne.bc(a.f))},e.\u0275prov=Ne.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Mn=n("gbCm");function $n(e,t){if(1&e&&(Ne.Ub(0),Ne.Wb(1,"dl"),Ne.Wb(2,"dt"),Ne.Pc(3,"Rate(%)"),Ne.Vb(),Ne.Wb(4,"dd"),Ne.Rb(5,"app-input-text",18),Ne.Vb(),Ne.Vb(),Ne.Wb(6,"dl"),Ne.Wb(7,"dt"),Ne.Pc(8,"V.Selling Net"),Ne.Vb(),Ne.Wb(9,"dd"),Ne.Rb(10,"app-input-text",19),Ne.Vb(),Ne.Vb(),Ne.Tb()),2&e){const e=Ne.hc().index,t=Ne.hc();Ne.Cb(5),Ne.pc("isInvalid",t.checkIsRoomPlanListInvalid(e,"vendorSellingNetRate")),Ne.Cb(5),Ne.pc("inputFormat","currency")("isInvalid",t.checkIsRoomPlanListInvalid(e,"vendorSellingNetAmount"))}}function qn(e,t){1&e&&(Ne.Ub(0),Ne.Wb(1,"sup"),Ne.Pc(2,"Contract"),Ne.Vb(),Ne.Tb())}function wn(e,t){1&e&&(Ne.Ub(0),Ne.Pc(1," Contract "),Ne.Tb())}function Hn(e,t){if(1&e&&(Ne.Wb(0,"div",8),Ne.Ub(1,9),Ne.Wb(2,"div",10),Ne.Pc(3),Ne.Vb(),Ne.Wb(4,"div",11),Ne.Wb(5,"dl"),Ne.Wb(6,"dt"),Ne.Wb(7,"sup"),Ne.Pc(8,"Net"),Ne.Vb(),Ne.Vb(),Ne.Wb(9,"dd"),Ne.Rb(10,"app-input-text",12),Ne.Vb(),Ne.Vb(),Ne.Nc(11,$n,11,3,"ng-container",13),Ne.Wb(12,"dl"),Ne.Wb(13,"dt"),Ne.Wb(14,"sup"),Ne.Pc(15,"Extra Tax"),Ne.Vb(),Ne.Vb(),Ne.Wb(16,"dd"),Ne.Rb(17,"app-input-text",14),Ne.Vb(),Ne.Vb(),Ne.Wb(18,"dl"),Ne.Wb(19,"dt"),Ne.Pc(20,"Gross"),Ne.Vb(),Ne.Wb(21,"dd"),Ne.Rb(22,"app-input-text",15),Ne.Vb(),Ne.Vb(),Ne.Wb(23,"dl"),Ne.Wb(24,"dt"),Ne.Pc(25,"MSP"),Ne.Vb(),Ne.Wb(26,"dd"),Ne.Rb(27,"app-input-text",16),Ne.Vb(),Ne.Vb(),Ne.Wb(28,"dl"),Ne.Wb(29,"dt"),Ne.Nc(30,qn,3,0,"ng-container",13),Ne.Nc(31,wn,2,0,"ng-container",13),Ne.Vb(),Ne.Wb(32,"dd"),Ne.Rb(33,"app-input-text",17),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Tb(),Ne.Vb()),2&e){const e=t.$implicit,n=t.index,o=Ne.hc();Ne.Cb(1),Ne.qc("formGroupName",n),Ne.Cb(2),Ne.Qc(e.value.roomPlanNameEn),Ne.Cb(7),Ne.pc("inputFormat","currency")("isInvalid",o.checkIsRoomPlanListInvalid(n,"vendorNetAmount")),Ne.Cb(1),Ne.pc("ngIf",o.isExclusiveRate),Ne.Cb(6),Ne.pc("inputFormat","currency")("isInvalid",o.checkIsRoomPlanListInvalid(n,"vendorTaxAmount")),Ne.Cb(5),Ne.pc("inputFormat","currency")("isInvalid",o.checkIsRoomPlanListInvalid(n,"vendorGrossAmount")),Ne.Cb(5),Ne.pc("inputFormat","currency")("isInvalid",o.checkIsRoomPlanListInvalid(n,"vendorMspAmount")),Ne.Cb(3),Ne.pc("ngIf",o.isSendAmountTypeCodeRequired),Ne.Cb(1),Ne.pc("ngIf",!o.isSendAmountTypeCodeRequired),Ne.Cb(2),Ne.pc("inputFormat","currency")("isInvalid",o.checkIsRoomPlanListInvalid(n,"vendorContractAmount"))}}function Un(e,t){if(1&e&&(Ne.Ub(0),Ne.Wb(1,"dl"),Ne.Wb(2,"dt"),Ne.Pc(3,"Rate(%)"),Ne.Vb(),Ne.Wb(4,"dd"),Ne.Rb(5,"app-input-text",18),Ne.Vb(),Ne.Vb(),Ne.Wb(6,"dl"),Ne.Wb(7,"dt"),Ne.Pc(8,"V.Selling Net"),Ne.Vb(),Ne.Wb(9,"dd"),Ne.Rb(10,"app-input-text",19),Ne.Vb(),Ne.Vb(),Ne.Tb()),2&e){const e=Ne.hc().index,t=Ne.hc();Ne.Cb(5),Ne.pc("isInvalid",t.checkIsPromotionPlanListInvalid(e,"vendorSellingNetRate")),Ne.Cb(5),Ne.pc("inputFormat","currency")("isInvalid",t.checkIsPromotionPlanListInvalid(e,"vendorSellingNetAmount"))}}function Gn(e,t){1&e&&(Ne.Ub(0),Ne.Wb(1,"sup"),Ne.Pc(2,"Contract"),Ne.Vb(),Ne.Tb())}function Bn(e,t){1&e&&(Ne.Ub(0),Ne.Pc(1," Contract "),Ne.Tb())}function Xn(e,t){if(1&e&&(Ne.Wb(0,"div",8),Ne.Ub(1,9),Ne.Rb(2,"div",20),Ne.Wb(3,"div",11),Ne.Wb(4,"dl"),Ne.Wb(5,"dt"),Ne.Wb(6,"sup"),Ne.Pc(7,"Net"),Ne.Vb(),Ne.Vb(),Ne.Wb(8,"dd"),Ne.Rb(9,"app-input-text",12),Ne.Vb(),Ne.Vb(),Ne.Nc(10,Un,11,3,"ng-container",13),Ne.Wb(11,"dl"),Ne.Wb(12,"dt"),Ne.Wb(13,"sup"),Ne.Pc(14,"Extra Tax"),Ne.Vb(),Ne.Vb(),Ne.Wb(15,"dd"),Ne.Rb(16,"app-input-text",14),Ne.Vb(),Ne.Vb(),Ne.Wb(17,"dl"),Ne.Wb(18,"dt"),Ne.Pc(19,"Gross"),Ne.Vb(),Ne.Wb(20,"dd"),Ne.Rb(21,"app-input-text",15),Ne.Vb(),Ne.Vb(),Ne.Wb(22,"dl"),Ne.Wb(23,"dt"),Ne.Pc(24,"MSP"),Ne.Vb(),Ne.Wb(25,"dd"),Ne.Rb(26,"app-input-text",16),Ne.Vb(),Ne.Vb(),Ne.Wb(27,"dl"),Ne.Wb(28,"dt"),Ne.Nc(29,Gn,3,0,"ng-container",13),Ne.Nc(30,Bn,2,0,"ng-container",13),Ne.Vb(),Ne.Wb(31,"dd"),Ne.Rb(32,"app-input-text",17),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Tb(),Ne.Vb()),2&e){const e=t.$implicit,n=t.index,o=Ne.hc();Ne.Cb(1),Ne.qc("formGroupName",n),Ne.Cb(1),Ne.pc("innerHTML",o.convertPromotionTitleToHtml(e.value.promotionPlanNameEn),Ne.Gc),Ne.Cb(7),Ne.pc("inputFormat","currency")("isInvalid",o.checkIsPromotionPlanListInvalid(n,"vendorNetAmount")),Ne.Cb(1),Ne.pc("ngIf",o.isExclusiveRate),Ne.Cb(6),Ne.pc("inputFormat","currency")("isInvalid",o.checkIsPromotionPlanListInvalid(n,"vendorTaxAmount")),Ne.Cb(5),Ne.pc("inputFormat","currency")("isInvalid",o.checkIsPromotionPlanListInvalid(n,"vendorGrossAmount")),Ne.Cb(5),Ne.pc("inputFormat","currency")("isInvalid",o.checkIsPromotionPlanListInvalid(n,"vendorMspAmount")),Ne.Cb(3),Ne.pc("ngIf",o.isSendAmountTypeCodeRequired),Ne.Cb(1),Ne.pc("ngIf",!o.isSendAmountTypeCodeRequired),Ne.Cb(2),Ne.pc("inputFormat","currency")("isInvalid",o.checkIsPromotionPlanListInvalid(n,"vendorContractAmount"))}}function zn(e,t){1&e&&(Ne.Wb(0,"p",21),Ne.Pc(1," No selected item.\n"),Ne.Vb())}let Qn=(()=>{class e{constructor(e,t){this._dataService=e,this._formService=t,this.isUpdateModal=!1,this.isSendAmountTypeCodeRequired=!1,this._PLAN_TYPE=_n,this._BOOKING_SEND_AMOUNT_TYPE_CODE=xn,this._checkValid=!1,this._destroy$=new ge.a,this.submitForm=this._dataService.generateSubmitPlanFormGroup()}get checkedRoomPlanList(){return this._checkedRoomPlanList}set checkedRoomPlanList(e){var t;this._checkedRoomPlanList=e,this._destroyByCheckedRoomPlanList$&&(this._destroyByCheckedRoomPlanList$.next(),this._destroyByCheckedRoomPlanList$.complete()),this._destroyByCheckedRoomPlanList$=new ge.a,this.roomPlanFormListFormArray.clear();for(const n of this._checkedRoomPlanList){const e=n.sendAmountTypeCode===this._BOOKING_SEND_AMOUNT_TYPE_CODE.CONTRACT;this.isSendAmountTypeCodeRequired=e;const o=this._dataService.generateRatePlanNetGroup(null===(t=this.hotelContractInfo)||void 0===t?void 0:t.extraTaxPaymentYn,e);if(o.patchValue(n),this.isUpdateModal){const e=this._getVendorSellingNetRate(this.hotelContractInfo);o.patchValue(this.hotelContractInfo),o.patchValue({vendorSellingNetRate:e})}this._addSubscribeRoomPlanFormGroup(o),this.roomPlanFormListFormArray.push(o)}}get checkedPromotionPlanList(){return this._checkedPromotionPlanList}set checkedPromotionPlanList(e){var t;this._checkedPromotionPlanList=e,this._destroyByCheckedPromotionPlanList$&&(this._destroyByCheckedPromotionPlanList$.next(),this._destroyByCheckedPromotionPlanList$.complete()),this._destroyByCheckedPromotionPlanList$=new ge.a,this.promotionPlanFormListFormArray.clear();for(const n of this._checkedPromotionPlanList){const e=n.sendAmountTypeCode===this._BOOKING_SEND_AMOUNT_TYPE_CODE.CONTRACT;this.isSendAmountTypeCodeRequired=e;const o=this._dataService.generateRatePlanNetGroup(null===(t=this.hotelContractInfo)||void 0===t?void 0:t.extraTaxPaymentYn,e);if(o.patchValue(n),this.isUpdateModal){const e=this._getVendorSellingNetRate(this.hotelContractInfo);o.patchValue(this.hotelContractInfo),o.patchValue({vendorSellingNetRate:e})}this._addSubscribePromotionPlanFormGroup(o),this.promotionPlanFormListFormArray.push(o)}}get roomPlanFormListFormArray(){return this.submitForm.controls.roomPlanFormListFormArray}get promotionPlanFormListFormArray(){return this.submitForm.controls.promotionPlanFormListFormArray}get isExclusiveRate(){var e,t;return!("HOC01"!==(null===(e=this.checkedRoomPlanList[0])||void 0===e?void 0:e.hotelContractTypeCode)&&"HOC01"!==(null===(t=this.checkedPromotionPlanList[0])||void 0===t?void 0:t.hotelContractTypeCode))}get isNoItem(){return Ie.isEmpty(this.checkedRoomPlanList)&&Ie.isEmpty(this.checkedPromotionPlanList)}ngOnInit(){}ngOnDestroy(){this._destroyByCheckedRoomPlanList$&&(this._destroyByCheckedRoomPlanList$.next(),this._destroyByCheckedRoomPlanList$.complete()),this._destroyByCheckedPromotionPlanList$&&(this._destroyByCheckedPromotionPlanList$.next(),this._destroyByCheckedPromotionPlanList$.complete()),this._destroy$.next(),this._destroy$.complete()}checkIsRoomPlanListInvalid(e,t){return this._checkValid&&this.roomPlanFormListFormArray.at(e).get(t)&&this.roomPlanFormListFormArray.at(e).get(t).invalid}checkIsPromotionPlanListInvalid(e,t){return this._checkValid&&this.promotionPlanFormListFormArray.at(e).get(t)&&this.promotionPlanFormListFormArray.at(e).get(t).invalid}convertPromotionTitleToHtml(e){const t=e.split(":"),n=t.length,o=t.reduce((e,t,o)=>o+1>=n?e:e+=t,""),i=t[n-1];return`<span class="font-weight-bold">${o.trim()}</span><br /><span>${i.trim()}</span>`}makeSubmitFormData(){if(this.submitForm.invalid)return this._checkValid=!0,this.roomPlanFormListFormArray.controls.forEach(e=>{Object.keys(e.controls).forEach(t=>{e.controls[t].invalid&&console.error(t+" is invalid")})}),void this.promotionPlanFormListFormArray.controls.forEach(e=>{Object.keys(e.controls).forEach(t=>{e.controls[t].invalid&&console.error(t+" is invalid")})});const e=this._dataService.initRoomTypePlanKeysDefaultData(),t=this._formService.fitFormArrayDataToDefaultData(this.roomPlanFormListFormArray.getRawValue(),e),n=this._formService.fitFormArrayDataToDefaultData(this.promotionPlanFormListFormArray.getRawValue(),e),o=[].concat(t,n);return this._checkValid=!1,o}_addSubscribeRoomPlanFormGroup(e){const t=e.get("vendorSellingNetAmount");e.get("vendorSellingNetRate").valueChanges.pipe(Object(De.a)(this._destroy$),Object(De.a)(this._destroyByCheckedRoomPlanList$),Object(jn.a)()).subscribe(n=>{const o=e.get("vendorNetAmount").value;t.patchValue(o*(1+.01*n))})}_addSubscribePromotionPlanFormGroup(e){const t=e.get("vendorSellingNetAmount");e.get("vendorSellingNetRate").valueChanges.pipe(Object(De.a)(this._destroy$),Object(De.a)(this._destroyByCheckedPromotionPlanList$),Object(jn.a)()).subscribe(n=>{const o=e.get("vendorNetAmount").value;t.patchValue(o*(1+.01*n))})}_getVendorSellingNetRate(e){return Ie.round(100*(e.vendorSellingNetAmount-e.vendorNetAmount)/e.vendorNetAmount,2)||null}}return e.\u0275fac=function(t){return new(t||e)(Ne.Qb(Yn),Ne.Qb(We.a))},e.\u0275cmp=Ne.Kb({type:e,selectors:[["app-rate-detail-selected-rate-plan-net"]],inputs:{isUpdateModal:"isUpdateModal",hotelContractInfo:"hotelContractInfo",checkedDateInfo:"checkedDateInfo",checkedRoomPlanList:"checkedRoomPlanList",checkedPromotionPlanList:"checkedPromotionPlanList"},decls:19,vars:6,consts:[[1,"page-item-header"],[1,"promotion-rate-summary"],[1,"align-r","font-size-sm","color-dark-color4","mb5"],[3,"formGroup"],["formArrayName","roomPlanFormListFormArray"],["class","input-contents-item",4,"ngFor","ngForOf"],["formArrayName","promotionPlanFormListFormArray"],["style","text-align: center; font-size: 13px",4,"ngIf"],[1,"input-contents-item"],[3,"formGroupName"],[1,"title"],[1,"input-contents-area"],["formControlName","vendorNetAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],[4,"ngIf"],["formControlName","vendorTaxAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],["formControlName","vendorGrossAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],["formControlName","vendorMspAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],["formControlName","vendorContractAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],["formControlName","vendorSellingNetRate","valueType","number","placeholder","0.00",3,"isInvalid"],["formControlName","vendorSellingNetAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],[1,"title",3,"innerHTML"],[2,"text-align","center","font-size","13px"]],template:function(e,t){1&e&&(Ne.Wb(0,"div",0),Ne.Wb(1,"strong"),Ne.Wb(2,"sup"),Ne.Pc(3,"Select Room Plan or Promotion Rate Plan"),Ne.Vb(),Ne.Vb(),Ne.Wb(4,"ul",1),Ne.Wb(5,"li"),Ne.Pc(6),Ne.Vb(),Ne.Wb(7,"li"),Ne.Pc(8,"NET"),Ne.Vb(),Ne.Wb(9,"li"),Ne.Pc(10),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Wb(11,"p",2),Ne.Pc(12,'The extra tax field can use in case of "Extra Tax Payment : Y " only'),Ne.Vb(),Ne.Ub(13,3),Ne.Ub(14,4),Ne.Nc(15,Hn,34,15,"div",5),Ne.Tb(),Ne.Ub(16,6),Ne.Nc(17,Xn,33,15,"div",5),Ne.Tb(),Ne.Tb(),Ne.Nc(18,zn,2,0,"p",7)),2&e&&(Ne.Cb(6),Ne.Rc("Curr : ",null==t.hotelContractInfo?null:t.hotelContractInfo.currencyCode,""),Ne.Cb(4),Ne.Rc("Extra Tax Payment : ",null!=t.hotelContractInfo&&t.hotelContractInfo.extraTaxPaymentYn?"Y":"N",""),Ne.Cb(3),Ne.pc("formGroup",t.submitForm),Ne.Cb(2),Ne.pc("ngForOf",null==t.roomPlanFormListFormArray?null:t.roomPlanFormListFormArray.controls),Ne.Cb(2),Ne.pc("ngForOf",null==t.promotionPlanFormListFormArray?null:t.promotionPlanFormListFormArray.controls),Ne.Cb(1),Ne.pc("ngIf",t.isNoItem))},directives:[a.s,a.k,a.e,i.n,i.o,a.l,Mn.a,a.r,a.i],styles:['.page-item-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.ul-rate-detail[_ngcontent-%COMP%]{display:flex;color:#ff682c;font-size:12px}.ul-rate-detail[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:not(:last-child):after{content:"|";color:#262626;margin:0 12px}.title[_ngcontent-%COMP%]{white-space:break-spaces}textarea[_ngcontent-%COMP%]:-moz-read-only{background-color:#f5f5f5}textarea[_ngcontent-%COMP%]:read-only{background-color:#f5f5f5}']}),e})();function Kn(e,t){if(1&e&&(Ne.Ub(0),Ne.Wb(1,"dl"),Ne.Wb(2,"dt"),Ne.Pc(3,"Rate(%)"),Ne.Vb(),Ne.Wb(4,"dd"),Ne.Rb(5,"app-input-text",18),Ne.Vb(),Ne.Vb(),Ne.Wb(6,"dl"),Ne.Wb(7,"dt"),Ne.Pc(8,"V.Selling Net"),Ne.Vb(),Ne.Wb(9,"dd"),Ne.Rb(10,"app-input-text",19),Ne.Vb(),Ne.Vb(),Ne.Tb()),2&e){const e=Ne.hc().index,t=Ne.hc();Ne.Cb(5),Ne.pc("isInvalid",t.checkIsRoomPlanListInvalid(e,"vendorSellingNetRate")),Ne.Cb(5),Ne.pc("inputFormat","currency")("isInvalid",t.checkIsRoomPlanListInvalid(e,"vendorSellingNetAmount"))}}function Jn(e,t){1&e&&(Ne.Ub(0),Ne.Wb(1,"sup"),Ne.Pc(2,"Contract"),Ne.Vb(),Ne.Tb())}function Zn(e,t){1&e&&(Ne.Ub(0),Ne.Pc(1," Contract "),Ne.Tb())}function eo(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"div",8),Ne.Ub(1,9),Ne.Wb(2,"div",10),Ne.Pc(3),Ne.Vb(),Ne.Wb(4,"div",11),Ne.Wb(5,"dl"),Ne.Wb(6,"dt"),Ne.Wb(7,"sup"),Ne.Pc(8,"Net"),Ne.Vb(),Ne.Vb(),Ne.Wb(9,"dd"),Ne.Rb(10,"app-input-text",12),Ne.Vb(),Ne.Vb(),Ne.Nc(11,Kn,11,3,"ng-container",13),Ne.Wb(12,"dl"),Ne.Wb(13,"dt"),Ne.Wb(14,"sup"),Ne.Pc(15,"Extra Tax"),Ne.Vb(),Ne.Vb(),Ne.Wb(16,"dd"),Ne.Rb(17,"app-input-text",14),Ne.Vb(),Ne.Vb(),Ne.Wb(18,"dl"),Ne.Wb(19,"dt"),Ne.Pc(20,"Gross"),Ne.Vb(),Ne.Wb(21,"dd"),Ne.Wb(22,"app-input-text",15),Ne.fc("input",(function(n){Ne.Fc(e);const o=t.index,i=Ne.hc();return i.calculateVendorNetAmountByGross(n.target.value,i._PLAN_TYPE.ROOM,o)})),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Wb(23,"dl"),Ne.Wb(24,"dt"),Ne.Pc(25,"MSP"),Ne.Vb(),Ne.Wb(26,"dd"),Ne.Rb(27,"app-input-text",16),Ne.Vb(),Ne.Vb(),Ne.Wb(28,"dl"),Ne.Wb(29,"dt"),Ne.Nc(30,Jn,3,0,"ng-container",13),Ne.Nc(31,Zn,2,0,"ng-container",13),Ne.Vb(),Ne.Wb(32,"dd"),Ne.Rb(33,"app-input-text",17),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Tb(),Ne.Vb()}if(2&e){const e=t.$implicit,n=t.index,o=Ne.hc();Ne.Cb(1),Ne.qc("formGroupName",n),Ne.Cb(2),Ne.Qc(e.value.roomPlanNameEn),Ne.Cb(7),Ne.pc("inputFormat","currency")("isInvalid",o.checkIsRoomPlanListInvalid(n,"vendorNetAmount")),Ne.Cb(1),Ne.pc("ngIf",o.isExclusiveRate),Ne.Cb(6),Ne.pc("inputFormat","currency")("isInvalid",o.checkIsRoomPlanListInvalid(n,"vendorTaxAmount")),Ne.Cb(5),Ne.pc("inputFormat","currency")("isInvalid",o.checkIsRoomPlanListInvalid(n,"vendorGrossAmount")),Ne.Cb(5),Ne.pc("inputFormat","currency")("isInvalid",o.checkIsRoomPlanListInvalid(n,"vendorMspAmount")),Ne.Cb(3),Ne.pc("ngIf",o.isSendAmountTypeCodeRequired),Ne.Cb(1),Ne.pc("ngIf",!o.isSendAmountTypeCodeRequired),Ne.Cb(2),Ne.pc("inputFormat","currency")("isInvalid",o.checkIsRoomPlanListInvalid(n,"vendorContractAmount"))}}function to(e,t){if(1&e&&(Ne.Ub(0),Ne.Wb(1,"dl"),Ne.Wb(2,"dt"),Ne.Pc(3,"Rate(%)"),Ne.Vb(),Ne.Wb(4,"dd"),Ne.Rb(5,"app-input-text",18),Ne.Vb(),Ne.Vb(),Ne.Wb(6,"dl"),Ne.Wb(7,"dt"),Ne.Pc(8,"V.Selling Net"),Ne.Vb(),Ne.Wb(9,"dd"),Ne.Rb(10,"app-input-text",19),Ne.Vb(),Ne.Vb(),Ne.Tb()),2&e){const e=Ne.hc().index,t=Ne.hc();Ne.Cb(5),Ne.pc("isInvalid",t.checkIsPromotionPlanListInvalid(e,"vendorSellingNetRate")),Ne.Cb(5),Ne.pc("inputFormat","currency")("isInvalid",t.checkIsPromotionPlanListInvalid(e,"vendorSellingNetAmount"))}}function no(e,t){1&e&&(Ne.Ub(0),Ne.Wb(1,"sup"),Ne.Pc(2,"Contract"),Ne.Vb(),Ne.Tb())}function oo(e,t){1&e&&(Ne.Ub(0),Ne.Pc(1," Contract "),Ne.Tb())}function io(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"div",8),Ne.Ub(1,9),Ne.Wb(2,"div",20),Ne.Pc(3),Ne.Vb(),Ne.Wb(4,"div",11),Ne.Wb(5,"dl"),Ne.Wb(6,"dt"),Ne.Wb(7,"sup"),Ne.Pc(8,"Net"),Ne.Vb(),Ne.Vb(),Ne.Wb(9,"dd"),Ne.Rb(10,"app-input-text",12),Ne.Vb(),Ne.Vb(),Ne.Nc(11,to,11,3,"ng-container",13),Ne.Wb(12,"dl"),Ne.Wb(13,"dt"),Ne.Wb(14,"sup"),Ne.Pc(15,"Extra Tax"),Ne.Vb(),Ne.Vb(),Ne.Wb(16,"dd"),Ne.Rb(17,"app-input-text",14),Ne.Vb(),Ne.Vb(),Ne.Wb(18,"dl"),Ne.Wb(19,"dt"),Ne.Pc(20,"Gross"),Ne.Vb(),Ne.Wb(21,"dd"),Ne.Wb(22,"app-input-text",15),Ne.fc("input",(function(n){Ne.Fc(e);const o=t.index,i=Ne.hc();return i.calculateVendorNetAmountByGross(n.target.value,i._PLAN_TYPE.PROMOTION,o)})),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Wb(23,"dl"),Ne.Wb(24,"dt"),Ne.Pc(25,"MSP"),Ne.Vb(),Ne.Wb(26,"dd"),Ne.Rb(27,"app-input-text",16),Ne.Vb(),Ne.Vb(),Ne.Wb(28,"dl"),Ne.Wb(29,"dt"),Ne.Nc(30,no,3,0,"ng-container",13),Ne.Nc(31,oo,2,0,"ng-container",13),Ne.Vb(),Ne.Wb(32,"dd"),Ne.Rb(33,"app-input-text",17),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Tb(),Ne.Vb()}if(2&e){const e=t.$implicit,n=t.index,o=Ne.hc();Ne.Cb(1),Ne.qc("formGroupName",n),Ne.Cb(1),Ne.pc("innerHTML",o.convertPromotionTitleToHtml(e.value.promotionPlanNameEn),Ne.Gc),Ne.Cb(1),Ne.Qc(e.value.promotionPlanNameEn),Ne.Cb(7),Ne.pc("inputFormat","currency")("isInvalid",o.checkIsPromotionPlanListInvalid(n,"vendorNetAmount")),Ne.Cb(1),Ne.pc("ngIf",o.isExclusiveRate),Ne.Cb(6),Ne.pc("inputFormat","currency")("isInvalid",o.checkIsPromotionPlanListInvalid(n,"vendorTaxAmount")),Ne.Cb(5),Ne.pc("inputFormat","currency")("isInvalid",o.checkIsPromotionPlanListInvalid(n,"vendorGrossAmount")),Ne.Cb(5),Ne.pc("inputFormat","currency")("isInvalid",o.checkIsPromotionPlanListInvalid(n,"vendorMspAmount")),Ne.Cb(3),Ne.pc("ngIf",o.isSendAmountTypeCodeRequired),Ne.Cb(1),Ne.pc("ngIf",!o.isSendAmountTypeCodeRequired),Ne.Cb(2),Ne.pc("inputFormat","currency")("isInvalid",o.checkIsPromotionPlanListInvalid(n,"vendorContractAmount"))}}function ao(e,t){1&e&&(Ne.Wb(0,"p",21),Ne.Pc(1," No selected item.\n"),Ne.Vb())}let ro=(()=>{class e{constructor(e,t){this._dataService=e,this._formService=t,this.isUpdateModal=!1,this.isSendAmountTypeCodeRequired=!1,this._PLAN_TYPE=_n,this._BOOKING_SEND_AMOUNT_TYPE_CODE=xn,this._checkValid=!1,this._destroy$=new ge.a,this.submitForm=this._dataService.generateSubmitPlanFormGroup()}get checkedRoomPlanList(){return this._checkedRoomPlanList}set checkedRoomPlanList(e){var t;this._checkedRoomPlanList=e,this._destroyByCheckedRoomPlanList$&&(this._destroyByCheckedRoomPlanList$.next(),this._destroyByCheckedRoomPlanList$.complete()),this._destroyByCheckedRoomPlanList$=new ge.a,this.roomPlanFormListFormArray.clear();for(const n of this._checkedRoomPlanList){const e=n.sendAmountTypeCode===this._BOOKING_SEND_AMOUNT_TYPE_CODE.CONTRACT;this.isSendAmountTypeCodeRequired=e;const o=this._dataService.generateRatePlanGrossGroup(null===(t=this.hotelContractInfo)||void 0===t?void 0:t.extraTaxPaymentYn,e);if(o.patchValue(n),this.isUpdateModal){const e=this._getVendorSellingNetRate(this.hotelContractInfo);o.patchValue(this.hotelContractInfo),o.patchValue({vendorSellingNetRate:e})}this._addSubscribeRoomPlanFormGroup(o),this.roomPlanFormListFormArray.push(o)}}get checkedPromotionPlanList(){return this._checkedPromotionPlanList}set checkedPromotionPlanList(e){var t;this._checkedPromotionPlanList=e,this._destroyByCheckedPromotionPlanList$&&(this._destroyByCheckedPromotionPlanList$.next(),this._destroyByCheckedPromotionPlanList$.complete()),this._destroyByCheckedPromotionPlanList$=new ge.a,this.promotionPlanFormListFormArray.clear();for(const n of this._checkedPromotionPlanList){const e=n.sendAmountTypeCode===this._BOOKING_SEND_AMOUNT_TYPE_CODE.CONTRACT;this.isSendAmountTypeCodeRequired=e;const o=this._dataService.generateRatePlanGrossGroup(null===(t=this.hotelContractInfo)||void 0===t?void 0:t.extraTaxPaymentYn,e);if(o.patchValue(n),this.isUpdateModal){const e=this._getVendorSellingNetRate(this.hotelContractInfo);o.patchValue(this.hotelContractInfo),o.patchValue({vendorSellingNetRate:e})}this._addSubscribePromotionPlanFormGroup(o),this.promotionPlanFormListFormArray.push(o)}}get roomPlanFormListFormArray(){return this.submitForm.controls.roomPlanFormListFormArray}get promotionPlanFormListFormArray(){return this.submitForm.controls.promotionPlanFormListFormArray}get isExclusiveRate(){var e,t;return!("HOC01"!==(null===(e=this.checkedRoomPlanList[0])||void 0===e?void 0:e.hotelContractTypeCode)&&"HOC01"!==(null===(t=this.checkedPromotionPlanList[0])||void 0===t?void 0:t.hotelContractTypeCode))}get isNoItem(){return Ie.isEmpty(this.checkedRoomPlanList)&&Ie.isEmpty(this.checkedPromotionPlanList)}ngOnInit(){}ngOnDestroy(){this._destroyByCheckedRoomPlanList$&&(this._destroyByCheckedRoomPlanList$.next(),this._destroyByCheckedRoomPlanList$.complete()),this._destroyByCheckedPromotionPlanList$&&(this._destroyByCheckedPromotionPlanList$.next(),this._destroyByCheckedPromotionPlanList$.complete()),this._destroy$.next(),this._destroy$.complete()}calculateVendorNetAmountByGross(e,t,n){var o,i,a,r,l,c;const s=e.replace(/[^\d\.]/g,""),p=Number(s),d=p-p*((null!==(c=null!==(a=null===(i=null===(o=this.checkedDateInfo[0])||void 0===o?void 0:o.plans[0].params)||void 0===i?void 0:i.vendorCommRate)&&void 0!==a?a:null===(l=null===(r=this.checkedRoomPlanList)||void 0===r?void 0:r[0])||void 0===l?void 0:l.vendorCommRate)&&void 0!==c?c:0)/100),u=t===this._PLAN_TYPE.ROOM?this._getRoomPlanFormGroupByIndex(n):this._getPromotionPlanFormGroupByIndex(n),m=Number(d.toFixed("USD"===u.value.currencyCode||"EUR"===u.value.currencyCode?2:0));u.get("vendorNetAmount").patchValue(m)}checkIsRoomPlanListInvalid(e,t){return this._checkValid&&this.roomPlanFormListFormArray.at(e).get(t)&&this.roomPlanFormListFormArray.at(e).get(t).invalid}checkIsPromotionPlanListInvalid(e,t){return this._checkValid&&this.promotionPlanFormListFormArray.at(e).get(t)&&this.promotionPlanFormListFormArray.at(e).get(t).invalid}convertPromotionTitleToHtml(e){const t=e.split(":"),n=t.length,o=t.reduce((e,t,o)=>o+1>=n?e:e+=t,""),i=t[n-1];return`<span class="font-weight-bold">${o.trim()}</span><br /><span>${i.trim()}</span>`}makeSubmitFormData(){if(this.submitForm.invalid)return this._checkValid=!0,this.roomPlanFormListFormArray.controls.forEach(e=>{Object.keys(e.controls).forEach(t=>{e.controls[t].invalid&&console.error(t+" is invalid")})}),void this.promotionPlanFormListFormArray.controls.forEach(e=>{Object.keys(e.controls).forEach(t=>{e.controls[t].invalid&&console.error(t+" is invalid")})});const e=this._dataService.initRoomTypePlanKeysDefaultData(),t=this._formService.fitFormArrayDataToDefaultData(this.roomPlanFormListFormArray.getRawValue(),e),n=this._formService.fitFormArrayDataToDefaultData(this.promotionPlanFormListFormArray.getRawValue(),e),o=[].concat(t,n);return this._checkValid=!1,o}_addSubscribeRoomPlanFormGroup(e){const t=e.get("vendorSellingNetAmount");e.get("vendorSellingNetRate").valueChanges.pipe(Object(De.a)(this._destroy$),Object(De.a)(this._destroyByCheckedRoomPlanList$),Object(jn.a)()).subscribe(n=>{const o=e.get("vendorNetAmount").value;t.patchValue(o*(1+.01*n))})}_getRoomPlanFormGroupByIndex(e){return this.roomPlanFormListFormArray.at(e)}_addSubscribePromotionPlanFormGroup(e){const t=e.get("vendorSellingNetAmount");e.get("vendorSellingNetRate").valueChanges.pipe(Object(De.a)(this._destroy$),Object(De.a)(this._destroyByCheckedPromotionPlanList$),Object(jn.a)()).subscribe(n=>{const o=e.get("vendorNetAmount").value;t.patchValue(o*(1+.01*n))})}_getPromotionPlanFormGroupByIndex(e){return this.promotionPlanFormListFormArray.at(e)}_getVendorSellingNetRate(e){return Ie.round(100*(e.vendorSellingNetAmount-e.vendorNetAmount)/e.vendorNetAmount,2)}}return e.\u0275fac=function(t){return new(t||e)(Ne.Qb(Yn),Ne.Qb(We.a))},e.\u0275cmp=Ne.Kb({type:e,selectors:[["app-rate-detail-selected-rate-plan-gross"]],inputs:{isUpdateModal:"isUpdateModal",hotelContractInfo:"hotelContractInfo",checkedDateInfo:"checkedDateInfo",checkedRoomPlanList:"checkedRoomPlanList",checkedPromotionPlanList:"checkedPromotionPlanList"},decls:21,vars:7,consts:[[1,"page-item-header"],[1,"promotion-rate-summary"],[1,"align-r","font-size-sm","color-dark-color4","mb5"],[3,"formGroup"],["formArrayName","roomPlanFormListFormArray"],["class","input-contents-item",4,"ngFor","ngForOf"],["formArrayName","promotionPlanFormListFormArray"],["style","text-align: center; font-size: 13px",4,"ngIf"],[1,"input-contents-item"],[3,"formGroupName"],[1,"title"],[1,"input-contents-area"],["formControlName","vendorNetAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],[4,"ngIf"],["formControlName","vendorTaxAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],["formControlName","vendorGrossAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid","input"],["formControlName","vendorMspAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],["formControlName","vendorContractAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],["formControlName","vendorSellingNetRate","valueType","number","placeholder","0.00",3,"isInvalid"],["formControlName","vendorSellingNetAmount","valueType","number","placeholder","0.00",3,"inputFormat","isInvalid"],[1,"title",3,"innerHTML"],[2,"text-align","center","font-size","13px"]],template:function(e,t){1&e&&(Ne.Wb(0,"div",0),Ne.Wb(1,"strong"),Ne.Wb(2,"sup"),Ne.Pc(3,"Select Room Plan or Promotion Rate Plan"),Ne.Vb(),Ne.Vb(),Ne.Wb(4,"ul",1),Ne.Wb(5,"li"),Ne.Pc(6),Ne.Vb(),Ne.Wb(7,"li"),Ne.Pc(8,"Gross"),Ne.Vb(),Ne.Wb(9,"li"),Ne.Pc(10),Ne.Vb(),Ne.Wb(11,"li"),Ne.Pc(12),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Wb(13,"p",2),Ne.Pc(14,'The extra tax field can use in case of "Extra Tax Payment : Y " only'),Ne.Vb(),Ne.Ub(15,3),Ne.Ub(16,4),Ne.Nc(17,eo,34,15,"div",5),Ne.Tb(),Ne.Ub(18,6),Ne.Nc(19,io,34,16,"div",5),Ne.Tb(),Ne.Tb(),Ne.Nc(20,ao,2,0,"p",7)),2&e&&(Ne.Cb(6),Ne.Rc("Curr : ",null==t.hotelContractInfo?null:t.hotelContractInfo.currencyCode,""),Ne.Cb(4),Ne.Rc("Comm Rate : ",null==t.hotelContractInfo?null:t.hotelContractInfo.vendorCommRate,"%"),Ne.Cb(2),Ne.Rc("Extra Tax Payment : ",null!=t.hotelContractInfo&&t.hotelContractInfo.extraTaxPaymentYn?"Y":"N",""),Ne.Cb(3),Ne.pc("formGroup",t.submitForm),Ne.Cb(2),Ne.pc("ngForOf",null==t.roomPlanFormListFormArray?null:t.roomPlanFormListFormArray.controls),Ne.Cb(2),Ne.pc("ngForOf",null==t.promotionPlanFormListFormArray?null:t.promotionPlanFormListFormArray.controls),Ne.Cb(1),Ne.pc("ngIf",t.isNoItem))},directives:[a.s,a.k,a.e,i.n,i.o,a.l,Mn.a,a.r,a.i],styles:['.page-item-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.ul-rate-detail[_ngcontent-%COMP%]{display:flex;color:#ff682c;font-size:12px}.ul-rate-detail[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:not(:last-child):after{content:"|";color:#262626;margin:0 12px}.title[_ngcontent-%COMP%]{white-space:break-spaces}textarea[_ngcontent-%COMP%]:-moz-read-only{background-color:#f5f5f5}textarea[_ngcontent-%COMP%]:read-only{background-color:#f5f5f5}']}),e})();var lo=n("rbKv"),co=n("kd+X"),so=n("LVFn");const po=function(e){return["ratePeriod","periods",e]},uo=function(){return{standalone:!0}},mo=function(e,t){return{"fa-plus":e,"fa-minus":t}};function bo(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"div",25),Ne.Ub(1,26),Ne.Wb(2,"div",27),Ne.Rb(3,"mat-datepicker-toggle",28),Ne.Rb(4,"input",29),Ne.Rb(5,"mat-datepicker",null,30),Ne.Vb(),Ne.Wb(7,"div",31),Ne.Pc(8,"~"),Ne.Vb(),Ne.Wb(9,"div",32),Ne.Rb(10,"mat-datepicker-toggle",28),Ne.Rb(11,"input",33),Ne.Rb(12,"mat-datepicker",null,34),Ne.Vb(),Ne.Wb(14,"app-checkbox",35),Ne.fc("onChange",(function(n){Ne.Fc(e);const o=t.index;return Ne.hc(2).onDayCheckAll(n,o)})),Ne.Vb(),Ne.Rb(15,"app-checkbox",36),Ne.Rb(16,"app-checkbox",37),Ne.Rb(17,"app-checkbox",38),Ne.Rb(18,"app-checkbox",39),Ne.Rb(19,"app-checkbox",40),Ne.Rb(20,"app-checkbox",41),Ne.Rb(21,"app-checkbox",42),Ne.Wb(22,"button",43),Ne.fc("click",(function(){Ne.Fc(e);const n=t.index;return Ne.hc(2).addRemovePeriod(n)})),Ne.Rb(23,"i",44),Ne.Vb(),Ne.Tb(),Ne.Vb()}if(2&e){const e=t.index,n=Ne.Ec(6),o=Ne.Ec(13),i=Ne.hc(2);Ne.Cb(1),Ne.qc("formGroupName",e),Ne.Cb(1),Ne.Gb("valid-error",i.checkIsInvalid(Ne.uc(12,po,e))),Ne.Cb(1),Ne.pc("for",n),Ne.Cb(1),Ne.pc("matDatepicker",n),Ne.Cb(5),Ne.Gb("valid-error",i.checkIsInvalid(Ne.uc(14,po,e))),Ne.Cb(1),Ne.pc("for",o),Ne.Cb(1),Ne.pc("matDatepicker",o),Ne.Cb(3),Ne.pc("ngModel",i.isAllDayCheckedByItem(e))("ngModelOptions",Ne.tc(16,uo)),Ne.Cb(9),Ne.pc("ngClass",Ne.vc(17,mo,0==e,e>0))}}function ho(e,t){if(1&e&&(Ne.Wb(0,"tr"),Ne.Wb(1,"th",10),Ne.Pc(2,"Period"),Ne.Vb(),Ne.Wb(3,"td"),Ne.Ub(4,23),Ne.Nc(5,bo,24,20,"div",24),Ne.Tb(),Ne.Vb(),Ne.Vb()),2&e){const e=Ne.hc();Ne.Cb(5),Ne.pc("ngForOf",e.periodArray.controls)}}function fo(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"button",45),Ne.fc("click",(function(){return Ne.Fc(e),Ne.hc().showCalendar("include")})),Ne.Pc(1," Select Date "),Ne.Vb()}}function vo(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"button",46),Ne.fc("click",(function(){return Ne.Fc(e),Ne.hc().resetIncludeDates()})),Ne.Pc(1," Reset Date "),Ne.Vb()}}function Po(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"tr"),Ne.Wb(1,"th",10),Ne.Pc(2," Exclude Days "),Ne.Wb(3,"button",45),Ne.fc("click",(function(){return Ne.Fc(e),Ne.hc().showCalendar("exclude")})),Ne.Pc(4," Select Date "),Ne.Vb(),Ne.Wb(5,"button",47),Ne.fc("click",(function(){return Ne.Fc(e),Ne.hc().resetExcludeDates()})),Ne.Pc(6," Reset Date "),Ne.Vb(),Ne.Vb(),Ne.Wb(7,"td"),Ne.Wb(8,"div",13),Ne.Rb(9,"textarea",48),Ne.Vb(),Ne.Vb(),Ne.Vb()}}function Co(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"app-checkbox",50),Ne.fc("onChange",(function(t){return Ne.Fc(e),Ne.hc(2).onRoomPlanCheckAll(t)})),Ne.Vb()}}function go(e,t){if(1&e&&(Ne.Wb(0,"li"),Ne.Nc(1,Co,1,0,"app-checkbox",49),Ne.Vb()),2&e){const e=Ne.hc();Ne.Cb(1),Ne.pc("ngIf",!e.isUpdateModal)}}function yo(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"li"),Ne.Wb(1,"app-checkbox",51),Ne.fc("ngModelChange",(function(t){return Ne.Fc(e),Ne.hc().checkedRoomPlanIdList=t}))("onChange",(function(n){Ne.Fc(e);const o=t.$implicit;return Ne.hc().onRoomPlanCheck(n,o)})),Ne.Vb(),Ne.Vb()}if(2&e){const e=t.$implicit,n=Ne.hc();Ne.Cb(1),Ne.pc("ngModel",n.checkedRoomPlanIdList)("value",e.vendorRoomPlanSeq)("label",e.roomPlanNameEn)("ngModelOptions",Ne.tc(5,uo))("disabled",n.isUpdateModal)}}function Do(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"app-checkbox",53),Ne.fc("onChange",(function(t){return Ne.Fc(e),Ne.hc(2).onPromotionPlanCheckAll(t)})),Ne.Vb()}}function So(e,t){if(1&e&&(Ne.Wb(0,"li"),Ne.Nc(1,Do,1,0,"app-checkbox",52),Ne.Vb()),2&e){const e=Ne.hc();Ne.Cb(1),Ne.pc("ngIf",!e.isUpdateModal)}}function Io(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"li"),Ne.Wb(1,"app-checkbox",51),Ne.fc("ngModelChange",(function(t){return Ne.Fc(e),Ne.hc().checkedPromotionPlanIdList=t}))("onChange",(function(n){Ne.Fc(e);const o=t.$implicit;return Ne.hc().onPromotionPlanCheck(n,o)})),Ne.Vb(),Ne.Vb()}if(2&e){const e=t.$implicit,n=Ne.hc();Ne.Cb(1),Ne.pc("ngModel",n.checkedPromotionPlanIdList)("value",e.planPromotionSeq)("label",e.promotionPlanNameEn)("ngModelOptions",Ne.tc(5,uo))("disabled",n.isUpdateModal)}}function Oo(e,t){if(1&e&&(Ne.Ub(0),Ne.Rb(1,"app-rate-detail-selected-rate-plan-gross",54),Ne.Tb()),2&e){const e=Ne.hc();Ne.Cb(1),Ne.pc("isUpdateModal",e.isUpdateModal)("hotelContractInfo",e.hotelContractInfo)("checkedDateInfo",e.checkedDateInfo)("checkedRoomPlanList",e.checkedRoomPlanList)("checkedPromotionPlanList",e.checkedPromotionPlanList)}}function Ro(e,t){if(1&e&&(Ne.Ub(0),Ne.Rb(1,"app-rate-detail-selected-rate-plan-net",54),Ne.Tb()),2&e){const e=Ne.hc();Ne.Cb(1),Ne.pc("isUpdateModal",e.isUpdateModal)("hotelContractInfo",e.hotelContractInfo)("checkedDateInfo",e.checkedDateInfo)("checkedRoomPlanList",e.checkedRoomPlanList)("checkedPromotionPlanList",e.checkedPromotionPlanList)}}let ko=(()=>{class e{constructor(e,t){this._dataService=e,this._alertService=t,this.isUpdateModal=!1,this.isImmutableIncludeDays=!1,this.openCalendarEvent=new Ne.n,this.submitEvent=new Ne.n,this.closeEvent=new Ne.n,this.checkedRoomPlanIdList=[],this.checkedRoomPlanList=[],this.checkedPromotionPlanIdList=[],this.checkedPromotionPlanList=[],this.unsubscribe$=new ge.a,this.upsertForm=this._dataService.generateRatePutForm()}get includeDays(){return this._includeDays}set includeDays(e){this._includeDays=e,this._setIncludeDates(this._includeDays)}get excludeDays(){return this._excludeDays}set excludeDays(e){this._excludeDays=e,this._setExcludeDates(this._excludeDays)}get periodArray(){return this.upsertForm.get("ratePeriod").get("periods")}get hotelContractInfo(){var e,t,n,o,i,a,r,l,c,s,p,d,u,m,b,h,f,v,P,C;const g=null===(o=null===(n=null===(t=null===(e=this.promotionCheckedDateInfo)||void 0===e?void 0:e[0])||void 0===t?void 0:t.plans)||void 0===n?void 0:n[0])||void 0===o?void 0:o.params,y=null===(l=null===(r=null===(a=null===(i=this.checkedDateInfo)||void 0===i?void 0:i[0])||void 0===a?void 0:a.plans)||void 0===r?void 0:r[0])||void 0===l?void 0:l.params,D={currencyCode:(null===(s=null===(c=this.roomPlanList)||void 0===c?void 0:c[0])||void 0===s?void 0:s.currencyCode)||(null===(d=null===(p=this.promotionPlanList)||void 0===p?void 0:p[0])||void 0===d?void 0:d.currencyCode),vendorCommRate:(null===(m=null===(u=this.roomPlanList)||void 0===u?void 0:u[0])||void 0===m?void 0:m.vendorCommRate)||(null===(h=null===(b=this.promotionPlanList)||void 0===b?void 0:b[0])||void 0===h?void 0:h.vendorCommRate),extraTaxPaymentYn:(null===(v=null===(f=this.roomPlanList)||void 0===f?void 0:f[0])||void 0===v?void 0:v.extraTaxPaymentYn)||(null===(C=null===(P=this.promotionPlanList)||void 0===P?void 0:P[0])||void 0===C?void 0:C.extraTaxPaymentYn)};return g||y||D}get isModifyPromotion(){return!!this.promotionCheckedDateInfo}get isGrossContract(){var e,t,n,o;return!1===(null===(t=null===(e=this.roomPlanList)||void 0===e?void 0:e[0])||void 0===t?void 0:t.netProvideYn)||!1===(null===(o=null===(n=this.promotionPlanList)||void 0===n?void 0:n[0])||void 0===o?void 0:o.netProvideYn)}get isNetContract(){var e,t,n,o;return!0===(null===(t=null===(e=this.roomPlanList)||void 0===e?void 0:e[0])||void 0===t?void 0:t.netProvideYn)||!0===(null===(o=null===(n=this.promotionPlanList)||void 0===n?void 0:n[0])||void 0===o?void 0:o.netProvideYn)}get roomPlanListLength(){var e;return(null===(e=this.roomPlanList)||void 0===e?void 0:e.length)||0}get promotionPlanListLength(){var e;return(null===(e=this.promotionPlanList)||void 0===e?void 0:e.length)||0}periodGroup(e){return this.periodArray.at(e)}isAllDayCheckedByItem(e){return!0===this.periodArray.at(e).get("appliedMonYn").value&&!0===this.periodArray.at(e).get("appliedTueYn").value&&!0===this.periodArray.at(e).get("appliedWedYn").value&&!0===this.periodArray.at(e).get("appliedThuYn").value&&!0===this.periodArray.at(e).get("appliedFriYn").value&&!0===this.periodArray.at(e).get("appliedSatYn").value&&!0===this.periodArray.at(e).get("appliedSunYn").value}ngOnInit(){this.upsertForm.get("hotelCode").setValue(this.hotelProfile.hotelCode),this._setPlanList(),this._setUpdateFormData(),this.periodArray.push(this._dataService.generatePeriodGroups()),this._setIncludeExcludeDays()}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}onSubmit(){var e,t,n,o;if(this._v_isDateConditionFilled()||this._alertService.alert("Please fill the date condition."),this.upsertForm.invalid||!this._v_isDateConditionFilled())return this.checkValid=!0,void Object.keys(this.upsertForm.controls).forEach(e=>{this.upsertForm.get(e).invalid&&console.error(e+" is invalid.")});const i=this._getRoomTypePlansFromComponent();if(Ie.isEmpty(i))return void this._alertService.alert("Please fill the room type plan or promotion plan.");const a=this.upsertForm.getRawValue();(Ie.isNil(null===(t=null===(e=a.ratePeriod.periods)||void 0===e?void 0:e[0])||void 0===t?void 0:t.appliedFromDate)||Ie.isNil(null===(o=null===(n=a.ratePeriod.periods)||void 0===n?void 0:n[0])||void 0===o?void 0:o.appliedToDate))&&(a.ratePeriod.periods=null),a.roomTypePlans=i;const r=a;this.checkValid=!1,this.submitEvent.emit(r)}onClose(){this.closeEvent.emit()}checkIsInvalid(e){return this.checkValid&&this.upsertForm.get(e)&&this.upsertForm.get(e).invalid}addRemovePeriod(e){e?this.removePeriod(e):this.periodArray.push(this._dataService.generatePeriodGroups())}removePeriod(e){this.periodArray.removeAt(e)}onRoomPlanCheckAll(e){this.checkedRoomPlanIdList=e?Ie.map(this.roomPlanList,"vendorRoomPlanSeq"):[],this.checkedRoomPlanList=this.roomPlanList.filter(e=>this.checkedRoomPlanIdList.includes(e.vendorRoomPlanSeq))}onRoomPlanCheck(e,t){e?this.checkedRoomPlanIdList.push(t.vendorRoomPlanSeq):Ie.remove(this.checkedRoomPlanIdList,e=>e===t.vendorRoomPlanSeq),this.checkedRoomPlanList=this.roomPlanList.filter(e=>this.checkedRoomPlanIdList.includes(e.vendorRoomPlanSeq))}onPromotionPlanCheckAll(e){this.checkedPromotionPlanIdList=e?Ie.map(this.promotionPlanList,"planPromotionSeq"):[],this.checkedPromotionPlanList=this.promotionPlanList.filter(e=>this.checkedPromotionPlanIdList.includes(e.planPromotionSeq))}onPromotionPlanCheck(e,t){e?this.checkedPromotionPlanIdList.push(t.planPromotionSeq):Ie.remove(this.checkedPromotionPlanIdList,e=>e===t.planPromotionSeq),this.checkedPromotionPlanList=this.promotionPlanList.filter(e=>this.checkedPromotionPlanIdList.includes(e.planPromotionSeq))}onDayCheckAll(e,t){const n=this.periodGroup(t);n.get("appliedMonYn").patchValue(e),n.get("appliedTueYn").patchValue(e),n.get("appliedWedYn").patchValue(e),n.get("appliedThuYn").patchValue(e),n.get("appliedFriYn").patchValue(e),n.get("appliedSatYn").patchValue(e),n.get("appliedSunYn").patchValue(e)}showCalendar(e){if("exclude"===e){if(!this._periodDateCheck())return void this._alertService.alert("Input period date first.");const t=this._getPeriodMinDate(),n=Ae(t,"YYYY-MM-DD").year(),o=Ae(t,"YYYY-MM-DD").month()+1,i=[];this.periodArray.value.forEach(e=>{i.push({firstDate:e.appliedFromDate,lastDate:e.appliedToDate})}),this.openCalendarEvent.emit({type:e,isPreview:!1,minDate:{year:n,month:o},validDateRange:i})}else this.openCalendarEvent.emit({type:e,isPreview:!1,validDateRange:null})}resetIncludeDates(){this.upsertForm.get("ratePeriod").get("includeDates").setValue([])}resetExcludeDates(){this.upsertForm.get("ratePeriod").get("excludeDates").setValue([])}_getPeriodMinDate(){const e=this.periodArray.getRawValue();return Ie.min(Ie.map(e,"appliedFromDate"))}_periodDateCheck(){const e=this.periodArray.value,t=Ie.map(e,"appliedFromDate"),n=Ie.map(e,"appliedToDate");return Ie.every(t,Boolean)&&Ie.every(n,Boolean)}_setPlanList(){this.roomPlanList=this.planList.roomPlanList,this.promotionPlanList=this.planList.promotionPlanList}_setUpdateFormData(){var e,t,n;if(this.isUpdateModal){const o=null===(n=null===(t=null===(e=this.checkedDateInfo)||void 0===e?void 0:e[0])||void 0===t?void 0:t.plans)||void 0===n?void 0:n[0];if(Ie.isNil(o)&&Ie.isNil(this.promotionCheckedDateInfo))return void console.error("This is update modal but, selectedRoomPlanis and promotionCheckedDateInfo are nil at the same time.",this.checkedDateInfo,this.promotionCheckedDateInfo);o?(this.checkedRoomPlanIdList.push(o.planId),this.checkedRoomPlanList=this.roomPlanList.filter(e=>this.checkedRoomPlanIdList.includes(e.vendorRoomPlanSeq)),this.roomPlanList=this.checkedRoomPlanList,this.promotionPlanList=[]):this.promotionCheckedDateInfo&&(this.checkedPromotionPlanIdList.push(this.promotionCheckedDateInfo[0].plans[0].params.planPromotionSeq),this.checkedPromotionPlanList=this.promotionPlanList.filter(e=>this.checkedPromotionPlanIdList.includes(e.planPromotionSeq)),this.promotionPlanList=this.checkedPromotionPlanList,this.roomPlanList=[])}}_setIncludeExcludeDays(){this.includeDays&&this.isImmutableIncludeDays&&this.upsertForm.get("ratePeriod").get("includeDates").setValue(this.includeDays),this.excludeDays&&this.upsertForm.get("ratePeriod").get("excludeDates").setValue(this.excludeDays)}_getRoomTypePlansFromComponent(){return this.isGrossContract?this.ratePlanGrossComponent.makeSubmitFormData():this.isNetContract?this.ratePlanNetComponent.makeSubmitFormData():(console.error("Invalid contract type."),null)}_setIncludeDates(e){if(e){let t=!1;const n=e.filter(e=>{var n;return!(null===(n=this.excludeDays)||void 0===n?void 0:n.includes(e))||(t=!0,!1)});t&&this._alertService.alert("Include date and Exclude date cannot be overlapped"),this.upsertForm.get("ratePeriod").get("includeDates").setValue(n)}else this.upsertForm.get("ratePeriod").get("includeDates").setValue([])}_setExcludeDates(e){if(e){let t=!1;const n=e.filter(e=>{var n;return!(null===(n=this.includeDays)||void 0===n?void 0:n.includes(e))||(t=!0,!1)});t&&this._alertService.alert("Include date and Exclude date cannot be overlapped"),this.upsertForm.get("ratePeriod").get("excludeDates").setValue(n)}else this.upsertForm.get("ratePeriod").get("excludeDates").setValue([])}_v_isDateConditionFilled(){var e;const t=this.upsertForm.controls.ratePeriod.controls.includeDates,n=this._v_isPeriodArrayFilled(),o=(null===(e=t.value)||void 0===e?void 0:e.length)>0&&t.valid;return n||o}_v_isPeriodArrayFilled(){const e=this.periodArray.value;return!!((null==e?void 0:e.length)>0&&this.periodArray.valid)&&(!(1!==(null==e?void 0:e.length)||!e[0].appliedFromDate||!e[0].appliedToDate)||Ie.every(e,e=>e.appliedFromDate&&e.appliedToDate))}}return e.\u0275fac=function(t){return new(t||e)(Ne.Qb(Yn),Ne.Qb(Ge.a))},e.\u0275cmp=Ne.Kb({type:e,selectors:[["app-rate-detail"]],viewQuery:function(e,t){var n;1&e&&(Ne.Xc(Qn,!0),Ne.Xc(ro,!0)),2&e&&(Ne.Dc(n=Ne.gc())&&(t.ratePlanNetComponent=n.first),Ne.Dc(n=Ne.gc())&&(t.ratePlanGrossComponent=n.first))},inputs:{isUpdateModal:"isUpdateModal",isImmutableIncludeDays:"isImmutableIncludeDays",hotelProfile:"hotelProfile",planList:"planList",checkedDateInfo:"checkedDateInfo",promotionCheckedDateInfo:"promotionCheckedDateInfo",includeDays:"includeDays",excludeDays:"excludeDays"},outputs:{openCalendarEvent:"openCalendarEvent",submitEvent:"submitEvent",closeEvent:"closeEvent"},decls:50,vars:14,consts:[[1,"main-contents-summary-inner","mb20"],[1,"font-size-lg","font-weight-bold"],[1,"promotion-rate"],[3,"formGroup","connectForm"],[1,"page-item"],[1,"page-item-header"],[1,"table","table-bordered"],["width","130px"],["formGroupName","ratePeriod"],[4,"ngIf"],["scope","row",1,"th-bg"],["type","button","class","btn btn-light sm mt10 full",3,"click",4,"ngIf"],["type","button","class","btn btn-secondary sm mt5 mb5 full",3,"click",4,"ngIf"],[1,"textarea"],["formControlName","includeDates","cols","30","rows","3","readonly",""],[1,"item-box"],[1,"mb20"],[4,"ngFor","ngForOf"],[2,"border","solid #e0e0e0","border-width","1px 0 0 0"],[1,"mt15"],[1,"button-area","align-r","mt10"],[1,"btn","btn-secondary","sm",3,"click"],[1,"btn","btn-light","sm",3,"click"],["formArrayName","periods"],["class","form-group",4,"ngFor","ngForOf"],[1,"form-group"],[3,"formGroupName"],[1,"input","calendar"],[3,"for"],["type","text","placeholder","YYYY-MM-DD","formControlName","appliedFromDate",3,"matDatepicker"],["myPickerFrom",""],[1,"dash"],[1,"input","calendar","mr20"],["type","text","placeholder","YYYY-MM-DD","formControlName","appliedToDate",3,"matDatepicker"],["myPickerTo",""],["binary","true","label","All",3,"ngModel","ngModelOptions","onChange"],["formControlName","appliedMonYn","binary","true","label","Mon"],["formControlName","appliedTueYn","binary","true","label","Tue"],["formControlName","appliedWedYn","binary","true","label","Wed"],["formControlName","appliedThuYn","binary","true","label","Thu"],["formControlName","appliedFriYn","binary","true","label","Fri"],["formControlName","appliedSatYn","binary","true","label","Sat"],["formControlName","appliedSunYn","binary","true","label","Sun"],["type","button",1,"btn","btn-outline-secondary","btn-icon-only","xs","ml10",3,"click"],[1,"fas",3,"ngClass"],["type","button",1,"btn","btn-light","sm","mt10","full",3,"click"],["type","button",1,"btn","btn-secondary","sm","mt5","mb5","full",3,"click"],["type","button",1,"btn","btn","btn-secondary","sm","mt5","mb5","full",3,"click"],["formControlName","excludeDates","cols","30","rows","3","readonly",""],["label","All Room Plan",3,"onChange",4,"ngIf"],["label","All Room Plan",3,"onChange"],[3,"ngModel","value","label","ngModelOptions","disabled","ngModelChange","onChange"],["label","All Promotion Plan",3,"onChange",4,"ngIf"],["label","All Promotion Plan",3,"onChange"],[3,"isUpdateModal","hotelContractInfo","checkedDateInfo","checkedRoomPlanList","checkedPromotionPlanList"]],template:function(e,t){1&e&&(Ne.Wb(0,"div",0),Ne.Wb(1,"p",1),Ne.Pc(2),Ne.Vb(),Ne.Vb(),Ne.Wb(3,"div",2),Ne.Wb(4,"form",3),Ne.Wb(5,"div",4),Ne.Wb(6,"div",5),Ne.Wb(7,"strong"),Ne.Wb(8,"sup"),Ne.Pc(9,"Date Condition"),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Wb(10,"div",6),Ne.Wb(11,"table"),Ne.Wb(12,"caption"),Ne.Pc(13," Date Condition "),Ne.Vb(),Ne.Wb(14,"colgroup"),Ne.Rb(15,"col",7),Ne.Rb(16,"col"),Ne.Vb(),Ne.Wb(17,"tbody",8),Ne.Nc(18,ho,6,1,"tr",9),Ne.Wb(19,"tr"),Ne.Wb(20,"th",10),Ne.Pc(21," Include Days "),Ne.Nc(22,fo,2,0,"button",11),Ne.Nc(23,vo,2,0,"button",12),Ne.Vb(),Ne.Wb(24,"td"),Ne.Wb(25,"div",13),Ne.Rb(26,"textarea",14),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Nc(27,Po,10,0,"tr",9),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Wb(28,"div",4),Ne.Wb(29,"div",5),Ne.Wb(30,"strong"),Ne.Wb(31,"sup"),Ne.Pc(32,"Select Room Type & Plan"),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Wb(33,"div",15),Ne.Wb(34,"ul",16),Ne.Nc(35,go,2,1,"li",9),Ne.Nc(36,yo,2,6,"li",17),Ne.Vb(),Ne.Rb(37,"hr",18),Ne.Wb(38,"ul",19),Ne.Nc(39,So,2,1,"li",9),Ne.Nc(40,Io,2,6,"li",17),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Wb(41,"div",4),Ne.Nc(42,Oo,2,5,"ng-container",9),Ne.Vb(),Ne.Wb(43,"div",4),Ne.Nc(44,Ro,2,5,"ng-container",9),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Wb(45,"div",20),Ne.Wb(46,"button",21),Ne.fc("click",(function(){return t.onSubmit()})),Ne.Pc(47,"Save"),Ne.Vb(),Ne.Wb(48,"button",22),Ne.fc("click",(function(){return t.onClose()})),Ne.Pc(49,"Close"),Ne.Vb(),Ne.Vb()),2&e&&(Ne.Cb(2),Ne.Sc(" [",null==t.hotelProfile?null:t.hotelProfile.hotelCode,"] ",null==t.hotelProfile?null:t.hotelProfile.hotelNameEn," "),Ne.Cb(2),Ne.pc("formGroup",t.upsertForm)("connectForm",t.upsertFormData),Ne.Cb(14),Ne.pc("ngIf",!t.isUpdateModal||t.isModifyPromotion),Ne.Cb(4),Ne.pc("ngIf",!t.isImmutableIncludeDays),Ne.Cb(1),Ne.pc("ngIf",!t.isImmutableIncludeDays),Ne.Cb(4),Ne.pc("ngIf",!t.isImmutableIncludeDays),Ne.Cb(8),Ne.pc("ngIf",0!==t.roomPlanListLength),Ne.Cb(1),Ne.pc("ngForOf",t.roomPlanList),Ne.Cb(3),Ne.pc("ngIf",0!==t.promotionPlanListLength),Ne.Cb(1),Ne.pc("ngForOf",t.promotionPlanList),Ne.Cb(2),Ne.pc("ngIf",t.isGrossContract),Ne.Cb(2),Ne.pc("ngIf",t.isNetContract))},directives:[a.B,a.s,a.k,xe.a,a.l,i.o,a.c,a.r,a.i,i.n,a.e,lo.a,co.a,so.a,Me.a,a.u,i.l,ro,Qn],styles:['.page-item-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.ul-rate-detail[_ngcontent-%COMP%]{display:flex;color:#ff682c;font-size:12px}.ul-rate-detail[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:not(:last-child):after{content:"|";color:#262626;margin:0 12px}.title[_ngcontent-%COMP%]{white-space:break-spaces}textarea[_ngcontent-%COMP%]:-moz-read-only{background-color:#f5f5f5}textarea[_ngcontent-%COMP%]:read-only{background-color:#f5f5f5}'],changeDetection:0}),e})();var To=n("pybq");const Vo={ROOM_TYPE:0,RATE_PLAN:1,PROMOTION_PLAN:2};let No=(()=>{class e{constructor(e){this.fb=e,this.generateStopOrStartSellingPutForm=()=>this.fb.group({hotelContractSeq:[null,[a.z.required]],stopPeriod:this.fb.group({periods:this.fb.array([]),includeDates:[],excludeDates:[]}),roomTypePlans:this.fb.array([]),__planTypeSelectControl:[Vo.ROOM_TYPE]}),this.initStopOrStartSellingPutFormData=()=>({hotelContractSeq:null,roomTypePlans:null,stopPeriod:null}),this.generatePlanTypeGroup=()=>this.fb.group({vendorRoomTypeSeq:[null,[a.z.required]],vendorRoomPlanSeq:[null],salesStopYn:[null,[a.z.required]],roomTypeNameEn:[null],roomPlanNameEn:[null],planPromotionName:[null]}),this.initPlanTypeGroup=()=>({vendorRoomTypeSeq:null,vendorRoomPlanSeq:null,salesStopYn:null}),this.generatePeriodGroup=()=>this.fb.group({appliedFromDate:[null],appliedToDate:[null],appliedMonYn:[!0],appliedTueYn:[!0],appliedWedYn:[!0],appliedThuYn:[!0],appliedFriYn:[!0],appliedSatYn:[!0],appliedSunYn:[!0]})}}return e.\u0275fac=function(t){return new(t||e)(Ne.bc(a.f))},e.\u0275prov=Ne.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Fo=n("Onn4");const Ao=function(e){return["stopPeriod","periods",e]},Lo=function(){return{standalone:!0}},Eo=function(e,t){return{"fa-plus":e,"fa-minus":t}};function Wo(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"div",35),Ne.Ub(1,36),Ne.Wb(2,"div",37),Ne.Rb(3,"mat-datepicker-toggle",38),Ne.Rb(4,"input",39),Ne.Rb(5,"mat-datepicker",null,40),Ne.Vb(),Ne.Wb(7,"div",41),Ne.Pc(8,"~"),Ne.Vb(),Ne.Wb(9,"div",42),Ne.Rb(10,"mat-datepicker-toggle",38),Ne.Rb(11,"input",43),Ne.Rb(12,"mat-datepicker",null,44),Ne.Vb(),Ne.Wb(14,"app-checkbox",45),Ne.fc("onChange",(function(n){Ne.Fc(e);const o=t.index;return Ne.hc(2).onDayCheckAll(n,o)})),Ne.Vb(),Ne.Rb(15,"app-checkbox",46),Ne.Rb(16,"app-checkbox",47),Ne.Rb(17,"app-checkbox",48),Ne.Rb(18,"app-checkbox",49),Ne.Rb(19,"app-checkbox",50),Ne.Rb(20,"app-checkbox",51),Ne.Rb(21,"app-checkbox",52),Ne.Wb(22,"button",53),Ne.fc("click",(function(){Ne.Fc(e);const n=t.index;return Ne.hc(2).addRemovePeriod(n)})),Ne.Rb(23,"i",54),Ne.Vb(),Ne.Tb(),Ne.Vb()}if(2&e){const e=t.index,n=Ne.Ec(6),o=Ne.Ec(13),i=Ne.hc(2);Ne.Cb(1),Ne.qc("formGroupName",e),Ne.Cb(1),Ne.Gb("valid-error",i.checkIsInvalid(Ne.uc(12,Ao,e))),Ne.Cb(1),Ne.pc("for",n),Ne.Cb(1),Ne.pc("matDatepicker",n),Ne.Cb(5),Ne.Gb("valid-error",i.checkIsInvalid(Ne.uc(14,Ao,e))),Ne.Cb(1),Ne.pc("for",o),Ne.Cb(1),Ne.pc("matDatepicker",o),Ne.Cb(3),Ne.pc("ngModel",i.isAllDayCheckedByItem(e))("ngModelOptions",Ne.tc(16,Lo)),Ne.Cb(9),Ne.pc("ngClass",Ne.vc(17,Eo,0==e,e>0))}}function _o(e,t){if(1&e&&(Ne.Wb(0,"tr"),Ne.Wb(1,"th",10),Ne.Pc(2,"Period"),Ne.Vb(),Ne.Wb(3,"td"),Ne.Ub(4,33),Ne.Nc(5,Wo,24,20,"div",34),Ne.Tb(),Ne.Vb(),Ne.Vb()),2&e){const e=Ne.hc();Ne.Cb(5),Ne.pc("ngForOf",null==e.periodArray?null:e.periodArray.controls)}}function xo(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"button",55),Ne.fc("click",(function(){return Ne.Fc(e),Ne.hc().showCalendar("include")})),Ne.Pc(1," Select Date "),Ne.Vb()}}function jo(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"button",56),Ne.fc("click",(function(){return Ne.Fc(e),Ne.hc().resetIncludeDates()})),Ne.Pc(1," Reset Date "),Ne.Vb()}}function Yo(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"tr"),Ne.Wb(1,"th",10),Ne.Pc(2," Exclude Days "),Ne.Wb(3,"button",55),Ne.fc("click",(function(){return Ne.Fc(e),Ne.hc().showCalendar("exclude")})),Ne.Pc(4," Select Date "),Ne.Vb(),Ne.Wb(5,"button",57),Ne.fc("click",(function(){return Ne.Fc(e),Ne.hc().resetExcludeDates()})),Ne.Pc(6," Reset Date "),Ne.Vb(),Ne.Vb(),Ne.Wb(7,"td"),Ne.Wb(8,"div",13),Ne.Rb(9,"textarea",58),Ne.Vb(),Ne.Vb(),Ne.Vb()}}function Mo(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"app-checkbox",59),Ne.fc("onChange",(function(t){return Ne.Fc(e),Ne.hc().checkAllPlanEventHandler(t)})),Ne.Vb()}if(2&e){const e=Ne.hc();Ne.pc("value",e.isAllPlanChecked)("disabled",e.isImmutableIncludeDays)}}function $o(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"li"),Ne.Wb(1,"app-checkbox",60),Ne.fc("ngModelChange",(function(t){return Ne.Fc(e),Ne.hc(2).checkedPlanList=t}))("onChange",(function(n){Ne.Fc(e);const o=t.$implicit;return Ne.hc(2).checkPlanItemEventHandler(n,o)})),Ne.Vb(),Ne.Vb()}if(2&e){const e=t.$implicit,n=Ne.hc(2);Ne.Cb(1),Ne.pc("ngModel",n.checkedPlanList)("value",e.vendorRoomTypeSeq)("label",n.showCheckBoxLabel(e))("ngModelOptions",Ne.tc(5,Lo))("disabled",n.isImmutableIncludeDays)}}function qo(e,t){if(1&e&&(Ne.Ub(0),Ne.Nc(1,$o,2,6,"li",28),Ne.Tb()),2&e){const e=Ne.hc();Ne.Cb(1),Ne.pc("ngForOf",e.roomTypeList)}}function wo(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"li"),Ne.Wb(1,"app-checkbox",60),Ne.fc("ngModelChange",(function(t){return Ne.Fc(e),Ne.hc(2).checkedPlanList=t}))("onChange",(function(n){Ne.Fc(e);const o=t.$implicit;return Ne.hc(2).checkPlanItemEventHandler(n,o)})),Ne.Vb(),Ne.Vb()}if(2&e){const e=t.$implicit,n=Ne.hc(2);Ne.Cb(1),Ne.pc("ngModel",n.checkedPlanList)("value",e.vendorRoomPlanSeq)("label",n.showCheckBoxLabel(e))("ngModelOptions",Ne.tc(5,Lo))("disabled",n.isImmutableIncludeDays)}}function Ho(e,t){if(1&e&&(Ne.Ub(0),Ne.Nc(1,wo,2,6,"li",28),Ne.Tb()),2&e){const e=Ne.hc();Ne.Cb(1),Ne.pc("ngForOf",e.ratePlanList)}}function Uo(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"li"),Ne.Wb(1,"app-checkbox",60),Ne.fc("ngModelChange",(function(t){return Ne.Fc(e),Ne.hc(2).checkedPlanList=t}))("onChange",(function(n){Ne.Fc(e);const o=t.$implicit;return Ne.hc(2).checkPlanItemEventHandler(n,o)})),Ne.Vb(),Ne.Vb()}if(2&e){const e=t.$implicit,n=Ne.hc(2);Ne.Cb(1),Ne.pc("ngModel",n.checkedPlanList)("value",e.vendorRoomPlanSeq)("label",n.showCheckBoxLabel(e))("ngModelOptions",Ne.tc(5,Lo))("disabled",n.isImmutableIncludeDays)}}function Go(e,t){if(1&e&&(Ne.Ub(0),Ne.Nc(1,Uo,2,6,"li",28),Ne.Tb()),2&e){const e=Ne.hc();Ne.Cb(1),Ne.pc("ngForOf",e.promotionPlanList)}}function Bo(e,t){if(1&e&&(Ne.Wb(0,"tr"),Ne.Ub(1,36),Ne.Wb(2,"td"),Ne.Wb(3,"div",35),Ne.Pc(4),Ne.Vb(),Ne.Vb(),Ne.Wb(5,"td"),Ne.Wb(6,"div",35),Ne.Rb(7,"app-radio",61),Ne.Rb(8,"app-radio",62),Ne.Vb(),Ne.Vb(),Ne.Tb(),Ne.Vb()),2&e){const e=t.$implicit,n=t.index,o=Ne.hc();Ne.Cb(1),Ne.qc("formGroupName",n),Ne.Cb(3),Ne.Rc(" ",o.showCheckBoxLabel(e.value)," "),Ne.Cb(3),Ne.pc("name","salesStopYn"+n)("value",!0)("checked",e.value.salesStopYn),Ne.Cb(1),Ne.pc("name","salesStopYn"+n)("value",!1)("checked",!e.value.salesStopYn)}}function Xo(e,t){1&e&&(Ne.Wb(0,"p",63),Ne.Pc(1," No selected item. "),Ne.Vb())}let zo=(()=>{class e{constructor(e,t,n){this._dataService=e,this.alertService=t,this.formService=n,this.isImmutableIncludeDays=!1,this.openCalendarEvent=new Ne.n,this.submitEvent=new Ne.n,this.closeEvent=new Ne.n,this.planTypeSelectOptionList=[{label:"Room Type",value:Vo.ROOM_TYPE},{label:"Rate Plan",value:Vo.RATE_PLAN}],this.roomTypeList=[],this.ratePlanList=[],this.promotionPlanList=[],this.checkedPlanList=[],this.isDisableTreeListControl=!1,this._PLAN_TYPE=Vo,this._checkValid=!1,this._unsubscribe$=new ge.a,this.upsertForm=this._dataService.generateStopOrStartSellingPutForm()}set includeDays(e){this.upsertForm.get("stopPeriod").get("includeDates").setValue(e||[])}set excludeDays(e){if(e){const t=this.upsertForm.get("stopPeriod").get("includeDates").value,n=e.filter(e=>!(null==t?void 0:t.includes(e))||(this.alertService.alert("Include date and Exclude date cannot be overlapped"),!1));this.upsertForm.get("stopPeriod").get("excludeDates").setValue(n)}else this.upsertForm.get("stopPeriod").get("excludeDates").setValue([])}set planListByTypeForStopSaleDetail(e){this.roomTypeList=(null==e?void 0:e.roomTypeList)||[],this.ratePlanList=(null==e?void 0:e.ratePlanList)||[],this.promotionPlanList=(null==e?void 0:e.promotionPlanList)||[]}get isAllPlanChecked(){switch(this.selectedPlanType){case Vo.ROOM_TYPE:return this.checkedPlanList.length===this.roomTypeList.length;case Vo.RATE_PLAN:return this.checkedPlanList.length===this.ratePlanList.length;case Vo.PROMOTION_PLAN:return this.checkedPlanList.length===this.promotionPlanList.length;default:console.error("Invalid Plan Type")}return!1}get selectedPlanType(){return this.upsertForm.get("__planTypeSelectControl").value}get periodArray(){return this.upsertForm.get("stopPeriod").get("periods")}get planTypeArray(){return this.upsertForm.get("roomTypePlans")}periodGroup(e){return this.periodArray.at(e)}planTypeGroup(e){return this.planTypeArray.at(e)}isAllDayCheckedByItem(e){return!0===this.periodArray.at(e).get("appliedMonYn").value&&!0===this.periodArray.at(e).get("appliedTueYn").value&&!0===this.periodArray.at(e).get("appliedWedYn").value&&!0===this.periodArray.at(e).get("appliedThuYn").value&&!0===this.periodArray.at(e).get("appliedFriYn").value&&!0===this.periodArray.at(e).get("appliedSatYn").value&&!0===this.periodArray.at(e).get("appliedSunYn").value}ngOnInit(){var e,t,n,o,i,a;if(this._initSubscription(),this.upsertForm.get("hotelContractSeq").patchValue(this.hotelContractSeq),this.isImmutableIncludeDays){const r=this._dataService.generatePlanTypeGroup();let l,c;if(null===(e=this.roomTypeList)||void 0===e?void 0:e[0])l=this.roomTypeList[0],c=this._PLAN_TYPE.ROOM_TYPE,this.roomTypeList=[l];else if(null===(t=this.ratePlanList)||void 0===t?void 0:t[0])l=this.ratePlanList[0],c=this._PLAN_TYPE.RATE_PLAN,this.ratePlanList=[l];else{if(!(null===(n=this.promotionPlanList)||void 0===n?void 0:n[0]))return console.error("planListByTypeForStopSaleDetail is empty"),l=null,void(c=null);l=this.promotionPlanList[0],c=this._PLAN_TYPE.PROMOTION_PLAN,this.promotionPlanList=[l]}this.upsertForm.get("__planTypeSelectControl").patchValue(c),this.upsertForm.get("__planTypeSelectControl").disable();const s=null===(o=this.checkedDateInfo[0])||void 0===o?void 0:o.rooms[0],p=null===(i=this.checkedDateInfo[0])||void 0===i?void 0:i.plans[0];this.upsertForm.get("stopPeriod").get("includeDates").setValue((null==p?void 0:p.dates)||(null==s?void 0:s.dates)),r.patchValue(l),this.planTypeArray.push(r),this.checkedPlanList.push(null!==(a=null==p?void 0:p.planId)&&void 0!==a?a:null==s?void 0:s.roomId)}else{const e=this._dataService.generatePeriodGroup();this.periodArray.push(e)}}ngOnDestroy(){this._unsubscribe$.next(),this._unsubscribe$.complete()}onSubmit(){if(this._v_isDateConditionFilled()||this.alertService.alert("Please fill the date condition."),this.upsertForm.invalid||!this._v_isDateConditionFilled())return this._checkValid=!0,void Object.keys(this.upsertForm.controls).forEach(e=>{this.upsertForm.get(e).invalid&&console.error(e+" is invalid.")});let e=this.upsertForm.getRawValue();const t=this._dataService.initStopOrStartSellingPutFormData();e=Ie.pick(e,Object.keys(t));const n=this._dataService.initPlanTypeGroup();e.roomTypePlans=e.roomTypePlans.map(e=>Ie.pick(e,Object.keys(n)));const o=e;this.formService.cleanUp(o),this.submitEvent.emit(o)}onClose(){this.closeEvent.emit()}checkIsInvalid(e){return this._checkValid&&this.upsertForm.get(e)&&this.upsertForm.get(e).invalid}addRemovePeriod(e){e?this.removePeriod(e):this.periodArray.push(this._dataService.generatePeriodGroup())}removePeriod(e){this.periodArray.removeAt(e)}checkPlanItemEventHandler(e,t){e?this._addPlanItemToPlanTypeArray(t):this._removePlanItemFromPlanTypeArray(t)}checkAllPlanEventHandler(e){const t=this.selectedPlanType;switch(t){case this._PLAN_TYPE.ROOM_TYPE:this.checkedPlanList=!0===e?Ie.map(this.roomTypeList,"vendorRoomTypeSeq"):[];break;case this._PLAN_TYPE.RATE_PLAN:this.checkedPlanList=!0===e?Ie.map(this.ratePlanList,"vendorRoomPlanSeq"):[];break;case this._PLAN_TYPE.PROMOTION_PLAN:this.checkedPlanList=!0===e?Ie.map(this.promotionPlanList,"vendorRoomPlanSeq"):[];break;default:console.error("Invalid plan type")}if(!0===e)switch(t){case this._PLAN_TYPE.ROOM_TYPE:this.roomTypeList.forEach(e=>this._addPlanItemToPlanTypeArray(e));break;case this._PLAN_TYPE.RATE_PLAN:this.ratePlanList.forEach(e=>this._addPlanItemToPlanTypeArray(e));break;case this._PLAN_TYPE.PROMOTION_PLAN:this.promotionPlanList.forEach(e=>this._addPlanItemToPlanTypeArray(e));break;default:console.error("Invalid plan type")}else this.planTypeArray.clear()}onDayCheckAll(e,t){const n=this.periodGroup(t);n.get("appliedMonYn").patchValue(e),n.get("appliedTueYn").patchValue(e),n.get("appliedWedYn").patchValue(e),n.get("appliedThuYn").patchValue(e),n.get("appliedFriYn").patchValue(e),n.get("appliedSatYn").patchValue(e),n.get("appliedSunYn").patchValue(e)}showCalendar(e){if("exclude"===e){if(!this.periodDateCheck())return void this.alertService.alert("Input period date first.");const t=this.getPeriodMinDate(),n=Ae(t,"YYYY-MM-DD").year(),o=Ae(t,"YYYY-MM-DD").month()+1,i=[];this.periodArray.value.forEach(e=>{i.push({firstDate:e.appliedFromDate,lastDate:e.appliedToDate})}),this.openCalendarEvent.emit({type:e,isPreview:!1,minDate:{year:n,month:o},validDateRange:i})}else this.openCalendarEvent.emit({type:e,isPreview:!1,validDateRange:null})}getPeriodMinDate(){const e=this.periodArray.getRawValue();return Ie.min(Ie.map(e,"appliedFromDate"))}periodDateCheck(){const e=this.periodArray.value,t=Ie.map(e,"appliedFromDate"),n=Ie.map(e,"appliedToDate");return Ie.every(t,Boolean)&&Ie.every(n,Boolean)}showCheckBoxLabel(e){switch(this.selectedPlanType){case this._PLAN_TYPE.ROOM_TYPE:return`[${e.vendorRoomTypeSeq}] ${e.roomTypeNameEn}`;case this._PLAN_TYPE.RATE_PLAN:return`[${e.vendorRoomPlanSeq}] ${e.roomTypeNameEn} - ${e.roomPlanNameEn}`;case this._PLAN_TYPE.PROMOTION_PLAN:return`${e.planPromotionName}`;default:return console.error("Invalid plan type"),"PLAN TYPE ERROR"}}resetIncludeDates(){this.upsertForm.get("stopPeriod").get("includeDates").setValue([])}resetExcludeDates(){this.upsertForm.get("stopPeriod").get("excludeDates").setValue([])}_initSubscription(){this.upsertForm.get("__planTypeSelectControl").valueChanges.pipe(Object(De.a)(this._unsubscribe$),Object(jn.a)()).subscribe(e=>{this.checkedPlanList=[],this.planTypeArray.clear()})}_addPlanItemToPlanTypeArray(e){const t=this._dataService.generatePlanTypeGroup();t.patchValue(e),this.planTypeArray.push(t)}_removePlanItemFromPlanTypeArray(e){const t=this._findIndexInPlanTypeArray(e);-1!==t?this.planTypeArray.removeAt(t):console.error("Cannot find plan item in plan type array",this.planTypeArray.value,e)}_findIndexInPlanTypeArray(e){const t=this.planTypeArray.value;switch(this.selectedPlanType){case this._PLAN_TYPE.ROOM_TYPE:return Ie.findIndex(t,{vendorRoomTypeSeq:e.vendorRoomTypeSeq});case this._PLAN_TYPE.RATE_PLAN:case this._PLAN_TYPE.PROMOTION_PLAN:return Ie.findIndex(t,{vendorRoomPlanSeq:e.vendorRoomPlanSeq});default:return console.error("Invalid plan type"),-1}}_v_isDateConditionFilled(){var e;const t=this.upsertForm.controls.stopPeriod.controls.includeDates,n=this._v_isPeriodArrayFilled(),o=(null===(e=t.value)||void 0===e?void 0:e.length)>0&&t.valid;return n||o}_v_isPeriodArrayFilled(){const e=this.periodArray.value;return!!((null==e?void 0:e.length)>0&&this.periodArray.valid)&&(!(1!==(null==e?void 0:e.length)||!e[0].appliedFromDate||!e[0].appliedToDate)||Ie.every(e,e=>e.appliedFromDate&&e.appliedToDate))}}return e.\u0275fac=function(t){return new(t||e)(Ne.Qb(No),Ne.Qb(Ge.a),Ne.Qb(We.a))},e.\u0275cmp=Ne.Kb({type:e,selectors:[["app-stop-or-start-selling-detail"]],inputs:{checkedDateInfo:"checkedDateInfo",isImmutableIncludeDays:"isImmutableIncludeDays",hotelSimpleInfo:"hotelSimpleInfo",hotelContractSeq:"hotelContractSeq",includeDays:"includeDays",excludeDays:"excludeDays",planListByTypeForStopSaleDetail:"planListByTypeForStopSaleDetail"},outputs:{openCalendarEvent:"openCalendarEvent",submitEvent:"submitEvent",closeEvent:"closeEvent"},decls:71,vars:17,consts:[[1,"main-contents-summary-inner","mb20"],[1,"font-size-lg","font-weight-bold"],[3,"formGroup","connectForm"],[1,"promotion-rate"],[1,"page-item"],[1,"page-item-header"],[1,"table","table-bordered"],["width","130px"],["formGroupName","stopPeriod"],[4,"ngIf"],["scope","row",1,"th-bg"],["type","button","class","btn btn-light sm mt10 full",3,"click",4,"ngIf"],["type","button","class","btn btn-secondary sm mt5 mb5 full",3,"click",4,"ngIf"],[1,"textarea"],["formControlName","includeDates","cols","30","rows","3","readonly",""],[1,"page-item-header",2,"display","flex","justify-content","space-between","align-items","center"],[1,"sm","line","select-box"],["formControlName","__planTypeSelectControl",3,"options","useAllOptionYn"],[1,"item-box"],["label","All","binary","true",3,"value","disabled","onChange",4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"fitContent","table","table-bordered"],[1,"width100"],["width","60%"],["width","20%"],["scope","col",1,"align-c"],["formArrayName","roomTypePlans"],[4,"ngFor","ngForOf"],["style","text-align: center; font-size: 13px",4,"ngIf"],[1,"button-area","align-r","mt10"],[1,"btn","btn-secondary","sm",3,"click"],[1,"btn","btn-light","sm",3,"click"],["formArrayName","periods"],["class","form-group",4,"ngFor","ngForOf"],[1,"form-group"],[3,"formGroupName"],[1,"input","calendar","d-inline-flex","flex-fill"],[3,"for"],["type","text","placeholder","YYYY-MM-DD","formControlName","appliedFromDate",3,"matDatepicker"],["myPickerFrom",""],[1,"dash"],[1,"input","calendar","d-inline-flex","flex-fill","mr20"],["type","text","placeholder","YYYY-MM-DD","formControlName","appliedToDate",3,"matDatepicker"],["myPickerTo",""],["binary","true","label","All",3,"ngModel","ngModelOptions","onChange"],["formControlName","appliedMonYn","binary","true","label","Mon"],["formControlName","appliedTueYn","binary","true","label","Tue"],["formControlName","appliedWedYn","binary","true","label","Wed"],["formControlName","appliedThuYn","binary","true","label","Thu"],["formControlName","appliedFriYn","binary","true","label","Fri"],["formControlName","appliedSatYn","binary","true","label","Sat"],["formControlName","appliedSunYn","binary","true","label","Sun"],["type","button",1,"btn","btn-outline-secondary","btn-icon-only","xs","ml10",3,"click"],[1,"fas",3,"ngClass"],["type","button",1,"btn","btn-light","sm","mt10","full",3,"click"],["type","button",1,"btn","btn-secondary","sm","mt5","mb5","full",3,"click"],["type","button",1,"btn","btn","btn-secondary","sm","mt5","mb5","full",3,"click"],["formControlName","excludeDates","cols","30","rows","3","readonly",""],["label","All","binary","true",3,"value","disabled","onChange"],[3,"ngModel","value","label","ngModelOptions","disabled","ngModelChange","onChange"],["formControlName","salesStopYn","label","Stop",3,"name","value","checked"],["formControlName","salesStopYn","label","Sell",3,"name","value","checked"],[2,"text-align","center","font-size","13px"]],template:function(e,t){1&e&&(Ne.Wb(0,"div",0),Ne.Wb(1,"p",1),Ne.Pc(2),Ne.Vb(),Ne.Vb(),Ne.Wb(3,"form",2),Ne.Wb(4,"div",3),Ne.Wb(5,"div",4),Ne.Wb(6,"div",5),Ne.Wb(7,"strong"),Ne.Wb(8,"sup"),Ne.Pc(9,"Date Condition"),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Wb(10,"div",6),Ne.Wb(11,"table"),Ne.Wb(12,"caption"),Ne.Pc(13," Date Condition "),Ne.Vb(),Ne.Wb(14,"colgroup"),Ne.Rb(15,"col",7),Ne.Rb(16,"col"),Ne.Vb(),Ne.Wb(17,"tbody",8),Ne.Nc(18,_o,6,1,"tr",9),Ne.Wb(19,"tr"),Ne.Wb(20,"th",10),Ne.Pc(21," Include Days "),Ne.Nc(22,xo,2,0,"button",11),Ne.Nc(23,jo,2,0,"button",12),Ne.Vb(),Ne.Wb(24,"td"),Ne.Wb(25,"div",13),Ne.Rb(26,"textarea",14),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Nc(27,Yo,10,0,"tr",9),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Wb(28,"div",4),Ne.Wb(29,"div",15),Ne.Wb(30,"strong"),Ne.Wb(31,"sup"),Ne.Pc(32,"Select Room Type & Plan"),Ne.Vb(),Ne.Vb(),Ne.Wb(33,"div",16),Ne.Rb(34,"app-selectbox",17),Ne.Vb(),Ne.Vb(),Ne.Wb(35,"div",18),Ne.Wb(36,"ul"),Ne.Wb(37,"li"),Ne.Nc(38,Mo,1,2,"app-checkbox",19),Ne.Vb(),Ne.Ub(39,20),Ne.Nc(40,qo,2,1,"ng-container",21),Ne.Nc(41,Ho,2,1,"ng-container",21),Ne.Nc(42,Go,2,1,"ng-container",21),Ne.Tb(),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Wb(43,"div",4),Ne.Wb(44,"div",5),Ne.Wb(45,"strong"),Ne.Wb(46,"sup"),Ne.Pc(47,"Setting for Stop or Sell"),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Wb(48,"div",22),Ne.Wb(49,"table",23),Ne.Wb(50,"caption"),Ne.Pc(51," Detail option "),Ne.Vb(),Ne.Wb(52,"colgroup"),Ne.Rb(53,"col",24),Ne.Rb(54,"col",25),Ne.Vb(),Ne.Wb(55,"thead"),Ne.Wb(56,"tr"),Ne.Wb(57,"th",26),Ne.Pc(58,"Room & Plan Type"),Ne.Vb(),Ne.Wb(59,"th",26),Ne.Wb(60,"sup"),Ne.Pc(61,"Sales Stop Y/N"),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Wb(62,"tbody"),Ne.Ub(63,27),Ne.Nc(64,Bo,9,8,"tr",28),Ne.Tb(),Ne.Vb(),Ne.Vb(),Ne.Nc(65,Xo,2,0,"p",29),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Wb(66,"div",30),Ne.Wb(67,"button",31),Ne.fc("click",(function(){return t.onSubmit()})),Ne.Pc(68,"Save"),Ne.Vb(),Ne.Wb(69,"button",32),Ne.fc("click",(function(){return t.onClose()})),Ne.Pc(70,"Close"),Ne.Vb(),Ne.Vb(),Ne.Vb()),2&e&&(Ne.Cb(2),Ne.Sc(" [",null==t.hotelSimpleInfo?null:t.hotelSimpleInfo.hotelCode,"] ",null==t.hotelSimpleInfo?null:t.hotelSimpleInfo.hotelNameEn," "),Ne.Cb(1),Ne.pc("formGroup",t.upsertForm)("connectForm",t.upsertFormData),Ne.Cb(15),Ne.pc("ngIf",!t.isImmutableIncludeDays),Ne.Cb(4),Ne.pc("ngIf",!t.isImmutableIncludeDays),Ne.Cb(1),Ne.pc("ngIf",!t.isImmutableIncludeDays),Ne.Cb(4),Ne.pc("ngIf",!t.isImmutableIncludeDays),Ne.Cb(7),Ne.pc("options",t.planTypeSelectOptionList)("useAllOptionYn",!1),Ne.Cb(4),Ne.pc("ngIf",!t.isImmutableIncludeDays),Ne.Cb(1),Ne.pc("ngSwitch",t.selectedPlanType),Ne.Cb(1),Ne.pc("ngSwitchCase",t._PLAN_TYPE.ROOM_TYPE),Ne.Cb(1),Ne.pc("ngSwitchCase",t._PLAN_TYPE.RATE_PLAN),Ne.Cb(1),Ne.pc("ngSwitchCase",t._PLAN_TYPE.PROMOTION_PLAN),Ne.Cb(22),Ne.pc("ngForOf",null==t.planTypeArray?null:t.planTypeArray.controls),Ne.Cb(1),Ne.pc("ngIf",t.planTypeArray.value.length<1))},directives:[a.B,a.s,a.k,xe.a,a.l,i.o,a.c,a.r,a.i,Ye.a,i.q,i.r,a.e,i.n,lo.a,co.a,so.a,Me.a,a.u,i.l,Fo.a],styles:["textarea[_ngcontent-%COMP%]:-moz-read-only{background-color:#f5f5f5}textarea[_ngcontent-%COMP%]:read-only{background-color:#f5f5f5}.planCheckbox[_ngcontent-%COMP%]{margin-left:30px}"],changeDetection:0}),e})();var Qo=n("asRa"),Ko=n("EfGc");function Jo(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"app-plan-detail",15),Ne.fc("closeEvent",(function(){return Ne.Fc(e),Ne.hc().closePlanDetailPopupHandler()})),Ne.Vb()}if(2&e){const e=Ne.hc();Ne.pc("selectedHotelSimple",e.selectedHotelSimple)("vendorRoomPlanSeq",e.clickedPlanSeq)}}function Zo(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"app-room-detail",16),Ne.fc("closeEvent",(function(){return Ne.Fc(e),Ne.hc().closeRoomDetailPopupHandler()})),Ne.Vb()}if(2&e){const e=Ne.hc();Ne.pc("selectedHotelSimple",e.selectedHotelSimple)("vendorRoomTypeSeq",e.clickedVendorRoomTypeSeq)}}function ei(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"app-rate-detail",17),Ne.fc("openCalendarEvent",(function(t){return Ne.Fc(e),Ne.hc().openCalendarDetailPopupHandler(t)}))("submitEvent",(function(t){return Ne.Fc(e),Ne.hc().saveRateHandler(t)}))("closeEvent",(function(){return Ne.Fc(e),Ne.hc().closeRateDetailPopupHandler()})),Ne.Vb()}if(2&e){const e=Ne.hc();Ne.pc("hotelProfile",e.selectedHotelSimple)("promotionCheckedDateInfo",e.promotionCheckedDateInfo)("isImmutableIncludeDays",e.isDetail)("isUpdateModal",e.isDetail)("planList",e.planList)("checkedDateInfo",e.checkedDateInfo)("includeDays",e.selectedIncludeDays)("excludeDays",e.selectedExcludeDays)}}function ti(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"app-allotment-detail",18),Ne.fc("openCalendarEvent",(function(t){return Ne.Fc(e),Ne.hc().openCalendarDetailPopupHandler(t)}))("submitEvent",(function(t){return Ne.Fc(e),Ne.hc().saveAllotmentHandler(t)}))("closeEvent",(function(){return Ne.Fc(e),Ne.hc().closeAllotmentDetailPopupHandler()})),Ne.Vb()}if(2&e){const e=Ne.hc();Ne.pc("isImmutableIncludeDays",e.isDetail)("roomList",e.roomList)("includeDays",e.selectedIncludeDays)("excludeDays",e.selectedExcludeDays)("checkedDateInfo",e.checkedDateInfo)("contractData",e.selectedContractData)("hotelSimpleInfo",e.selectedHotelSimple)}}function ni(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"app-stop-or-start-selling-detail",19),Ne.fc("openCalendarEvent",(function(t){return Ne.Fc(e),Ne.hc().openCalendarDetailPopupHandler(t)}))("submitEvent",(function(t){return Ne.Fc(e),Ne.hc().saveStopSaleHandler(t)}))("closeEvent",(function(){return Ne.Fc(e),Ne.hc().closeStopSaleDetailPopupHandler()})),Ne.Vb()}if(2&e){const e=Ne.hc();Ne.pc("isImmutableIncludeDays",e.isDetail)("planListByTypeForStopSaleDetail",e.planListByTypeForStopSaleDetail)("checkedDateInfo",e.checkedDateInfo)("hotelContractSeq",e.hotelContractSeq)("includeDays",e.selectedIncludeDays)("excludeDays",e.selectedExcludeDays)("hotelSimpleInfo",e.selectedHotelSimple)}}function oi(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"app-vendor-promotion-detail",20),Ne.fc("closeEvent",(function(){return Ne.Fc(e),Ne.hc().closePromotionDetailPopupHandler()})),Ne.ic(1,"async"),Ne.Vb()}if(2&e){const e=Ne.hc();Ne.pc("planList",e.planList)("addWithOnlyDate",e.addWithOnlyDate)("promotionTypes",Ne.jc(1,5,e.promotionTypeOptions$))("masterInfo",e.selectedPromotionData)("isResetPromotionSeq",e.isNewPromotion)}}function ii(e,t){if(1&e){const e=Ne.Xb();Ne.Wb(0,"app-calendar-view",21),Ne.fc("submitEvent",(function(t){return Ne.Fc(e),Ne.hc().selectedDateHandler(t)}))("closeEvent",(function(){return Ne.Fc(e),Ne.hc().closeCalendarHandler()})),Ne.Vb()}if(2&e){const e=Ne.hc();Ne.pc("minDate",e.minDate)("allotmentParameters",e.allotmentParameters)("isPreview",e.isCalendarPreview)("subTextDatas",e.subTextDatas)("validDateRange",e.validDateRange)}}let ai=(()=>{class e{constructor(e,t,n,o){this.store=e,this.apiService=t,this.alertService=n,this.allotmentDataService=o,this.isNewPromotion=!1,this.unsubscribe$=new ge.a,this.promotionTypeOptions$=e.pipe(Object(l.u)(ae)),this.isOpenPlanDetailPopup$=e.pipe(Object(l.u)(pe)),this.isOpenRoomDetailPopup$=e.pipe(Object(l.u)(de)),this.isOpenRateDetailPopup$=e.pipe(Object(l.u)(ue)),this.isOpenAllotmentDetailPopup$=e.pipe(Object(l.u)(me)),this.isOpenStopSaleDetailPopup$=e.pipe(Object(l.u)(be)),this.isOpenPromotionDetailPopup$=e.pipe(Object(l.u)(he)),this.isOpenCalendarPopup$=e.pipe(Object(l.u)(se)),this.checkedDate$=this.store.pipe(Object(l.u)(le)),this.searchCondition$=this.store.pipe(Object(l.u)(ie)),this.promotionCheckedDateInfo$=this.store.pipe(Object(l.u)(Ce))}ngOnInit(){this._initSubscription(),this.store.dispatch(_({condition:{masterCode:"HO022"}}))}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}openPlanDetailPopupHandler({planSeq:e}){this.clickedPlanSeq=e,this.store.dispatch($())}closePlanDetailPopupHandler(){this.store.dispatch(q())}openRoomDetailPopupHandler(e){this.clickedVendorRoomTypeSeq=e.vendorRoomTypeSeq,this.store.dispatch(w())}closeRoomDetailPopupHandler(){this.store.dispatch(H())}openRateDetailPopupHandler(e){var t,n,o,i,a,r;if(!(this._checkIfNoneIsSeleceted()||this._checkIfOneContractSelected()&&this._checkIfOnlyOnePlanTypeSelected()))return void this.alertService.alert({message:"Please select dates for the rate plan code."});if(!(null===(n=null===(t=e.roomPlanList)||void 0===t?void 0:t[0])||void 0===n?void 0:n.vendorRoomPlanSeq)&&!(null===(i=null===(o=e.promotionPlanList)||void 0===o?void 0:o[0])||void 0===i?void 0:i.planPromotionSeq))return void this.alertService.alert({message:"There is no rate plan code"});const l=null===(r=null===(a=this.checkedDateInfo[0])||void 0===a?void 0:a.plans[0])||void 0===r?void 0:r.dates;this.planList=e,this.selectedIncludeDays=l,this.store.dispatch(U())}closeRateDetailPopupHandler(){this.store.dispatch(V()),this.store.dispatch(G())}saveRateHandler(e){this.apiService.upsertRate(e).subscribe(e=>{this.searchComponent.onSubmit(),this.alertService.alert({message:"Your data has been saved."}),this.store.dispatch(G())})}openAllotmentDetailPopupHandler(e){var t,n;if(!(this._checkIfNoneIsSeleceted()||this._checkIfOneContractSelected()&&this._checkIfOnlyOneRoomTypeSelected()))return void this.alertService.alert({message:"Please select dates for the room type code."});this.selectedContractData=e;const o=e.vendorRoomTypes.reduce((e,t)=>(!1===t.salesStopYn&&e.push({roomTypeNameEn:t.vendorRoomTypeNameEn,vendorRoomTypeSeq:t.vendorRoomTypeSeq}),e),[]);this.roomList=o,this.selectedIncludeDays=null===(n=null===(t=this.checkedDateInfo[0])||void 0===t?void 0:t.rooms[0])||void 0===n?void 0:n.dates,this.store.dispatch(B())}closeAllotmentDetailPopupHandler(){this.selectedContractData=null,this.store.dispatch(X())}saveAllotmentHandler(e){this.apiService.upsertAllotment(e).subscribe(e=>{this.searchComponent.onSubmit(),this.alertService.alert({message:"Your data has been saved."}),this.store.dispatch(X())})}openStopSaleDetailPopupHandler(e){this._checkIfNoneIsSeleceted()||this._checkIfOneContractSelected()&&this._checkIfOnlyOneRoomTypeSelected()||this._checkIfOneContractSelected()&&this._checkIfOnlyOnePlanTypeSelected()?(this.hotelContractSeq=e.hotelContractSeq,this.planListByTypeForStopSaleDetail=this.allotmentDataService.getPlanListByTypeData(e,this.checkedDateInfo),this.store.dispatch(z())):this.alertService.alert({message:"Please select only one room type code or plan type code."})}closeStopSaleDetailPopupHandler(){this.store.dispatch(Q())}saveStopSaleHandler(e){this.apiService.upsertStopSales(e).subscribe(e=>{this.searchComponent.onSubmit(),this.alertService.alert({message:"Your data has been saved."}),this.store.dispatch(Q())})}openPromotionDetailPopupHandler(e){this.planList=e.list,e.planPromotionSeq&&(this.isNewPromotion=e.isNewPromotion||!1,this.addWithOnlyDate=e.addWithOnlyDate||!1,this.apiService.getPromotion({hotelCode:this.selectedHotelSimple.hotelCode,planPromotionSeq:e.planPromotionSeq,limits:[0,1]}).subscribe(e=>{var t;1===(null===(t=null==e?void 0:e.list)||void 0===t?void 0:t.length)&&(this.selectedPromotionData=e.list[0],this.store.dispatch(K()))}))}closePromotionDetailPopupHandler(){this.isNewPromotion=!1,this.addWithOnlyDate=!1,this.selectedPromotionData=null,this.planList=[],this.store.dispatch(J())}savePromotionHandler(e){this.apiService.upsertStopSales(e).subscribe(e=>{this.searchComponent.onSubmit(),this.alertService.alert({message:"Your data has been saved.",accept:()=>{this.store.dispatch(J())}})})}openCalendarDetailPopupHandler({type:e,isPreview:t,minDate:n,subTextDatas:o,validDateRange:i,allotmentParameters:a}){this.selectedDateType=e,this.validDateRange=i,this.minDate=n,this.subTextDatas=o,this.allotmentParameters=a,this.isCalendarPreview=t,this.store.dispatch(Y())}closeCalendarHandler(){this.store.dispatch(M())}selectedDateHandler(e){"include"===this.selectedDateType?this.selectedIncludeDays=e:"exclude"===this.selectedDateType&&(this.selectedExcludeDays=e)}rateDetailTitle(){return this.promotionCheckedDateInfo?"Promotion Rate Update":this.isDetail?"Rate Update":"Rate Create"}_initSubscription(){this.searchCondition$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.selectedHotelSimple=e&&{hotelCode:e.hotelCode,hotelNameEn:e.hotelNameEn}}),this.checkedDate$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{var t;this.checkedDateInfo=e,this.isDetail=(null!==(t=null==e?void 0:e.length)&&void 0!==t?t:0)>0}),this.promotionCheckedDateInfo$.pipe(Object(De.a)(this.unsubscribe$)).subscribe(e=>{this.promotionCheckedDateInfo=e,this.isDetail=!1===Ie.isEmpty(e)}),Object(ye.a)(this.isOpenRateDetailPopup$,this.isOpenAllotmentDetailPopup$,this.isOpenStopSaleDetailPopup$).pipe(Object(De.a)(this.unsubscribe$),Object(Se.a)(e=>!1===e)).subscribe(()=>{this.selectedIncludeDays=[],this.selectedExcludeDays=[]})}_checkIfNoneIsSeleceted(){return!this.checkedDateInfo.length}_checkIfOneContractSelected(){return 1===this.checkedDateInfo.length}_checkIfOnlyOneRoomTypeSelected(){var e,t,n,o;const i=!(null===(t=null===(e=this.checkedDateInfo[0])||void 0===e?void 0:e.rooms)||void 0===t?void 0:t.find(e=>{var t;return e.roomId!==(null===(t=this.checkedDateInfo[0])||void 0===t?void 0:t.rooms[0].roomId)})),a=null===(o=null===(n=this.checkedDateInfo[0])||void 0===n?void 0:n.plans)||void 0===o?void 0:o.length;return!0===i&&0===a}_checkIfOnlyOnePlanTypeSelected(){var e,t,n,o;const i=null===(t=null===(e=this.checkedDateInfo[0])||void 0===e?void 0:e.rooms)||void 0===t?void 0:t.length,a=!(null===(o=null===(n=this.checkedDateInfo[0])||void 0===n?void 0:n.plans)||void 0===o?void 0:o.find(e=>{var t;return e.planId!==(null===(t=this.checkedDateInfo[0])||void 0===t?void 0:t.plans[0].planId)}));return 0===i&&!0===a}}return e.\u0275fac=function(t){return new(t||e)(Ne.Qb(l.h),Ne.Qb(Fe.a),Ne.Qb(Ge.a),Ne.Qb(Be))},e.\u0275cmp=Ne.Kb({type:e,selectors:[["app-rate-allotment"]],viewQuery:function(e,t){var n;1&e&&Ne.Xc(Ue,!0),2&e&&Ne.Dc(n=Ne.gc())&&(t.searchComponent=n.first)},decls:32,vars:55,consts:[[1,"tabs-contents","tabs-main-contents"],[1,"active"],[3,"openRoomDetailEvent","openAllotmentDetailEvent","openStopSaleDetailEvent","openRateDetailEvent","openPlanDetailEvent","openPromotionDetailEvent","openCalendarDetailEvent"],["header","Hotel Plan Master","modalSize","lg",3,"visible","modal","hasScroll","visibleChange"],[3,"selectedHotelSimple","vendorRoomPlanSeq","closeEvent",4,"ngIf"],["header","Hotel Room Master","modalSize","lg",3,"visible","modal","hasScroll","visibleChange"],[3,"selectedHotelSimple","vendorRoomTypeSeq","closeEvent",4,"ngIf"],["modalContentClass","pd-all","modalSize","lg",3,"header","visible","modal","visibleChange"],[3,"hotelProfile","promotionCheckedDateInfo","isImmutableIncludeDays","isUpdateModal","planList","checkedDateInfo","includeDays","excludeDays","openCalendarEvent","submitEvent","closeEvent",4,"ngIf"],[3,"isImmutableIncludeDays","roomList","includeDays","excludeDays","checkedDateInfo","contractData","hotelSimpleInfo","openCalendarEvent","submitEvent","closeEvent",4,"ngIf"],[3,"isImmutableIncludeDays","planListByTypeForStopSaleDetail","checkedDateInfo","hotelContractSeq","includeDays","excludeDays","hotelSimpleInfo","openCalendarEvent","submitEvent","closeEvent",4,"ngIf"],["header","Vendor Promotion Detail","modalSize","lg",3,"visible","modal","hasScroll","visibleChange"],[3,"planList","addWithOnlyDate","promotionTypes","masterInfo","isResetPromotionSeq","closeEvent",4,"ngIf"],["header","Calendar","modalContentClass","pd-all","modalSize","md",3,"visible","modal","visibleChange"],[3,"minDate","allotmentParameters","isPreview","subTextDatas","validDateRange","submitEvent","closeEvent",4,"ngIf"],[3,"selectedHotelSimple","vendorRoomPlanSeq","closeEvent"],[3,"selectedHotelSimple","vendorRoomTypeSeq","closeEvent"],[3,"hotelProfile","promotionCheckedDateInfo","isImmutableIncludeDays","isUpdateModal","planList","checkedDateInfo","includeDays","excludeDays","openCalendarEvent","submitEvent","closeEvent"],[3,"isImmutableIncludeDays","roomList","includeDays","excludeDays","checkedDateInfo","contractData","hotelSimpleInfo","openCalendarEvent","submitEvent","closeEvent"],[3,"isImmutableIncludeDays","planListByTypeForStopSaleDetail","checkedDateInfo","hotelContractSeq","includeDays","excludeDays","hotelSimpleInfo","openCalendarEvent","submitEvent","closeEvent"],[3,"planList","addWithOnlyDate","promotionTypes","masterInfo","isResetPromotionSeq","closeEvent"],[3,"minDate","allotmentParameters","isPreview","subTextDatas","validDateRange","submitEvent","closeEvent"]],template:function(e,t){1&e&&(Ne.Wb(0,"div",0),Ne.Wb(1,"div",1),Ne.Rb(2,"app-search"),Ne.Wb(3,"app-calendar",2),Ne.fc("openRoomDetailEvent",(function(e){return t.openRoomDetailPopupHandler(e)}))("openAllotmentDetailEvent",(function(e){return t.openAllotmentDetailPopupHandler(e)}))("openStopSaleDetailEvent",(function(e){return t.openStopSaleDetailPopupHandler(e)}))("openRateDetailEvent",(function(e){return t.openRateDetailPopupHandler(e)}))("openPlanDetailEvent",(function(e){return t.openPlanDetailPopupHandler(e)}))("openPromotionDetailEvent",(function(e){return t.openPromotionDetailPopupHandler(e)}))("openCalendarDetailEvent",(function(e){return t.openCalendarDetailPopupHandler(e)})),Ne.Vb(),Ne.Vb(),Ne.Vb(),Ne.Wb(4,"app-dialog",3),Ne.fc("visibleChange",(function(){return t.closePlanDetailPopupHandler()})),Ne.ic(5,"async"),Ne.Nc(6,Jo,1,2,"app-plan-detail",4),Ne.ic(7,"async"),Ne.Vb(),Ne.Wb(8,"app-dialog",5),Ne.fc("visibleChange",(function(){return t.closeRoomDetailPopupHandler()})),Ne.ic(9,"async"),Ne.Nc(10,Zo,1,2,"app-room-detail",6),Ne.ic(11,"async"),Ne.Vb(),Ne.Wb(12,"app-dialog",7),Ne.fc("visibleChange",(function(){return t.closeRateDetailPopupHandler()})),Ne.ic(13,"async"),Ne.Nc(14,ei,1,8,"app-rate-detail",8),Ne.ic(15,"async"),Ne.Vb(),Ne.Wb(16,"app-dialog",7),Ne.fc("visibleChange",(function(){return t.closeAllotmentDetailPopupHandler()})),Ne.ic(17,"async"),Ne.Nc(18,ti,1,7,"app-allotment-detail",9),Ne.ic(19,"async"),Ne.Vb(),Ne.Wb(20,"app-dialog",7),Ne.fc("visibleChange",(function(){return t.closeStopSaleDetailPopupHandler()})),Ne.ic(21,"async"),Ne.Nc(22,ni,1,7,"app-stop-or-start-selling-detail",10),Ne.ic(23,"async"),Ne.Vb(),Ne.Wb(24,"app-dialog",11),Ne.fc("visibleChange",(function(){return t.closePromotionDetailPopupHandler()})),Ne.ic(25,"async"),Ne.Nc(26,oi,2,7,"app-vendor-promotion-detail",12),Ne.ic(27,"async"),Ne.Vb(),Ne.Wb(28,"app-dialog",13),Ne.fc("visibleChange",(function(){return t.closeCalendarHandler()})),Ne.ic(29,"async"),Ne.Nc(30,ii,1,5,"app-calendar-view",14),Ne.ic(31,"async"),Ne.Vb()),2&e&&(Ne.Cb(4),Ne.pc("visible",Ne.jc(5,27,t.isOpenPlanDetailPopup$))("modal",!0)("hasScroll",!1),Ne.Cb(2),Ne.pc("ngIf",Ne.jc(7,29,t.isOpenPlanDetailPopup$)),Ne.Cb(2),Ne.pc("visible",Ne.jc(9,31,t.isOpenRoomDetailPopup$))("modal",!0)("hasScroll",!1),Ne.Cb(2),Ne.pc("ngIf",Ne.jc(11,33,t.isOpenRoomDetailPopup$)),Ne.Cb(2),Ne.pc("header",t.rateDetailTitle())("visible",Ne.jc(13,35,t.isOpenRateDetailPopup$))("modal",!0),Ne.Cb(2),Ne.pc("ngIf",Ne.jc(15,37,t.isOpenRateDetailPopup$)),Ne.Cb(2),Ne.rc("header","Allotment ",t.isDetail?"Update":"Create",""),Ne.pc("visible",Ne.jc(17,39,t.isOpenAllotmentDetailPopup$))("modal",!0),Ne.Cb(2),Ne.pc("ngIf",Ne.jc(19,41,t.isOpenAllotmentDetailPopup$)),Ne.Cb(2),Ne.rc("header","Stop/Start Selling ",t.isDetail?"Update":"Create",""),Ne.pc("visible",Ne.jc(21,43,t.isOpenStopSaleDetailPopup$))("modal",!0),Ne.Cb(2),Ne.pc("ngIf",Ne.jc(23,45,t.isOpenStopSaleDetailPopup$)),Ne.Cb(2),Ne.pc("visible",Ne.jc(25,47,t.isOpenPromotionDetailPopup$))("modal",!0)("hasScroll",!1),Ne.Cb(2),Ne.pc("ngIf",Ne.jc(27,49,t.isOpenPromotionDetailPopup$)),Ne.Cb(2),Ne.pc("visible",Ne.jc(29,51,t.isOpenCalendarPopup$))("modal",!0),Ne.Cb(2),Ne.pc("ngIf",Ne.jc(31,53,t.isOpenCalendarPopup$)))},directives:[Ue,An,Ln.a,i.o,En.a,Wn.a,ko,To.a,zo,Qo.a,Ko.a],pipes:[i.b],styles:[".rateAllotmentContainer[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:relative}"],changeDetection:0}),e})();const ri=[{path:"",component:ai,data:{title:"Plan Master"}}];let li=(()=>{class e{}return e.\u0275mod=Ne.Ob({type:e}),e.\u0275inj=Ne.Nb({factory:function(t){return new(t||e)},imports:[[D.f.forChild(ri)],D.f]}),e})();var ci=n("vu/V"),si=n("VIhy"),pi=n("/0iE"),di=n("5fwj"),ui=n("px/L");let mi=(()=>{class e{}return e.\u0275mod=Ne.Ob({type:e}),e.\u0275inj=Ne.Nb({factory:function(t){return new(t||e)},imports:[[i.c,a.m,a.w,o.a,c.m,p.a,y.a,b.a,u.a,P.a,f.a,C.a,d.a,m.a,ci.a,ui.a,g.a]]}),e})();var bi=n("s7Dg");const hi=[];let fi=(()=>{class e{}return e.\u0275mod=Ne.Ob({type:e}),e.\u0275inj=Ne.Nb({factory:function(t){return new(t||e)},imports:[[D.f.forChild(hi)],D.f]}),e})(),vi=(()=>{class e{}return e.\u0275mod=Ne.Ob({type:e}),e.\u0275inj=Ne.Nb({factory:function(t){return new(t||e)},imports:[[i.c,a.m,a.w,o.a,c.m,p.a,y.a,b.a,u.a,P.a,f.a,C.a,d.a,m.a,ci.a,ui.a,g.a,fi,g.a]]}),e})();var Pi=n("TEiF"),Ci=n("eIep"),gi=n("lJxs"),yi=n("JIr8"),Di=n("vkgz"),Si=n("LRne"),Ii=n("Xb6A");let Oi=(()=>{class e{constructor(e,t,n,o,i){this.actions$=e,this.service=t,this.alertService=n,this._errorService=o,this.store=i,this.loadRateAllotment$=Object(r.c)(()=>this.actions$.pipe(Object(r.d)(S),Object(Te.a)(500),Object(Ci.a)(({condition:e})=>this.service.loadRateAllotment(e).pipe(Object(gi.a)(({list:e})=>({succeedYn:!0,list:e})),Object(yi.a)(e=>Object(Si.a)({succeedYn:!1,error:e})))),Object(Di.a)(({succeedYn:e,list:t,error:n})=>{if(e)this.store.dispatch(I({dataList:t}));else{const e="Data status list lookup failed. Please try again in a momentarily.",t=[O({error:e})];this._catchErr(n,e,t)}})),{dispatch:!1}),this.loadPromotionTypeList$=Object(r.c)(()=>this.actions$.pipe(Object(r.d)(_),Object(Ci.a)(()=>this.service.getPromotionType().pipe(Object(gi.a)(e=>({succeedYn:!0,datas:e})),Object(yi.a)(e=>Object(Si.a)({succeedYn:!1,error:e})))),Object(Di.a)(({succeedYn:e,datas:t,error:n})=>{if(e)this.store.dispatch(x({dataList:t}));else{const e="Promotion type list lookup failed. Please try again in a momentarily.",t=[j({error:e})];this._catchErr(n,e,t)}})),{dispatch:!1}),this.loadContractTypeCodeList$=Object(r.c)(()=>this.actions$.pipe(Object(r.d)(L),Object(Ci.a)(({condition:e})=>this.service.getDetailCodeList(e).pipe(Object(gi.a)(e=>({succeedYn:!0,datas:e})),Object(yi.a)(e=>Object(Si.a)({succeedYn:!1,error:e})))),Object(Di.a)(({succeedYn:e,datas:t,error:n})=>{if(e)this.store.dispatch(E({dataList:t}));else{const e="Contract type list lookup failed. Please try again in a momentarily.",t=[W({error:e})];this._catchErr(n,e,t)}})),{dispatch:!1})}_catchErr(e,t,n){const o=this._errorService.errorHandler(e,t);Ie.isNil(o)||(Ie.isNil(o.accept)&&(o.accept=(null==n?void 0:n.length)>0?()=>{n.forEach(e=>{this.store.dispatch(e)})}:()=>{}),this.alertService.alert(o))}}return e.\u0275fac=function(t){return new(t||e)(Ne.bc(r.a),Ne.bc(Fe.a),Ne.bc(Ge.a),Ne.bc(Ii.a),Ne.bc(l.h))},e.\u0275prov=Ne.Mb({token:e,factory:e.\u0275fac}),e})();var Ri=n("FGZR"),ki=n("YH7L");const Ti=[ai],Vi=[Ue,An,In,hn,en];let Ni=(()=>{class e{}return e.\u0275mod=Ne.Ob({type:e}),e.\u0275inj=Ne.Nb({factory:function(t){return new(t||e)},imports:[[i.c,a.m,a.w,o.a,c.m,s.a,p.a,y.a,b.a,h.a,u.a,P.a,f.a,C.a,d.a,m.a,v.a,ci.a,di.a,bi.a,g.a,si.a,mi,vi,pi.a,li,Ri.a,ki.a,Pi.a,l.j.forFeature("rateAllotmentShared",ee),r.b.forFeature([Oi])]]}),e})()},pb6r:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n("fXoL"),i=n("3Pt+"),a=n("ofXK");const r=function(){return{checkbox:!0}},l={provide:i.p,useExisting:Object(o.U)(()=>c),multi:!0};let c=(()=>{class e{constructor(e){this._changeDetectorRef=e,this.checkboxIcon="pi pi-check",this.onChange=new o.n,this.focused=!1,this.checked=!1,this.onModelChange=()=>{},this.onModelTouched=()=>{}}get value(){return this._value}set value(e){this._value=e,this.binary&&(this.model=this._value),this.writeValue(this.model)}onClick(e,t,n){e.preventDefault(),this.disabled||this.readonly||(this.checked=!this.checked,this.updateModel(),n&&t.focus())}updateModel(){this.binary?(this.onModelChange(this.checked),this.formControl&&this.formControl.setValue(this.checked)):(this.checked?this.addValue():this.removeValue(),this.onModelChange(this.model),this.formControl&&this.formControl.setValue(this.model)),this.onChange.emit(this.checked)}handleChange(e){this.readonly||(this.checked=e.target.checked,this.updateModel())}isChecked(){return this.binary?this.model:this.model&&this.model.indexOf(this.value)>-1}removeValue(){this.model=this.model.filter(e=>e!==this.value)}addValue(){this.model=this.model?[...this.model,this.value]:[this.value]}onFocus(e){this.focused=!0}onBlur(e){this.focused=!1,this.onModelTouched()}writeValue(e){this.model=e,this.checked=this.isChecked(),this._changeDetectorRef.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e}}return e.\u0275fac=function(t){return new(t||e)(o.Qb(o.h))},e.\u0275cmp=o.Kb({type:e,selectors:[["app-checkbox"]],inputs:{name:"name",disabled:"disabled",binary:"binary",label:"label",tabindex:"tabindex",inputId:"inputId",style:"style",styleClass:"styleClass",labelStyleClass:"labelStyleClass",formControl:"formControl",checkboxIcon:"checkboxIcon",readonly:"readonly",value:"value"},outputs:{onChange:"onChange"},features:[o.Bb([l])],decls:5,vars:12,consts:[[3,"ngClass","click"],["type","checkbox",1,"checkbox-control-input",3,"name","checked","readonly","disabled","value","focus","blur","change"],["cb",""],[1,"checkbox-control-text"]],template:function(e,t){if(1&e){const e=o.Xb();o.Wb(0,"label",0),o.fc("click",(function(n){o.Fc(e);const i=o.Ec(2);return t.onClick(n,i,!0)})),o.Wb(1,"input",1,2),o.fc("focus",(function(e){return t.onFocus(e)}))("blur",(function(e){return t.onBlur(e)}))("change",(function(e){return t.handleChange(e)})),o.Vb(),o.Wb(3,"span",3),o.Pc(4),o.Vb(),o.Vb()}2&e&&(o.Eb(t.styleClass),o.pc("ngClass",o.tc(11,r)),o.Cb(1),o.pc("name",t.name)("checked",t.checked)("readonly",t.readonly)("disabled",t.disabled)("value",t.value),o.Db("id",t.inputId)("tabindex",t.tabindex),o.Cb(3),o.Qc(t.label))},directives:[a.l],encapsulation:2}),e})()},w8np:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var o=n("ofXK"),i=n("3Pt+"),a=n("WG3B"),r=n("wPo9"),l=n("7rOj"),c=n("l1P7"),s=n("v7zA"),p=n("fXoL");let d=(()=>{class e{}return e.\u0275mod=p.Ob({type:e}),e.\u0275inj=p.Nb({factory:function(t){return new(t||e)},imports:[[o.c,i.m,i.w,a.m,r.a,l.a,c.a,s.a]]}),e})()},wPo9:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n("ofXK"),i=n("3Pt+"),a=n("WG3B"),r=n("qXPF"),l=n("fXoL");let c=(()=>{class e{}return e.\u0275mod=l.Ob({type:e}),e.\u0275inj=l.Nb({factory:function(t){return new(t||e)},imports:[[o.c,i.m,i.w,a.m,r.a]]}),e})()}}]);