function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"6H05":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("fXoL"),r=n("LvDl"),a=n("9Wiz"),s=n("EsKh"),c=n("3Pt+"),o=n("+Sob"),l=n("gbCm"),m=n("NCYe"),u=function(){var e=function(){function e(t,n){_classCallCheck(this,e),this._dataService=t,this._alertService=n,this.sendEmailEvent=new i.n,this.closeEvent=new i.n,this.postForm=t.generateReservationSendEmailTemplatePostForm()}return _createClass(e,[{key:"ngOnInit",value:function(){this._setPostFormData()}},{key:"onSubmit",value:function(){var e=this;if(this.postForm.invalid)return this._checkValid=!0,void Object.keys(this.postForm.controls).forEach((function(t){e.postForm.controls[t].invalid&&console.error(t+" is invalid")}));var t=this._setPostFormCondition(this.postForm.value);t&&this.sendEmailEvent.emit(t)}},{key:"checkIsInvalid",value:function(e){return this._checkValid&&this.postForm.get(e)&&this.postForm.get(e).invalid}},{key:"onClose",value:function(){this.closeEvent.emit()}},{key:"_setPostFormData",value:function(){this.postFormData=this._dataService.initReservationSendEmailTemplatePostForm()}},{key:"_setPostFormCondition",value:function(e){var t,n=e.receiverName,i=e.receiverEmailAddress,a=e.ccReceiverName,s=e.ccEmailAddress,c=e.bccReceiverName,o=e.bccEmailAddress,l=e.senderName,m=e.senderEmailAddress,u=e.memoTitle,d=e.emailComment,b=this._getReceiverListByMapping(n,i,"Receiver"),v=this._getReceiverListByMapping(a,s,"CC Receiver"),p=this._getReceiverListByMapping(c,o,"BCC Receiver");if(!b||!v||!p)return null;if(this.bookingItemCode){var f=this.bookingItemCode.substring(0,this.bookingItemCode.length-3),h=this._getItemCategoryCodeByBookingItemCode(this.bookingItemCode);if(!h)return null;t={sender:{emailAddress:m,name:l,userNo:this.userNo},receivers:b,ccReceivers:v,bccReceivers:p,smsSendYn:!1,emailSendYn:!0,emailTitle:u,emailDetail:this.emailTemplate.replace(/\n/g,""),bookingCode:f,bookingItemCode:this.bookingItemCode,itemCategoryCode:h}}else t={sender:{emailAddress:m,name:l,userNo:this.userNo},receivers:b,ccReceivers:v,bccReceivers:p,smsSendYn:!1,emailSendYn:!0,emailTitle:u,emailDetail:this.emailTemplate.replace(/\n/g,"")};return d&&d.length>0&&(t=Object.assign({},t,{emailComment:d})),r.omitBy(t,this.isEmptyArray)}},{key:"_getReceiverListByMapping",value:function(e,t,n){var i=this;if(!e&&t||e&&!t)return console.error("names and emails length is not same",n),this._alertService.alert("The number of "+n+"'s emails and names is different. Please match the number of emails and names."),null;if(!e&&!t)return[];var r=e.split(";"),a=t.split(";");return r.length!==a.length?(console.error("names and emails length is not same",n,r,a),this._alertService.alert("The number of "+n+"'s emails and names is different. Please match the number of emails and names."),null):a.some((function(e){return!i._checkEmail(e)}))?(console.error("email is invalid",n,a),this._alertService.alert("The email format is incorrect. Please check the email format."),null):r.map((function(e,t){return{name:e,emailAddress:a[t]}}))}},{key:"_checkEmail",value:function(e){return new RegExp(/^[\w-]+(\.[\w-]+)*@([\w-]+\.)+[a-zA-Z]+$/).test(e)}},{key:"_getItemCategoryCodeByBookingItemCode",value:function(e){var t=e.substring(e.length-3,e.length-2);switch(t){case"F":return"IC01";case"H":return"IC02";case"C":return"IC03";case"A":return"IC04";default:return console.error("Failed to parse itemCategory Character from bookingItemCode",t,e),this._alertService.alert("Error!: Call Developer (Failed to parse itemCategory Character from bookingItemCode)"),null}}},{key:"isEmptyArray",value:function(e){return"object"==typeof e&&0===e.length}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i.Qb(a.a),i.Qb(s.a))},e.\u0275cmp=i.Kb({type:e,selectors:[["app-send-email-template-form"]],inputs:{emailTitle:"emailTitle",emailTemplate:"emailTemplate",itemCategoryCode:"itemCategoryCode",bookingItemCode:"bookingItemCode",userNo:"userNo"},outputs:{sendEmailEvent:"sendEmailEvent",closeEvent:"closeEvent"},decls:80,vars:15,consts:[[3,"formGroup","connectForm","ngSubmit"],[1,"table","table-bordered","table-responsive"],["width","30%"],["scope","row",1,"th-bg"],["formControlName","receiverName",3,"isInvalid"],["formControlName","receiverEmailAddress",3,"isInvalid"],["formControlName","ccReceiverName",3,"isInvalid"],["formControlName","ccEmailAddress",3,"isInvalid"],["formControlName","bccReceiverName",3,"isInvalid"],["formControlName","bccEmailAddress",3,"isInvalid"],["formControlName","senderName",3,"isInvalid"],["formControlName","senderEmailAddress",3,"isInvalid"],["formControlName","memoTitle",3,"isInvalid"],["formControlName","emailComment",3,"isInvalid"],[1,"button-area","align-r","mt20","mb20"],["type","submit",1,"btn","btn-light","sm"],[1,"btn","btn-secondary","sm",3,"click"],[1,"table","table-bordered","table-fixed","mt20"],["colspan","2",2,"padding","25px"],[3,"innerHTML"]],template:function(e,t){1&e&&(i.Wb(0,"form",0),i.fc("ngSubmit",(function(){return t.onSubmit()})),i.Wb(1,"div",1),i.Wb(2,"table"),i.Wb(3,"caption"),i.Pc(4," Email "),i.Vb(),i.Wb(5,"colgroup"),i.Rb(6,"col",2),i.Rb(7,"col"),i.Vb(),i.Wb(8,"tbody"),i.Wb(9,"tr"),i.Wb(10,"th",3),i.Wb(11,"sup"),i.Pc(12,"Receiver Name"),i.Vb(),i.Vb(),i.Wb(13,"td"),i.Rb(14,"app-input-text",4),i.Vb(),i.Vb(),i.Wb(15,"tr"),i.Wb(16,"th",3),i.Wb(17,"sup"),i.Pc(18,"Receiver Email Address"),i.Vb(),i.Vb(),i.Wb(19,"td"),i.Rb(20,"app-input-text",5),i.Vb(),i.Vb(),i.Wb(21,"tr"),i.Wb(22,"th",3),i.Pc(23,"CC Receiver Name"),i.Vb(),i.Wb(24,"td"),i.Rb(25,"app-input-text",6),i.Vb(),i.Vb(),i.Wb(26,"tr"),i.Wb(27,"th",3),i.Pc(28,"CC Receiver Email Address"),i.Vb(),i.Wb(29,"td"),i.Rb(30,"app-input-text",7),i.Vb(),i.Vb(),i.Wb(31,"tr"),i.Wb(32,"th",3),i.Pc(33,"BCC Receiver Name"),i.Vb(),i.Wb(34,"td"),i.Rb(35,"app-input-text",8),i.Vb(),i.Vb(),i.Wb(36,"tr"),i.Wb(37,"th",3),i.Pc(38,"BCC Receiver Email Address"),i.Vb(),i.Wb(39,"td"),i.Rb(40,"app-input-text",9),i.Vb(),i.Vb(),i.Wb(41,"tr"),i.Wb(42,"th",3),i.Wb(43,"sup"),i.Pc(44,"Sender Name"),i.Vb(),i.Vb(),i.Wb(45,"td"),i.Rb(46,"app-input-text",10),i.Vb(),i.Vb(),i.Wb(47,"tr"),i.Wb(48,"th",3),i.Wb(49,"sup"),i.Pc(50,"Sender Email Address"),i.Vb(),i.Vb(),i.Wb(51,"td"),i.Rb(52,"app-input-text",11),i.Vb(),i.Vb(),i.Wb(53,"tr"),i.Wb(54,"th",3),i.Wb(55,"sup"),i.Pc(56,"UMS Title"),i.Vb(),i.Vb(),i.Wb(57,"td"),i.Rb(58,"app-input-text",12),i.Vb(),i.Vb(),i.Wb(59,"tr"),i.Wb(60,"th",3),i.Pc(61,"Email Comment"),i.Vb(),i.Wb(62,"td"),i.Rb(63,"app-input-text",13),i.Vb(),i.Vb(),i.Vb(),i.Vb(),i.Vb(),i.Wb(64,"div",14),i.Wb(65,"button",15),i.Pc(66,"Send"),i.Vb(),i.Wb(67,"button",16),i.fc("click",(function(){return t.onClose()})),i.Pc(68,"Close"),i.Vb(),i.Vb(),i.Wb(69,"div",17),i.Wb(70,"table"),i.Wb(71,"caption"),i.Pc(72," \uc774\uba54\uc77c \ubcf4\uc5ec\uc8fc\uae30 "),i.Vb(),i.Wb(73,"colgroup"),i.Rb(74,"col"),i.Vb(),i.Wb(75,"tbody"),i.Wb(76,"tr"),i.Wb(77,"td",18),i.Rb(78,"div",19),i.ic(79,"sanitizeHtml"),i.Vb(),i.Vb(),i.Vb(),i.Vb(),i.Vb(),i.Vb()),2&e&&(i.pc("formGroup",t.postForm)("connectForm",t.postFormData),i.Cb(14),i.pc("isInvalid",t.checkIsInvalid("receiverName")),i.Cb(6),i.pc("isInvalid",t.checkIsInvalid("receiverEmailAddress")),i.Cb(5),i.pc("isInvalid",t.checkIsInvalid("ccReceiverName")),i.Cb(5),i.pc("isInvalid",t.checkIsInvalid("ccEmailAddress")),i.Cb(5),i.pc("isInvalid",t.checkIsInvalid("bccReceiverName")),i.Cb(5),i.pc("isInvalid",t.checkIsInvalid("bccEmailAddress")),i.Cb(6),i.pc("isInvalid",t.checkIsInvalid("senderName")),i.Cb(6),i.pc("isInvalid",t.checkIsInvalid("senderEmailAddress")),i.Cb(6),i.pc("isInvalid",t.checkIsInvalid("memoTitle")),i.Cb(5),i.pc("isInvalid",t.checkIsInvalid("emailComment")),i.Cb(15),i.pc("innerHTML",i.jc(79,13,t.emailTemplate),i.Gc))},directives:[c.B,c.s,c.k,o.a,l.a,c.r,c.i],pipes:[m.d],encapsulation:2}),e}()},"9Wiz":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("3Pt+"),r=n("6UzV"),a=n("fXoL"),s=function(){var e=_createClass((function e(t){var n=this;_classCallCheck(this,e),this.fb=t,this.generateReservationSendEmailTemplatePostForm=function(){return n.fb.group({receiverName:[null,[i.z.required]],receiverEmailAddress:[null,[r.a.email(),i.z.required]],ccReceiverName:[null],ccEmailAddress:[null],bccReceiverName:[null],bccEmailAddress:[null],senderName:[null,[i.z.required]],senderEmailAddress:[null,[r.a.email(),i.z.required]],memoTitle:[null],emailComment:[null]})},this.initReservationSendEmailTemplatePostForm=function(){return{receiverName:null,receiverEmailAddress:null,ccReceiverName:null,ccEmailAddress:null,bccReceiverName:null,bccEmailAddress:null,senderName:null,senderEmailAddress:"cscenter@ohmyhotel.com",memoTitle:null,emailComment:null}}}));return e.\u0275fac=function(t){return new(t||e)(a.bc(i.f))},e.\u0275prov=a.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},CNCE:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("fXoL"),r=n("Vwu0"),a=n("kt0X"),s=n("6H05"),c=function(){var e=function(){function e(t){_classCallCheck(this,e),this._store=t,this.closeEvent=new i.n}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"sendUmsHandler",value:function(e){this._store.dispatch(r.a.sendUmsAction({condition:e}))}},{key:"closeHandler",value:function(){this.closeEvent.emit()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i.Qb(a.h))},e.\u0275cmp=i.Kb({type:e,selectors:[["app-send-email-template"]],inputs:{emailTitle:"emailTitle",emailTemplate:"emailTemplate",itemCategoryCode:"itemCategoryCode",bookingItemCode:"bookingItemCode",userNo:"userNo"},outputs:{closeEvent:"closeEvent"},decls:1,vars:5,consts:[[3,"emailTitle","emailTemplate","itemCategoryCode","bookingItemCode","userNo","sendEmailEvent","closeEvent"]],template:function(e,t){1&e&&(i.Wb(0,"app-send-email-template-form",0),i.fc("sendEmailEvent",(function(e){return t.sendUmsHandler(e)}))("closeEvent",(function(){return t.closeHandler()})),i.Vb()),2&e&&i.pc("emailTitle",t.emailTitle)("emailTemplate",t.emailTemplate)("itemCategoryCode",t.itemCategoryCode)("bookingItemCode",t.bookingItemCode)("userNo",t.userNo)},directives:[s.a],encapsulation:2}),e}()},N7Iw:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){return"string"==typeof e&&(e=Number(e)),e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}},Vwu0:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i={};n.r(i),n.d(i,"sendUmsAction",(function(){return a})),n.d(i,"sendUmsSuccessAction",(function(){return s})),n.d(i,"sendUmsFailureAction",(function(){return c}));var r=n("kt0X"),a=Object(r.o)("[SendEmailTemplate] load send ums",Object(r.t)()),s=Object(r.o)("[SendEmailTemplate] load send ums success"),c=Object(r.o)("[SendEmailTemplate] load send ums failure",Object(r.t)())},kZba:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var i=n("ofXK"),r=n("3Pt+"),a=n("snw9"),s=n("kt0X"),c=n("WG3B"),o=n("xoAz"),l=n("vu/V"),m=n("l1P7"),u=n("5hwk"),d=n("+NQf"),b=n("7UZF"),v=n("v7zA"),p=n("hHe4"),f=n("6LsY"),h=n("7rOj");n("CNCE"),n("6H05");var C=Object(s.q)({emailTemplate:null});function g(e,t){return Object(s.m)({sendEmailTemplate:C})(e,t)}var k,E=n("Vwu0"),I=n("LvDl"),V=n("eIep"),y=n("lJxs"),W=n("JIr8"),N=n("vkgz"),_=n("LRne"),R=n("fXoL"),A=n("EsKh"),S=n("Xb6A"),T=n("z6cu"),P=n("AytR").a.API_URL,w={postUmsSend:"".concat(P,"/common/ums/send")},F=n("tpT/"),j=((k=function(){function e(t){_classCallCheck(this,e),this.api=t}return _createClass(e,[{key:"sendUms",value:function(e){var t=I.assign({},this.api.defaultParams,{condition:e});return this.api.post(w.postUmsSend,t).pipe(Object(V.a)((function(e){return e.succeedYn?Object(_.a)(e.result):Object(T.a)(e||"api response error")})))}}]),e}()).\u0275fac=function(e){return new(e||k)(R.bc(F.a))},k.\u0275prov=R.Mb({token:k,factory:k.\u0275fac,providedIn:"root"}),k);n("9Wiz");var O,U,z=((U=function(){function e(t,n,i,r,s){var c=this;_classCallCheck(this,e),this._store=t,this._alertService=n,this._errorService=i,this._actions=r,this._apiService=s,this.sendUms$=Object(a.c)((function(){return c._actions.pipe(Object(a.d)(E.a.sendUmsAction),Object(V.a)((function(e){var t=e.condition;return c._apiService.sendUms(t).pipe(Object(y.a)((function(){return{succeedYn:!0}})),Object(W.a)((function(e){return Object(_.a)({succeedYn:!1,error:e})})))})),Object(N.a)((function(e){var t=e.succeedYn,n=e.error;if(t){var i=[E.a.sendUmsSuccessAction()];c._runPage("Send mail successfully",i)}else c._catchErr(n,"Send mail failed")})))}),{dispatch:!1})}return _createClass(e,[{key:"_runPage",value:function(e,t){var n=this;this._alertService.alert({message:e,accept:(null==t?void 0:t.length)>0?function(){t.forEach((function(e){n._store.dispatch(e)}))}:function(){}})}},{key:"_catchErr",value:function(e,t,n){var i=this,r=this._errorService.errorHandler(e,t);I.isNil(r)||(I.isNil(r.accept)&&(r.accept=(null==n?void 0:n.length)>0?function(){n.forEach((function(e){i._store.dispatch(e)}))}:function(){}),this._alertService.alert(r))}}]),e}()).\u0275fac=function(e){return new(e||U)(R.bc(s.h),R.bc(A.a),R.bc(S.a),R.bc(a.a),R.bc(j))},U.\u0275prov=R.Mb({token:U,factory:U.\u0275fac}),U),x=((O=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=R.Ob({type:O}),O.\u0275inj=R.Nb({factory:function(e){return new(e||O)},imports:[[i.c,r.m,r.w,c.m,o.a,h.a,u.a,d.a,f.a,m.a,v.a,p.a,b.a,l.a,s.j.forFeature("sendEmailTemplate",g),a.b.forFeature([z])]]}),O)},zhzn:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a}));var i=function(e){switch(e){case"KRW":return"\u20a9";case"USD":return"$";case"JPY":case"CNY":return"\xa5";case"VND":return"\u20ab";default:return""}},r=function(e){switch(e){case"KRW":return"kr";case"JPY":return"jp";case"VND":return"vi";default:return"kr"}},a=function(e){if(e.length<4)return e;var t=e.substring(0,e.length-4),n=e.substring(e.length-4,e.length);return t.replace(/[0-9]/g,"*")+n}}}]);